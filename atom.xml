<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://dgle.dev/</id>
    <title>Dongle Blog</title>
    <updated>2022-07-30T00:00:00.000Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://dgle.dev/"/>
    <subtitle>Dongle Blog</subtitle>
    <icon>https://dgle.dev/img/favicon.ico</icon>
    <entry>
        <title type="html"><![CDATA[Concurrent Hash Mapì„ ê°„ë‹¨í•˜ê²Œ ë§Œë“¤ì–´ë³´ì. - 1í¸]]></title>
        <id>ConcurrentHashMap</id>
        <link href="https://dgle.dev/ConcurrentHashMap"/>
        <updated>2022-07-30T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Make Verrrrry Simple My Concurrent Hash Map -1]]></summary>
        <content type="html"><![CDATA[<p>ConcurrentHashMap ê°„ë‹¨í•˜ê²Œ ë§Œë“¤ì–´ë³´ì
ëª¨ë“  ì†ŒìŠ¤ì½”ë“œëŠ” <a href="https://github.com/sk1737030/til/tree/master/simple-concurrenthashmap" target="_blank" rel="noopener noreferrer">ì´ê³³</a>ì—ì„œ í™•ì¸ ê°€ëŠ¥í•©ë‹ˆë‹¤!</p><h1>ConcurrentHashMap ê°„ë‹¨í•˜ê²Œ ë§Œë“¤ì–´ë³´ì</h1><p>ë™ì‹œì„± ë¬¸ì œ ë° ì¼ê´€ì„±ì„ ìœ„í•´ Key Value êµ¬ì¡°ë¡œ ì‚¬ìš©í•  ë•Œ ê°€ì¥ ì‰½ê²Œ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ <code>CoucurrentHashMap</code> ì´ì˜€ì§€ë§Œ ë¶€ë„ëŸ½ê²Œë„ í•­ìƒ ë‚´ë¶€êµ¬ì¡°ë¥¼ ë³´ê³  ì´ë ‡ê²Œ ë™ì‹œì„±ì„ ë³´ì¥í•˜ëŠ” ê±°êµ¬ë‚˜ë¼ê³  ìƒê°ë§Œ í•˜ê³  ë§¤ë²ˆ ë„˜ê²¼ì—ˆëŠ”ë° ì´ë²ˆ ê¸°íšŒì— ì •ë¦¬í•˜ê³  í•œ ë²ˆ ìŠ¥-ì‚­ ë§Œë“¤ì–´ ë³´ë ¤ê³  í•©ë‹ˆë‹¤. ê·¸ë˜ì„œ ê²°ì •í•œ ì œëª©ì€ ê°„ë‹¨í•˜ê²Œ <code>ConcurrentHashMap</code> ê°„ë‹¨í•˜ê²Œ ë§Œë“¤ì–´ë³´ì</p><br><h2 class="anchor anchorWithStickyNavbar_mojV" id="concurrenthashmap">ConcurrentHashMap<a class="hash-link" href="#concurrenthashmap" title="Direct link to heading">â€‹</a></h2><p>ë­ ì—¬íƒ€ ë‹¤ë¥¸ ë§ì„ ìƒëµí•˜ê³  ConcurrentHashMap ë§ê³ ë„ ì—¬ëŸ¬ Mapì˜ êµ¬í˜„ì²´ë“¤ì´ ìˆëŠ”ë°, ì™œ í•„ìš”ë¡œ í–ˆì„ê¹Œë¥¼ ë¨¼ì € ìƒê°í•´ë³¸ë‹¤ë©´ í¬ê²Œ 2ê°€ì§€ ì •ë„ê°€ ìˆì„ ê±° ê°™ì€ë°ìš”.  </p><ol><li><p>ìš°ë¦¬ê°€ ìì£¼ ì‚¬ìš©í•˜ëŠ” <code>HashMap</code>ì€ <strong>thread-safe</strong> í•˜ì§€ ì•Šì€ java collectionì…ë‹ˆë‹¤.</p></li><li><p><code>Hashtable</code>ì€ <strong>thread-safe</strong>í•˜ë‚˜ synchronized method ë ˆë²¨ì— ì‚¬ìš©ì„í•˜ì—¬ ë¹„ìš©ì´ ë§¤ìš° ë¹„ìŒ‰ë‹ˆë‹¤.</p><ul><li>ì¦‰ ë‹¤ì‹œ ë§í•´ ë¹„ìš©ì´ ë§ì´ë“œëŠ” ì´ìœ ëŠ” Race condition(ê²½ìŸìƒíƒœ)ì´ ë°œìƒí•  ìˆ˜ ìˆëŠ” code blockì„ synchronized í‚¤ì›Œë“œë¡œ ê°ì‹¸ë©´, í•˜ë‚˜ì˜ ìŠ¤ë ˆë“œë§Œ ì´ ì§„ì…í•  ìˆ˜ ìˆëŠ”ë°, <code>HashTable</code>ì€ ë©”ì†Œë“œ ë ˆë²¨ì—ì„œ synchronizedë¥¼ ê±¸ì–´ë²„ë ¤ì„œ ë‹¤ë¥¸ ìŠ¤ë ˆë“œê°€ ë¨¼ì € ì§„ì…í•œ ìŠ¤ë ˆë“œê°€ ì´ code blockì„ ë‚˜ê°ˆ ë•Œê¹Œì§€ ê³„ì† ê¸°ë‹¤ë ¤ì•¼ í•´ì„œ ë¹„ìš©ì ìœ¼ë¡œ ë§¤ìš° ë¹„ì‹¼ Collectionì…ë‹ˆë‹¤.  </li></ul><br><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// í•´ì‹œí…Œì´ë¸”ì˜ put</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">synchronized</span><span class="token plain"> </span><span class="token class-name">V</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">put</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">K</span><span class="token plain"> key</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">V</span><span class="token plain"> value</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></li></ol><br><p>ì´ëŸ¬í•œ ì´ìœ ë¡œ ë©€í‹° ìŠ¤ë ˆë“œ í™˜ê²½ì—ì„œì˜ mapì´ í•„ìš”í•´ì¡ŒëŠ”ë° ì„±ëŠ¥ê¹Œì§€ ì‹ ê²½ ì¨ì•¼ í•˜ëŠ” ë¬¸ì œê°€ ìˆì–´ì„œ ë“±ì¥í•œ ê²ƒì´ ë™ì‹œì„± ì„±ëŠ¥ê¹Œì§€ ì±™ê¸°ê²Œ ë˜ëŠ” <code>ConcurrentHashMap</code>ì…ë‹ˆë‹¤. ì°¸ê³ ë¡œ ìë°” 1.5ë²„ì „ë¶€í„° ë“¤ì–´ì˜¤ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.  </p><br><p><img loading="lazy" alt="`ConcurrentHashMap`ì€ `ConcurrentMap`ì„ êµ¬í˜„í•œ í•´ì‰¬ë§µì´ë‹¤.  " src="/assets/images/Untitled-0a2d3d2c3c8b41ec1b5ba29ed6097963.png" width="769" height="294" class="img_E7b_"><br>
<!-- -->ğŸ’¡<code>ConcurrentHashMap</code>ì€ <code>ConcurrentMap</code>ì„ êµ¬í˜„í•œ í•´ì‰¬ë§µì…ë‹ˆë‹¤.  </p><br><h3 class="anchor anchorWithStickyNavbar_mojV" id="concurrentmap">ConcurrentMap<a class="hash-link" href="#concurrentmap" title="Direct link to heading">â€‹</a></h3><p>  <code>ConcurrentMap</code>ì€ ë©€í‹°ìŠ¤ë ˆë”© í™˜ê²½ì—ì„œ í‚¤/ê°’ ì‘ì—…ì— ëŒ€í•œ ë©”ëª¨ë¦¬ ì¼ê´€ì„±ì„ ë³´ì¥í•˜ëŠ” java.util.concurrentì˜ íŒ¨í‚¤ì§€ì— ìˆê³  êµ¬í˜„ì²´ë¡œëŠ” <strong>ConcurrentSkipListMap, ConcurrentSkipListMap</strong> ë‘ ê°œê°€ ìˆìŠµë‹ˆë‹¤.  </p><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">java</span><span class="token namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token namespace" style="opacity:0.7">util</span><span class="token namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token namespace" style="opacity:0.7">concurrent</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">interface</span><span class="token plain"> </span><span class="token class-name">ConcurrentMap</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">K</span><span class="token generics punctuation" style="color:#393A34">,</span><span class="token generics class-name">V</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">extends</span><span class="token plain"> </span><span class="token class-name">Map</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">K</span><span class="token generics punctuation" style="color:#393A34">,</span><span class="token generics class-name">V</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><br><h2 class="anchor anchorWithStickyNavbar_mojV" id="ê·¸ë ‡ë‹¤ë©´-ì–´ë–»ê²Œ-ë™ì‹œì„±ì„-ë³´ì¥í• ê¹Œ">ê·¸ë ‡ë‹¤ë©´ ì–´ë–»ê²Œ ë™ì‹œì„±ì„ ë³´ì¥í• ê¹Œ?<a class="hash-link" href="#ê·¸ë ‡ë‹¤ë©´-ì–´ë–»ê²Œ-ë™ì‹œì„±ì„-ë³´ì¥í• ê¹Œ" title="Direct link to heading">â€‹</a></h2><p>ì‚¬ì‹¤ ë™ì‹œì„±ì„ ë³´ì¥í•˜ëŠ” ë°©ë²• ì¤‘ ê°€ì¥ ì‰½ê²ŒëŠ”  synchronizedë¥¼ ì“°ë©´ ì•ˆì „í•˜ê²Œ ë™ì‹œì„±ì„ ë³´ì¥í•  ìˆ˜ ìˆì§€ë§Œ ì“°ê¸°ì— ë”°ë¼ì„œ ì„±ëŠ¥ ì´ìŠˆê°€ ìˆìŠµë‹ˆë‹¤. íŠ¹íˆ ìœ„ì—ì„œ í•œ ë²ˆ ì–˜ê¸° í–ˆì§€ë§Œ,  HashTable ì—ì„œ ì–˜ê¸°ëë˜ ì„±ëŠ¥ì´ ê°€ì¥ í° ë¬¸ì œê°€ ìˆìŠµë‹ˆë‹¤. ì´ë¥¼ ConcurrentHashMapì€ ì •ë§ ë©‹ì§€ê³  ì–´-ì¸í•œ ì—¬ëŸ¬ê°€ì§€ ë°©ë²•ìœ¼ë¡œ ê°œ-ì„ ì„ í–ˆëŠ”ë° í¬ê²Œ ë‘ ê°€ì§€ ë°©ë²•ë“¤ë¡œ í•´ê²°í•©ë‹ˆë‹¤.</p><ol><li><p><a href="https://howtodoinjava.com/java/multi-threading/compare-and-swap-cas-algorithm/" target="_blank" rel="noopener noreferrer">CAS(Compare And Swap) ì•Œê³ ë¦¬ì¦˜</a> </p><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">final</span><span class="token plain"> </span><span class="token class-name">V</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">putVal</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">K</span><span class="token plain"> key</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">V</span><span class="token plain"> value</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">boolean</span><span class="token plain"> onlyIfAbsent</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> hash </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">spread</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">key</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">hashCode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">else</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">f </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">tabAt</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">tab</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">n </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> hash</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">casTabAt</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">tab</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> i</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Node</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">K</span><span class="token generics punctuation" style="color:#393A34">,</span><span class="token generics class-name">V</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">hash</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> key</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> value</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token keyword" style="color:#00009f">break</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">                   </span><span class="token comment" style="color:#999988;font-style:italic">// no lock when adding to empty bin</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></li></ol><br><ol start="2"><li><p>ì´ë¯¸ ë²„í‚·ì— ë…¸ë“œê°€ ì¡´ì¬í•œë‹¤ë©´ ë²„í‚·ë³„ë¡œ synchronized ì‚¬ìš©í•©ë‹ˆë‹¤.  </p><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">final</span><span class="token plain"> </span><span class="token class-name">V</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">putVal</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">K</span><span class="token plain"> key</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">V</span><span class="token plain"> value</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">boolean</span><span class="token plain"> onlyIfAbsent</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> hash </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">spread</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">key</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">hashCode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">synchronized</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">f</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">tabAt</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">tab</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> i</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> f</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">fh </span><span class="token operator" style="color:#393A34">&gt;=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            binCount </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">Node</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">K</span><span class="token generics punctuation" style="color:#393A34">,</span><span class="token generics class-name">V</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> e </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> f</span><span class="token punctuation" style="color:#393A34">;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">++</span><span class="token plain">binCount</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token class-name">K</span><span class="token plain"> ek</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">e</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">hash </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> hash </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ek </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> e</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">key</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> key </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                     </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ek </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">null</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> key</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">equals</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ek</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    oldVal </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> e</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">val</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">!</span><span class="token plain">onlyIfAbsent</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        e</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">val </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> value</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token keyword" style="color:#00009f">break</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token class-name">Node</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">K</span><span class="token generics punctuation" style="color:#393A34">,</span><span class="token generics class-name">V</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> pred </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> e</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">e </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> e</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">next</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    pred</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">next </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Node</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">K</span><span class="token generics punctuation" style="color:#393A34">,</span><span class="token generics class-name">V</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">hash</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> key</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> value</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token keyword" style="color:#00009f">break</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></li></ol><br><h2 class="anchor anchorWithStickyNavbar_mojV" id="ê°„ë‹¨í•œ-ì„±ëŠ¥í…ŒìŠ¤íŠ¸">ê°„ë‹¨í•œ ì„±ëŠ¥í…ŒìŠ¤íŠ¸<a class="hash-link" href="#ê°„ë‹¨í•œ-ì„±ëŠ¥í…ŒìŠ¤íŠ¸" title="Direct link to heading">â€‹</a></h2><p>ê·¸ë ‡ë‹¤ë©´ ì •ë§ ì„±ëŠ¥ì—ì„œ ë§ì€ ì°¨ì´ê°€ ë‚ ê¹Œ? getê³¼ putì— ëŒ€í•œ ê°„ë‹¨í•œ ë²¤ì¹˜ë§ˆí¬ë¥¼ ì‘ì„±í•˜ë©´ì„œ <code>Hashtable</code>, <code>concurrentHashMap</code>ì™€ ì„±ëŠ¥ì„ ë¹„êµí•´ë³´ê² ìŠµë‹ˆë‹¤.<br>
<!-- -->ê°„ë‹¨í•˜ê²Œ 5ê°œ ìŠ¤ë ˆë“œë¥¼ ë§Œë“¤ê³  1,000,000 ê°œ ì •ë„ ë°ì´í„°ë¥¼ ë„£ê³  getì„ í•˜ëŠ” í–‰ìœ„ë¥¼ í†µí•´ì„œ ë¹„êµë¥¼ í•´ë³´ë©´  </p><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">private</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">static</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">final</span><span class="token plain"> </span><span class="token class-name">Map</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">Integer</span><span class="token generics punctuation" style="color:#393A34">,</span><span class="token generics"> </span><span class="token generics class-name">Integer</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> testHashTable </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Hashtable</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">private</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">static</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">final</span><span class="token plain"> </span><span class="token class-name">Map</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">Integer</span><span class="token generics punctuation" style="color:#393A34">,</span><span class="token generics"> </span><span class="token generics class-name">Integer</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> testConcurrentHashMap </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">ConcurrentHashMap</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token annotation punctuation" style="color:#393A34">@Test</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">test</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">throws</span><span class="token plain"> </span><span class="token class-name">Exception</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">long</span><span class="token plain"> hashTableAvgTime </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">measure_GetPut</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">testHashTable</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">long</span><span class="token plain"> concurrentHashMapAvgTime </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">measure_GetPut</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">testConcurrentHashMap</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">System</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">out</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"hashTableAvgTime = "</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> hashTableAvgTime</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">System</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">out</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"concurrentHashMapAvgTime = "</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> concurrentHashMapAvgTime</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">private</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">static</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">long</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">measure_GetPut</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">Map</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">Integer</span><span class="token generics punctuation" style="color:#393A34">,</span><span class="token generics"> </span><span class="token generics class-name">Integer</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> map</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">throws</span><span class="token plain"> </span><span class="token class-name">InterruptedException</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">ExecutorService</span><span class="token plain"> executor </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name">Executors</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">newFixedThreadPool</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">4</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">long</span><span class="token plain"> startTime </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name">System</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">nanoTime</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> i</span><span class="token operator" style="color:#393A34">++</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            executor</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">submit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> j </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> j </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1_000_000</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> j</span><span class="token operator" style="color:#393A34">++</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> value </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name">ThreadLocalRandom</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">current</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">nextInt</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">100_000</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    map</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">put</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">value</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> value</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    map</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">value</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        executor</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">shutdown</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">executor</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">awaitTermination</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">30</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">TimeUnit</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">SECONDS</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token class-name">System</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">out</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">map</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getClass</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            executor</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">shutdownNow</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">long</span><span class="token plain"> endTime </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name">System</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">nanoTime</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">endTime </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> startTime</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">/</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5_000_000</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>Random vs ThreadLocalRandom</h5></div><div class="admonition-content"><p>ì˜ ì •ë¦¬ëœ ì‚¬ì´íŠ¸ê°€ ìˆì–´ì„œ ì˜¬ë¦¬ì§€ë§Œ ìš”ì•½í•˜ìë©´ Randomì€ ë©€í‹° ìŠ¤ë ˆë“œì—ì„œ í•˜ë‚˜ì˜ Random ì¸ìŠ¤í„´ìŠ¤ë¥¼ ê³µìœ í•˜ì—¬ ì „ì—­ì ìœ¼ë¡œ ë™ì‘í•´ì„œ ì„ í˜• í•©ë™ ìƒì„±ê¸° ì•Œê³ ë¦¬ì¦˜ì„ ì‚¬ìš©í•˜ëŠ” ë°˜ë©´ ThreadLocalRandom ê° ìŠ¤ë ˆë“œë§ˆë‹¤ ë‹¤ë¥¸ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.<br>
<a href="https://velog.io/@sojukang/Random-%EB%8C%80%EC%8B%A0-ThreadLocalRandom%EC%9D%84-%EC%8D%A8%EC%95%BC-%ED%95%98%EB%8A%94-%EC%9D%B4%EC%9C%A0" target="_blank" rel="noopener noreferrer">https://velog.io/@sojukang/Random-ëŒ€ì‹ -ThreadLocalRandomì„-ì¨ì•¼-í•˜ëŠ”-ì´ìœ </a></p></div></div><p>ì°¸ê³ ë¡œ í™˜ê²½ì€ <a href="https://www.apple.com/kr/macbook-pro-14-and-16/specs/" target="_blank" rel="noopener noreferrer">m1book Pro</a>, 16GBì—ì„œ í…ŒìŠ¤íŠ¸ í•´ë³´ì•˜ìŠµë‹ˆë‹¤.<br>
<!-- -->ëŒ€ëµ 10ë²ˆ ì •ë„ì˜ í…ŒìŠ¤íŠ¸ í›„ì— ë‚˜ì˜¨ ê²°ê³¼ ê°’ì…ë‹ˆë‹¤.  </p><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">hashTableAvgTime </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1228</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">concurrentHashMapAvgTime </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">317</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>í™•ì‹¤í•˜ê²Œ, ë©”ì†Œë“œ ë ˆë²¨ì—ì„œ ë½ì„ ê±°ëŠ” ë°©ë²•ìœ¼ë¡œ putì„ ì²˜ë¦¬í•˜ëŠ” <code>hashtable</code>ê³¼ ë‹¬ë¦¬ <code>ConcurrentHashMap</code>ì€ ë²„í‚·ë‹¹ìœ¼ë¡œ lockì„ ê±¸ê³  cas ì•Œê³ ë¦¬ì¦˜ì„ ì‚¬ìš©í•˜ëŠ”ë“±ì„ í†µí•œ ì—¬ëŸ¬ ê¸°ë²•ë“¤ë¡œ ì„±ëŠ¥ìƒ ìƒìŠ¹ì´ ë‚˜íƒ€ë‚œ ê±¸ë¡œ ë³´ì…ë‹ˆë‹¤.</p><p>ê¸¸ì—ˆëŠ”ë° ë§Œë“¤ì–´ë³´ëŠ” ê±´ ë‹¤ìŒ 2í¸ì—ì„œ:)</p><p>ì°¸ê³ <br>
<a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/ConcurrentMap.html" target="_blank" rel="noopener noreferrer">https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/ConcurrentMap.html</a><br>
<a href="https://www.baeldung.com/java-concurrent-map" target="_blank" rel="noopener noreferrer">https://www.baeldung.com/java-concurrent-map</a><br>
<a href="https://www.programiz.com/java-programming/concurrenthashmap" target="_blank" rel="noopener noreferrer">https://www.programiz.com/java-programming/concurrenthashmap</a><br>
<a href="https://www.geeksforgeeks.org/concurrenthashmap-in-java/" target="_blank" rel="noopener noreferrer">https://www.geeksforgeeks.org/concurrenthashmap-in-java/</a><br>
<a href="https://bcho.tistory.com/1072" target="_blank" rel="noopener noreferrer">https://bcho.tistory.com/1072</a><br>
<a href="https://en.wikipedia.org/wiki/Hash_table" target="_blank" rel="noopener noreferrer">https://en.wikipedia.org/wiki/Hash_table</a><br>
<a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/ConcurrentHashMap.html" target="_blank" rel="noopener noreferrer">https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/ConcurrentHashMap.html</a><br>
<a href="https://howtodoinjava.com/java/multi-threading/compare-and-swap-cas-algorithm/" target="_blank" rel="noopener noreferrer">CAS</a><br>
<a href="https://d2.naver.com/helloworld/831311" target="_blank" rel="noopener noreferrer">https://d2.naver.com/helloworld/831311</a><br>
<a href="https://velog.io/@sojukang/Random-%EB%8C%80%EC%8B%A0-ThreadLocalRandom%EC%9D%84-%EC%8D%A8%EC%95%BC-%ED%95%98%EB%8A%94-%EC%9D%B4%EC%9C%A0" target="_blank" rel="noopener noreferrer">https://velog.io/@sojukang/Random-ëŒ€ì‹ -ThreadLocalRandomì„-ì¨ì•¼-í•˜ëŠ”-ì´ìœ </a></p>]]></content>
        <author>
            <name>Dongle</name>
            <uri>https://github.com/sk1737030</uri>
        </author>
        <category label="Java" term="Java"/>
        <category label="Map" term="Map"/>
        <category label="ConcurrentHashMap" term="ConcurrentHashMap"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[ë ˆë””ìŠ¤ Atomic Operationìœ„í•´ multi ì™€ luascriptì˜ ì°¨ì´]]></title>
        <id>redis-multi-lua</id>
        <link href="https://dgle.dev/redis-multi-lua"/>
        <updated>2022-07-18T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[What is difference Between Redis luascript and multi exec]]></summary>
        <content type="html"><![CDATA[<p>Redisì—ì„œ Atomic Operationì„ ìœ„í•´ Luascirptì™€ Multi Exec ì¤‘ ë­˜ ì¨ì•¼í• ê¹Œ?</p><h1>Redisì—ì„œ Atomic Operationì„ ìœ„í•´ Luascirptì™€ Multi Exec ì¤‘ ë­˜ ì¨ì•¼í• ê¹Œ?</h1><h2 class="anchor anchorWithStickyNavbar_mojV" id="multiì™€--execë¥¼-ì‚¬ìš©í•˜ë©´">Multiì™€  execë¥¼ ì‚¬ìš©í•˜ë©´<a class="hash-link" href="#multiì™€--execë¥¼-ì‚¬ìš©í•˜ë©´" title="Direct link to heading">â€‹</a></h2><p>Multiì™€ execëŠ” ë ˆë””ìŠ¤ì—ì„œ íŠ¸ëœì­ì…˜ì„ ì‚¬ìš©í•˜ê² ë‹¤ëŠ” ëª…ë ¹ì–´ì¸ë° ì¼ë°˜ì ì¸ RDBì™€ ë‹¤ë¥´ê²Œ ë¡¤ë°±ê¸°ëŠ¥ì´ì—†ë‹¤. (ë¡¤ë°±ê¸°ëŠ¥ì´ ì—†ëŠ” ì´ìœ ëŠ” ë‹¨ìˆœì„±ê³¼ ì„±ëŠ¥ì— ìƒë‹¹í•œ ì˜í–¥ì„ ë¯¸ì¹˜ê¸° ë•Œë¬¸ì— RDBì™€ ë‹¤ë¥´ê²Œ ì—†ë‹¤ê³ í•œë‹¤.)<br>
<!-- -->ê·¸ëŸ¬ë©´ ë ˆë””ìŠ¤ëŠ” ì–´ë–»ê²Œ íŠ¸ëœì­ì…˜ì„ ë°”ë¼ë³¼ê¹Œ? Multië¡œ ì„ ì–¸í•˜ë©´ multiì•ˆì— ëª…ë ¹ì–´ë“¤ì´ ë¬¶ì—¬ ìˆœì„œëŒ€ë¡œ ê°™ì´ íì— ë‹´ê¸°ê²Œëœë‹¤. ê·¸ë¦¬ê³  EXECë¥¼ ë§Œë‚˜ëŠ” ìˆœê°„ íì— ë‹´ê¸´ ëª…ë ¹ì–´ë“¤ì´ ìˆœì„œëŒ€ë¡œ í•œ ì˜¤í¼ë ˆì´ì…˜ì— ë¬¶ì—¬ ì‹¤í–‰ì´ë˜ê³ <br>
<!-- -->ë§Œì•½ íì— ìŒ“ì¸ ëª…ë ¹ì–´ê°€ ì¤‘ê°„ì— ì‹¤íŒ¨í•˜ëŠ” ì¼ì´ ìƒê¸°ë©´ ì‹¤íŒ¨í•œ ë¶€ë¶„ë§Œ skipí•˜ê³  ë‹¤ìŒë¶€ë¶„ì´ ì—°ì†ì ìœ¼ë¡œ ì‹¤í–‰ë˜ê²Œëœë‹¤. </p><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> MULTI</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">OK</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> INCR foo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">QUEUED</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> INCR bar</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">QUEUED</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token class-name">EXEC</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">integer</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">integer</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ìœ„ì™€ ê°™ì´, execì˜ ëª…ë ¹ì„ í•œ ìˆœì„œëŒ€ë¡œ arrayí˜•íƒœë¡œ ì‘ë‹µê°’ì„ ì¤€ë‹¤. </p><br><h3 class="anchor anchorWithStickyNavbar_mojV" id="watchì™€-ê°™ì´-ì‚¬ìš©í•˜ë©´">watchì™€ ê°™ì´ ì‚¬ìš©í•˜ë©´<a class="hash-link" href="#watchì™€-ê°™ì´-ì‚¬ìš©í•˜ë©´" title="Direct link to heading">â€‹</a></h3><p>ìš°ë¦¬ê°€ ì‚¬ìš©í•˜ëŠ” RDBì˜ optimistic lockê³¼ ê°™ì€ë°, ë§Œì•½ ì§§ì€ì‹œê°„ì— ì—¬ëŸ¬ í´ë¼ì´ì–¸íŠ¸ê°€ ë™ì‹œì— ì ‘ê·¼ í• ì‹œ í”íˆ ë™ì‹œì„± ë¬¸ì œê°€ ìƒê¸°ëŠ”ë° <code>watch</code> ë¥¼ ì‚¬ìš©í•˜ë©´ í•´ê²°ì´ ëœë‹¤. </p><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">WATCH mykey</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">val </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> GET mykey</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">val </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> val </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MULTI</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SET mykey $val</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EXEC</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>myKeyë¼ëŠ” keyì— watchë¥¼ ì£¼ê³ (í‚¤ë¥¼ ê°ì‹œ) ì‘ì—… í›„ì—, exec(ìˆ˜ì‹  ì „) ì „ ë‹¤ë¥¸ í´ë¼ì´ì–¸íŠ¸ì—ì„œ ë¨¼ì € valê°’ì„ ìˆ˜ì •ì„í–ˆìœ¼ë©´ íŠ¸ëœì­ì…˜ì€ ìë™ìœ¼ë¡œ ì‹¤íŒ¨í•˜ê²Œ ëœë‹¤.<br>
<!-- -->ì´ ë•ŒëŠ” í´ë¼ì´ì–¸íŠ¸ì˜ ìˆ˜ì •ë¿ë§Œ ì•„ë‹ˆë¼ ttlì— ì˜í•œ í‚¤ë§Œë£Œ ì œê±° ë“±ê³¼ê°™ì´ Redisì— ìì²´ì— ì˜í•œ ìˆ˜ì •ë„ í¬í•¨ì´ëœë‹¤.  </p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>Trasnaction ì•ˆì— ìˆëŠ” ëª…ë ¹ì€ execê°€ ì „ì†¡ ë  ë•Œê¹Œì§€ íì— ë‹´ê²¨ìˆì–´ì„œ watchì— íŠ¸ë¦¬ê±° ë˜ì§€ ì•Šìœ¼ë‹ˆ ì£¼ì˜í•´ì•¼í•œë‹¤.</p></div></div><p>ğŸ’¡&nbsp;<code>Discard</code>
DiscardëŠ” íì— ë‹´ê²¨ìˆëŠ” ê²ƒë“¤ì„ ë²„ë¦°ë‹¤.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">&gt; SET foo 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">OK</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; MULTI</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">OK</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; INCR foo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">QUEUED</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; DISCARD</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">OK</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; GET foo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">"1"</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><br><h2 class="anchor anchorWithStickyNavbar_mojV" id="luascriptë€">Luascriptë€<a class="hash-link" href="#luascriptë€" title="Direct link to heading">â€‹</a></h2><p>ë£¨ì•„ìŠ¤í¬ë¦½íŠ¸ëŠ” Redisì— ë‚´ì¥ëœ ì‹¤í–‰ ì—”ì§„ì— ì˜í•´ ì‹¤í–‰ë˜ëŠ”ë°. í˜„ì¬ ë ˆë””ìŠ¤ëŠ” ë‹¨ì¼ ìŠ¤í¬ë¦½íŠ¸ ì—”ì§„ì¸ lua 5.1 ì¸í„°í”¼ë¦¬í„°ë¥¼ ì§€ì›í•œë‹¤. ë˜ ìŠ¤í¬ë¦½íŠ¸ëŠ” ì„œë²„ì—ì„œ ì‹¤í–‰ë˜ë¯€ë¡œ ì´ëŠ” ìì—°ìŠ¤ëŸ½ê²Œ ë„¤íŠ¸ì›Œí‚¹ ë¦¬ì†ŒìŠ¤ë¥¼ ì ˆì•½í•˜ê²Œ ë˜ì–´ ìŠ¤í¬ë¦½íŠ¸ì—ì„œ ë°ì´í„°ë¥¼ ì½ê³  ì“°ëŠ” ê±´ ë§¤ìš° íš¨ìœ¨ì ì´ê²Œ ì‘ë™í•œë‹¤. ë˜ ë ˆë””ìŠ¤ì—ì„œ ë£¨ì•„ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‚¬ìš©í•˜ë©´ atomicì„ í•¨ì„ ë³´ì¥í•´ì¤€ë‹¤. ë˜ ë£¨ì•„ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‚¬ìš©í•˜ë©´ ì¡°ê±´ì ì¸ updateë¥¼ ì—¬ëŸ¬ í‚¤ì— ì»¬ì³ ì§€ì›í•´ì£¼ê³ ,  ê°œë³„ì˜ ê°ê¸°ë‹¤ë¥¸ ë°ì´í„° íƒ€ì…ì„ ì›ìì ìœ¼ë¡œ ê²°í•©ì´ê°€ëŠ¥í•´ì§„ë‹¤.</p><p>ê·¸ëƒ¥ ë‹¨ìˆœí•œ ì‚¬ìš©ì„ í•´ë³¸ë‹¤ë©´ </p><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">EVAL </span><span class="token string" style="color:#e3116c">"return redis.call('SET', KEYS[1], ARGV[1])"</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> foo bar</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">OK</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> GET foo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">bar</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ì¡°ê¸ˆ ë” ì‚¬ìš©ì„ í•´ë³¸ë‹¤ë©´ </p><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> EVAL "redis</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">call</span><span class="token punctuation" style="color:#393A34">(</span><span class="token char">'sadd'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token char">'myset1'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">'user1'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">redis</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">call</span><span class="token punctuation" style="color:#393A34">(</span><span class="token char">'sadd'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token char">'myset2'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">'user2'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">local members </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> redis</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">call</span><span class="token punctuation" style="color:#393A34">(</span><span class="token char">'keys'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token char">'myset*'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">local results </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> index</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">key in </span><span class="token function" style="color:#d73a49">ipairs</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">members</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">do</span><span class="token plain"> results</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">index</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> redis</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">call</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">'smembers'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">key</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">end </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> results" </span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><br><h2 class="anchor anchorWithStickyNavbar_mojV" id="ì°¨ì´ì ">ì°¨ì´ì <a class="hash-link" href="#ì°¨ì´ì " title="Direct link to heading">â€‹</a></h2><p><code>multi/exec</code> ëŠ” íŠ¸ëœì­ì…˜ ì‘ë‹µì„ array í˜•íƒœë¡œ ë°›ì•„ì„œ ì—¬ëŸ¬ ëª…ë ¹ì–´ë¥¼ í†µí•´ ì˜ˆë¥¼ë“¤ì–´ ì‘ì—…ì€ ë¶ˆê°€ëŠ¥í•˜ì§€ë§Œ LuasriptëŠ”  scriptë¥¼ ì´ìš©í•´ ê°€ëŠ¥í•˜ë‹¤.<br>
<!-- -->ì˜ˆë¥¼ ë“¤ì–´ lpopìœ¼ë¡œ ë‹´ê¸´ userlist íì— ìˆœì„œëŒ€ë¡œ êº¼ë‚´ì„œ ê·¸ í‚¤ê°’ìœ¼ë¡œ userì˜ ì ìˆ˜ë¥¼ ì˜¬ë¦°ë‹¤ê³ í•œë‹¤ë©´ luascriptë¥¼ ì‚¬ìš©í•˜ë©´ í¸í•˜ë‹¤.</p><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> lpush userList user1 user2 user3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> EVAL "</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">local user </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> redis</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">call</span><span class="token punctuation" style="color:#393A34">(</span><span class="token char">'LPOP'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> 'userList'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">local result </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> redis</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">call</span><span class="token punctuation" style="color:#393A34">(</span><span class="token char">'INCRBY'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> user</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> result " </span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><br><h2 class="anchor anchorWithStickyNavbar_mojV" id="ë­˜-ì‚¬ìš©í•´ì•¼í• ê¹Œ">ë­˜ ì‚¬ìš©í•´ì•¼í• ê¹Œ<a class="hash-link" href="#ë­˜-ì‚¬ìš©í•´ì•¼í• ê¹Œ" title="Direct link to heading">â€‹</a></h2><p><code>multi</code>ë¥¼ ì‚¬ìš©í•˜ë˜ <code>luascript</code> ë¥¼ ì‚¬ìš©í•˜ë˜ ë‘˜ë‹¤ atomicí•˜ê²Œ í•œ ì˜¤í¼ë ˆì´ì…˜ì— ëª…ë ¹ë“¤ì„ í•œ ë²ˆì— ê°™ì´ ë³´ë‚¼ ìˆ˜ ìˆì§€ë§Œ íŠ¹ì • ìƒí™©ì—ì„œëŠ” <code>multi/exec</code>ë¡œëŠ” êµ¬í˜„ì´ í˜ë“¤ ë•Œê°€ìˆìœ¼ë‹ˆ ì´ë•Œ luascript ì‚¬ìš©ì´ ëŒ€ì•ˆì´ ë  ìˆ˜ ìˆë‹¤.</p><br><p>ì°¸ê³ <br>
<a href="https://redis.io/docs/manual/programmability/eval-intro/" target="_blank" rel="noopener noreferrer">https://redis.io/docs/manual/programmability/eval-intro/</a><br>
<a href="https://stackoverflow.com/questions/62970603/lua-scripts-vs-multi-exec-in-redis" target="_blank" rel="noopener noreferrer">https://stackoverflow.com/questions/62970603/lua-scripts-vs-multi-exec-in-redis</a><br>
<a href="https://redis.io/docs/manual/transactions/" target="_blank" rel="noopener noreferrer">redisTransaction</a><br>
<a href="https://redis.io/commands/eval/" target="_blank" rel="noopener noreferrer">https://redis.io/commands/eval/</a><br>
<a href="https://scalegrid.io/blog/redis-transactions-long-running-lua-scripts/" target="_blank" rel="noopener noreferrer">https://scalegrid.io/blog/redis-transactions-long-running-lua-scripts/</a><br>
<a href="https://engineering.linecorp.com/ko/blog/atomic-cache-stampede-redis-lua-script/" target="_blank" rel="noopener noreferrer">https://engineering.linecorp.com/ko/blog/atomic-cache-stampede-redis-lua-script/</a><br>
<a href="https://javamana.com/2022/195/202207141451441296.html" target="_blank" rel="noopener noreferrer">lua script limits to solve the problem of inaccurate high concurrency counts</a></p>]]></content>
        <author>
            <name>Dongle</name>
            <uri>https://github.com/sk1737030</uri>
        </author>
        <category label="Redis" term="Redis"/>
        <category label="Luascript" term="Luascript"/>
        <category label="transaction" term="transaction"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[ë§Œë“¤ë©´ì„œ ë°°ìš°ëŠ” í´ë¦° ì•„í‚¤í…ì²˜ ì •ë¦¬ - 2]]></title>
        <id>clean-arch-2</id>
        <link href="https://dgle.dev/clean-arch-2"/>
        <updated>2022-06-27T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Clean Architecture Study - 2]]></summary>
        <content type="html"><![CDATA[<p>ë§Œë“¤ë©´ì„œ ë°°ìš°ëŠ” í´ë¦° ì•„í‚¤í…ì²˜ë¥¼ ì½ê³  ê³µë¶€í•œ ë‚´ìš©ì„ ì •ë¦¬. - 2</p><p>ëª¨ë“  ì†ŒìŠ¤ëŠ” <a href="https://github.com/sk1737030/til/tree/master/clean-architecture" target="_blank" rel="noopener noreferrer">ì´ê³³ì—</a> ìˆìŠµë‹ˆë‹¤:)</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="í…ŒìŠ¤íŠ¸-ì „ëµ">í…ŒìŠ¤íŠ¸ ì „ëµ<a class="hash-link" href="#í…ŒìŠ¤íŠ¸-ì „ëµ" title="Direct link to heading">â€‹</a></h3><p>ë§Œë“œëŠ” ë¹„ìš©ì´ ì ê³ , ìœ ì§€ë³´ìˆ˜í•˜ê¸° ì‰½ê³ , ë¹¨ë¦¬ ì‹¤í–‰ë˜ê³ , ì•ˆì •ì ì¸ ì‘ì€ í¬ê¸°ì˜ í…ŒìŠ¤íŠ¸ë“¤ì— ëŒ€í•´ ë†’ì€ ì»¤ë²„ë¦¬ì§€ë¥¼ ìœ ì§€í•´ì•¼ í•œë‹¤ëŠ” ê²ƒì´ë‹¤. ê°€ì¥ í™•ì‹¤í•œ ê±´ í•˜ë‚˜ì˜ í´ë˜ìŠ¤ê°€ ì œëŒ€ë¡œ ë™ì‘í•˜ëŠ”ì§€ í™•ì¸í•  ìˆ˜ ìˆëŠ” <strong>ë‹¨ìœ„í…ŒìŠ¤íŠ¸</strong>ì´ë‹¤.<br>
<img loading="lazy" alt="í…ŒìŠ¤íŠ¸í”¼ë¼ë¯¸ë“œ [https://martinfowler.com/bliki/TestPyramid.html](https://martinfowler.com/bliki/TestPyramid.html)" src="/assets/images/Untitled 6-5ecf2d0767fd338463575c9a68deb301.png" width="560" height="300" class="img_E7b_"><br>
<!-- -->í…ŒìŠ¤íŠ¸í”¼ë¼ë¯¸ë“œ <a href="https://martinfowler.com/bliki/TestPyramid.html" target="_blank" rel="noopener noreferrer">https://martinfowler.com/bliki/TestPyramid.html</a><br>
<!-- -->ìœ„ë¡œ ì˜¬ë¼ ê°ˆ ìˆ˜ë¡ ë¹„ìš©ì´ ë¹„ì‹¸ì§„ë‹¤.  </p><br><h3 class="anchor anchorWithStickyNavbar_mojV" id="í…ŒìŠ¤íŠ¸ë¥¼-ì‘ì„±-í• -ë•Œ-ì§€ê¸ˆí•˜ë ¤ëŠ”-ëª©ì ì´-ë­”ì§€-ìƒê°í•´ì•¼í•œë‹¤">í…ŒìŠ¤íŠ¸ë¥¼ ì‘ì„± í•  ë•Œ ì§€ê¸ˆí•˜ë ¤ëŠ” ëª©ì ì´ ë­”ì§€ ìƒê°í•´ì•¼í•œë‹¤.<a class="hash-link" href="#í…ŒìŠ¤íŠ¸ë¥¼-ì‘ì„±-í• -ë•Œ-ì§€ê¸ˆí•˜ë ¤ëŠ”-ëª©ì ì´-ë­”ì§€-ìƒê°í•´ì•¼í•œë‹¤" title="Direct link to heading">â€‹</a></h3><p>í…ŒìŠ¤íŠ¸ëŠ” ì„œë¹„ìŠ¤ê°€ ëª¨í‚¹ëœ ëŒ€ìƒì˜ íŠ¹ì • ë©”ì„œë“œì™€ ìƒí˜¸ì‘ìš©í–ˆëŠ”ì§€ ì—¬ë¶€ë¥¼ ê²€ì‚¬ í•  ìˆ˜ ìˆëŠ”ë° ë§Œì•½ ëª¨ë“  ê²ƒì„ ê²€ì¦í•˜ë ¤ë‹¤ ë³´ë©´ í´ë˜ìŠ¤ê°€ ì¡°ê¸ˆì´ë¼ë„ ë³€ê²½ë˜ë©´ í…ŒìŠ¤íŠ¸ê°€ ì‰½ê²Œ ë³€ê²½ì´ëœë‹¤. ì´ëŠ” í…ŒìŠ¤íŠ¸ì˜ ë³¸ì§ˆì„ ë–¨ì–´ëœ¨ë¦¬ëŠ” í–‰ìœ„ê¸° ë•Œë¬¸ì— ë¶ˆí•„ìš”í•œ ë¶€ë¶„ì€ í…ŒìŠ¤íŠ¸ë¥¼ í•˜ì§€ ì•Šê³  <strong>ì¤‘ìš”í•œ í•µì‹¬ ë¹„ì§€ë‹ˆìŠ¤ë§Œ ê²€ì¦</strong>ì„ í•˜ëŠ” ê²ƒì´ ë” ë‚«ë‹¤.</p><br><h3 class="anchor anchorWithStickyNavbar_mojV" id="ì–¼ë§ˆë§Œí¼ì˜-í…ŒìŠ¤íŠ¸ë©´-ì¶©ë¶„í• ê¹Œ">ì–¼ë§ˆë§Œí¼ì˜ í…ŒìŠ¤íŠ¸ë©´ ì¶©ë¶„í• ê¹Œ?<a class="hash-link" href="#ì–¼ë§ˆë§Œí¼ì˜-í…ŒìŠ¤íŠ¸ë©´-ì¶©ë¶„í• ê¹Œ" title="Direct link to heading">â€‹</a></h3><p>ë¼ì¸ ì»¤ë²„ë¦¬ì§€ëŠ” ì¤‘ìš”í•˜ì§€ ì•Šë‹¤. 80% ë¡œë“  ì‹¬ì§€ì–´ 100%ë¡œë“  ë²„ê·¸ê°€ ì—†ë‹¤ê³  í•  ìˆ˜ ì—†ë‹¤. ì‚¬ëŒë§ˆë‹¤ ë‹¤ë¥´ê² ì§€ë§Œ ê·¸ëƒ¥ ë‚´ê°€ ë§ˆìŒì´ ë¶ˆì•ˆí•˜ì§€ì•Šê³  í¸í•˜ë‹¤ë©´ ì¶©ë¶„í•˜ë‹¤ê³  ìƒê°ì´ë“ ë‹¤. í…ŒìŠ¤íŠ¸ë¥¼ ì‹¤í–‰ í›„ì— ë§ˆìŒì´ í¸ì•ˆí•œ ìƒíƒœë¡œ ë°°í¬ë¥¼ í•  ìˆ˜ ìˆìœ¼ë©´ ì¶©ë¶„í•˜ë‹¤ê³  ë³¸ë‹¤.
ìœ¡ê°í˜• ì•„í‚¤í…ì²˜ì—ì„œì˜ í…ŒìŠ¤íŠ¸ ì „ëµì€ </p><ol><li><p>ë„ë©”ì¸ ì—”í‹°í‹°ë¥¼ êµ¬í˜„í•  ë•Œì—ëŠ” <strong>ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ë¡œ</strong> ì»¤ë²„  </p></li><li><p>ìœ ìŠ¤ì¼€ì´ìŠ¤ë¥¼ êµ¬í˜„ í•  ë•ŒëŠ” <strong><a href="https://github.com/sk1737030/til/blob/master/clean-architecture/src/test/java/com/clean/architecture/hexagonal/account/application/service/SendMoneyServiceTest.java" target="_blank" rel="noopener noreferrer">ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ë¡œ</a></strong> ì»¤ë²„</p></li><li><p>ì–´ëŒ‘í„°ë¥¼ êµ¬í˜„í•  ë•ŒëŠ” <strong><a href="https://github.com/sk1737030/til/blob/master/clean-architecture/src/test/java/com/clean/architecture/hexagonal/account/adapter/in/web/SendMoneyControllerTest.java" target="_blank" rel="noopener noreferrer">í†µí•© í…ŒìŠ¤íŠ¸ë¡œ</a></strong> ì»¤ë²„</p></li><li><p>ì‚¬ìš©ìê°€ ì·¨í•  ìˆ˜ ìˆëŠ” ì¤‘ìš” ì• í”Œë¦¬ì¼€ì´ì…˜ ê²½ë¡œëŠ” <a href="https://github.com/sk1737030/til/blob/e41051a996d373182946204aa5d94a51b7ab0f20/clean-architecture/src/test/java/com/clean/architecture/hexagonal/SendMoneySystemTest.java" target="_blank" rel="noopener noreferrer">ì‹œìŠ¤í…œ í…ŒìŠ¤íŠ¸ë¡œ</a> ì»¤ë²„</p><br></li></ol><p><code>ì‹œìŠ¤í…œ í…ŒìŠ¤íŠ¸</code>ì™€ <code>í†µí•©í…ŒìŠ¤íŠ¸</code> ì˜ ëª©ì ì€ ë‹¤ë¥´ë‹¤.</p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p><strong>í†µí•©í…ŒìŠ¤íŠ¸ëŠ”</strong> ì£¼ë¡œ  <code>@WebMvcTest</code> ì• ë„ˆí…Œì´ì…˜ì„ ì‚¬ìš©í•˜ì—¬ ìŠ¤í”„ë§ì´ íŠ¹ì • ìš”ì²­ ê²½ë¡œ, ìë°”ì™€ JSONê°„ì˜ ë§¤í•‘, http ì…ë ¥ ê²€ì¦, ì‘ë‹µ ê°’ ê²€ì¦ ë“±ì— í•„ìš”í•œ ì „ì²´ ê°ì²´ ë„¤íŠ¸ì›Œí¬ë¥¼ ì¸ìŠ¤í„´ìŠ¤í™”í•˜ë„ë¡ ë§Œë“ ë‹¤. ê·¸ë¦¬ê³  í…ŒìŠ¤íŠ¸ì—ì„œëŠ” ì›¹ ì»¨íŠ¸ë¡¤ëŸ¬ê°€ ë„¤íŠ¸ì›Œí¬ì˜ ì¼ë¶€ë¡œì„œ ì˜ ë™ì‘í•˜ëŠ”ì§€ ê²€ì¦í•˜ê¸° ë•Œë¬¸ì— í•„ìš”í•˜ë‹¤.</p></div></div><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>ìƒˆë¡œìš´ í•„ë“œë¥¼ ì¶”ê°€í•  ë•Œë§ˆë‹¤ í…ŒìŠ¤íŠ¸ë¥¼ ê³ ì¹˜ëŠ” ë° í•œ ì‹œê°„ì„ ì¨ì•¼ í•œë‹¤ë©´ ë­”ê°€ ì˜ëª»ëœê²ƒì´ë‹¤!!!! í…ŒìŠ¤íŠ¸ ì½”ë“œë„ ë¦¬íŒ©í† ë§ ëŒ€ìƒì´ë‹¤. ëª¨í‚¹í•˜ëŠ” ê²ƒì´ ë„ˆë¬´ ë²„ê±°ì›Œì§€ê±°ë‚˜ ì½”ë“œì˜ íŠ¹ì • ë¶€ë¶„ì„ ì»¤ë²„í•˜ê¸° ìœ„í•´ ì–´ë–¤ ì¢…ë¥˜ì˜ í…ŒìŠ¤íŠ¸ë¥¼ ì¨ì•¼ í• ì§€ ëª¨ë¥´ê² ë‹¤ë©´ ì´ëŠ” <strong>ê²½ê³  ì‹ í˜¸</strong>ì´ë‹¤.</p></div></div><br><h3 class="anchor anchorWithStickyNavbar_mojV" id="ì•„í‚¤í…ì²˜-ê²½ê³„-ê°•ì œí•˜ê¸°">ì•„í‚¤í…ì²˜ ê²½ê³„ ê°•ì œí•˜ê¸°<a class="hash-link" href="#ì•„í‚¤í…ì²˜-ê²½ê³„-ê°•ì œí•˜ê¸°" title="Direct link to heading">â€‹</a></h3><p><img loading="lazy" alt="[https://reflectoring.io/book/](https://reflectoring.io/book/)" src="/assets/images/Untitled 7-816662776ea7dd431b8eb0f2653b63d4.png" width="638" height="639" class="img_E7b_">
<a href="https://reflectoring.io/book/" target="_blank" rel="noopener noreferrer">https://reflectoring.io/book/</a> </p><p>ì• í”Œë¦¬ì¼€ì´ì…˜ ê³„ì¸µì€ ì• í”Œë¦¬ì¼€ì´ì…˜ ì„œë¹„ìŠ¤ì•ˆì— ìœ ìŠ¤ì¼€ì´ìŠ¤ë¥¼ êµ¬í˜„í•˜ê¸° ìœ„í•´ ë„ë©”ì¸ ì—”í‹°í‹°ì— ì ‘ê·¼í•œë‹¤.<br>
<!-- -->ì–´ëŒ‘í„°ëŠ” ì¸ì»¤ë° í¬íŠ¸ë¥¼í†µí•´ ì„œë¹„ìŠ¤ì— ì ‘ê·¼í•˜ê³ , ë°˜ëŒ€ë¡œ ì„œë¹„ìŠ¤ëŠ” ì•„ì›ƒê³ ì‰ í¬íŠ¸ë¥¼ í†µí•´ ì–´ëŒ‘í„°ì— ì ‘ê·¼í•œë‹¤.<br>
<!-- -->ë§ˆì§€ë§‰ìœ¼ë¡œ ì„¤ì • ê³„ì¸µì€ ì–´ëŒ‘í„°ì™€ ì„œë¹„ìŠ¤ ê°ì²´ë¥¼ ìƒì„±í•  íŒ©í„°ë¦¬ë¥¼ í¬í•¨í•˜ê³  ìˆê³ , ì˜ì¡´ì„± ì£¼ì‹­ ë©”ì»¤ë‹ˆì¦˜ì„ ì œê³µí•œë‹¤.<br>
<!-- -->ì˜ì¡´ì„± ê·œì¹™ì— ë”°ë¥´ë©´ ê³„ì¸µ ê²½ê³„ë¥¼ ë„˜ëŠ” ì˜ì¡´ì„±ì€ í•­ìƒ ì•ˆìª½ë°©í–¥ìœ¼ë¡œ í–¥í•´ì•¼ í•œë‹¤.  </p><br><p>ê²½ê³„í‘œì‹œë¥¼ ìœ„í•´ì„œ ìë°”ì—ì„œ ë§ì´ ì“°ëŠ” ë°©ë²•ì´  ì ‘ê·¼ì œí•œìë¥¼ ì“°ëŠ” ê²ƒì´ë‹¤. <code>package-private(default)</code>, <code>protectect</code>, <code>private</code> ë¥¼ ì‚¬ìš©í•œë‹¤.</p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p><code>package-private</code>ëŠ” ë§ŒëŠ¥ì´ ì•„ë‹ˆë‹¤. íŒ¨í‚¤ì§€ ë‚´ì— í´ë˜ìŠ¤ê°€ íŠ¹ì • ê°œìˆ˜ë¥¼ ë„˜ì–´ê°€ê¸° ì‹œì‘í•˜ë©´ í•˜ë‚˜ì˜ íŒ¨í‚¤ì§€ì— ë„ˆë¬´ ë§ì€ í´ë˜ìŠ¤ë¥¼ í¬í•¨í•˜ëŠ” ê²ƒì´ í˜¼ë€ìŠ¤ëŸ¬ì›Œì§€ê²Œ ëœë‹¤. ì´ë ‡ê²Œ ë˜ë©´ ì½”ë“œë¥¼ ì‰½ê²Œ ì°¾ì„ ìˆ˜ ìˆë„ë¡ í•˜ìœ„ íŒ¨í‚¤ì§€ë¥¼ ë‘ê²Œ ë˜ëŠ”ë° ìë°”ëŠ” í•˜ìœ„ íŒ¨í‚¤ì§€ë¥¼ ë‹¤ë¥¸ íŒ¨í‚¤ì§€ë¡œ ì·¨ê¸‰í•˜ê¸° ë•Œë¬¸ì— í•˜ìœ„ íŒ¨í‚¤ì§€ì˜ package-private ë©¤ë²„ì— ì ‘ê·¼í•  ìˆ˜ ì—†ê²Œ ëœë‹¤. ê·¸ë˜ì„œ í•˜ìœ„ íŒ¨í‚¤ì§€ì˜ ë©¤ë²„ëŠ” publicìœ¼ë¡œ ë§Œë“¤ì–´ì„œ ë°”ê¹¥ ì„¸ê³„ì— ë…¸ì¶œì‹œì¼œì•¼ í•˜ê¸° ë•Œë¬¸ì— ê·œì¹™ì´ ê¹¨ì§ˆ ìˆ˜ ìˆë‹¤.</p></div></div><br><h3 class="anchor anchorWithStickyNavbar_mojV" id="ê¹¨ì§„ì°½ë¬¸ì´ë¡ ">ê¹¨ì§„ì°½ë¬¸ì´ë¡ <a class="hash-link" href="#ê¹¨ì§„ì°½ë¬¸ì´ë¡ " title="Direct link to heading">â€‹</a></h3><ul><li>í’ˆì§ˆì´ ë–¨ì–´ì§„ ì½”ë“œì—ì„œ ì‘ì—…í•  ë•Œ ë” ë‚®ì€ í’ˆì§ˆì˜ ì½”ë“œë¥¼ ì¶”ê°€í•˜ê¸°ê°€ ì‰½ë‹¤.  </li><li>í…ŒìŠ¤íŠ¸ì½”ë“œê°€ ì—†ëŠ” ì½”ë“œëŠ” í…ŒìŠ¤íŠ¸ì½”ë“œë¥¼ ì¶”ê°€í•˜ì§€ ì•Šê¸° ì‰½ë‹¤.  </li><li>ì§€ë¦„ê¸¸ì„ ë§ì´ ì‚¬ìš©í•œ ì½”ë“œì—ì„œ ì‘ì—…í•  ë•Œ ë˜ ë‹¤ë¥¸ ì§€ë¦„ê¸¸ì„ ì¶”ê°€í•˜ê¸° ì‰½ë‹¤.  </li><li>ì½”ë”© íì¹™ì„ ë§ì´ ì–´ê¸´ ì½”ë“œì—ì„œ ì‘ì—…í•  ë•Œ ë˜ ë‹¤ë¥¸ íì¹™ì„ ì–´ê¸°ê¸°ë„ ì‰½ë‹¤.  </li><li>ê¹ƒ ë¸Œëœì¹˜ë¥¼ ì–´ì§€ëŸ½ê²Œ í•˜ë©´ ì ì  ë” ì–´ì§€ëŸ¬ì›Œì§„ë‹¤.  </li></ul><br><h3 class="anchor anchorWithStickyNavbar_mojV" id="ì˜ì‹ì ìœ¼ë¡œ-ì§€ë¦„ê¸¸ì„-ì‚¬ìš©í•˜ê¸°">ì˜ì‹ì ìœ¼ë¡œ ì§€ë¦„ê¸¸ì„ ì‚¬ìš©í•˜ê¸°<a class="hash-link" href="#ì˜ì‹ì ìœ¼ë¡œ-ì§€ë¦„ê¸¸ì„-ì‚¬ìš©í•˜ê¸°" title="Direct link to heading">â€‹</a></h3><p>ì§€ë¦„ê¸¸ì´ ê¼­ ë‚˜ìœê±´ ì•„ë‹ˆë‹¤. ë•Œë¡œëŠ” ì‹œê°„ì , ê²½ì œì ë“± ë‹¤ì–‘í•œì´ìœ ë¡œ ì‚¬ìš© í•  ìˆ˜ ìˆë‹¤. ì´ë•Œì—ëŠ” ì˜ë„ì ìœ¼ë¡œ ì§€ë¦„ê¸¸ì„ ì‚¬ìš©í–ˆë‹¤ëŠ” ì‚¬ì‹¤ì„ ë¬¸ì„œë¡œ ë‚¨ê¸°ê³  íŒ€ì— ê³µìœ í•˜ì ê·¸ëŸ¬ë©´ ê¹¨ì§„ ì°½ë¬¸ ì´ë¡ ì˜ ì˜í–¥ì„ ë” ì¤„ì¼ ìˆ˜ ìˆì„ ê²ƒì´ë‹¤.  </p><ul><li>ì¸ì»¤ë° í¬íŠ¸ ê±´ë„ˆë›°ê¸°<ul><li>ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ ì„œë¹„ìŠ¤ ë°”ë¡œ ì ‘ê·¼í•˜ê¸°</li></ul></li><li>ì• í”Œë¦¬ì¼€ì´ì…˜ ì„œë¹„ìŠ¤ ê±´ë„ˆë›°ê¸°<ul><li>ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ ë ˆí¬ì§€í† ë¦¬ ë°”ë¡œ ì ‘ê·¼í•˜ê¸°</li></ul></li><li>ë„ë©”ì¸ ì—”í‹°í‹°ë¥¼ ì…ì¶œë ¥ ëª¨ë¸ë¡œ ì‚¬ìš©í•˜ê¸°</li><li>ìœ ìŠ¤ì¼€ì´ìŠ¤ê°„ ê°™ì€ ëª¨ë¸ ê³µìœ í•˜ê¸°<ul><li>ë‹¤ë¥¸ ìœ ìŠ¤ì¼€ì´ìŠ¤ì¸ë° ê°™ì€ ëª¨ë¸ì„ ê³µìœ </li></ul></li></ul><br><h3 class="anchor anchorWithStickyNavbar_mojV" id="ë„ë©”ì¸ì´-ì™•ì´ë‹¤">ë„ë©”ì¸ì´ ì™•ì´ë‹¤<a class="hash-link" href="#ë„ë©”ì¸ì´-ì™•ì´ë‹¤" title="Direct link to heading">â€‹</a></h3><p>ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ê°œë°œ í•  ë•Œ ë„ë©”ì¸ì´ ì •ë§ ì¤‘ìš”í•˜ë‹¤ë©´, ìœ¡ê°í˜• ì•„í‚¤í…ì²˜ë¥¼ ì‚¬ìš© í•  ìˆ˜ ìˆë‹¤. <code>ì™¸ë¶€ì˜ ì˜í–¥ì„ ë°›ì§€ ì•Šê³  ë„ë©”ì¸ ì½”ë“œë¥¼ ììœ ë¡­ê²Œ ë°œì „ì‹œí‚¬ ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì€ ìœ¡ê°í˜• ì•„í‚¤í…ì²˜ ìŠ¤íƒ€ì¼ì´ ë‚´ì„¸ìš°ëŠ” ê°€ì¥ ì¤‘ìš”í•œ ê°€ì¹˜ë‹¤.</code>  ìœ¡ê°í˜• ì•„í‚¤í…ì²˜ëŠ” ë‹¹ì—°í•œ ë§ì´ê² ì§€ë§Œ DDDì˜ ì¡°ë ¥ìì´ë‹¤.   </p><br><h3 class="anchor anchorWithStickyNavbar_mojV" id="ê²½í—˜ì´-ì—¬ì™•ì´ë‹¤">ê²½í—˜ì´ ì—¬ì™•ì´ë‹¤.<a class="hash-link" href="#ê²½í—˜ì´-ì—¬ì™•ì´ë‹¤" title="Direct link to heading">â€‹</a></h3><p>ì¸ê°„ì€ ìŠµê´€ì˜ ë™ë¬¼ì´ê¸° ë•Œë¬¸ì— í¸ì•ˆí•œ ê¸¸ë¡œ ê°€ë ¤ê³ í•œë‹¤. ë¬¼ë¡  ì´ê²Œ ë‚˜ìœ ê²°ì •ì´ ì•„ë‹ˆì§€ë§Œ ë‹¤ë¥¸ ê²½í—˜ë„ í•´ë³´ë©´ ë” ì¢‹ì€ ê¸¸ì„ ì°¾ì„ ìˆ˜ ìˆê¸° ë•Œë¬¸ì—, ì‘ì€ ëª¨ë“ˆë¶€í„° ì‹œì‘ì„ í•´ì„œ ê²½í—˜ì„ í•´ë‚˜ê°€ëŠ” ì—°ìŠµì„ ê°€ì§€ì. ë‚´ê°€ ìƒê° í–ˆì„ ë•ŒëŠ”  ì¤‘ìš”í•œ ê²ƒì€ <code>ì •ë‹µì€ ì—†ë‹¤</code> ê·¸ë•Œê·¸ë•Œ ë‹¤ë¥´ë‹¤ ë„ë©”ì¸ë§ˆë‹¤ ë‹¤ë¥´ê³  ì–´ë–¤ ì†Œí”„íŠ¸ì›¨ì–´ë¥¼ ë§Œë“œëƒì— ë‹¤ë¥´ê³  íŒ€ì˜ ê²½í—˜ì— ë”°ë¼ ë‹¤ë¥´ë‹¤ ê·¸ë¦¬ê³  ë‚´ ë§ˆìŒì— ë“œëŠëƒì— ë”°ë¼ì„œë„ ë‹¤ë¥´ë‹ˆ ì •ë‹µì´ ì—†ë‹¤.  </p><br><br><p>ì°¸ê³ <br>
<a href="http://www.kyobobook.co.kr/product/detailViewKor.laf?ejkGb=KOR&amp;mallGb=KOR&amp;barcode=9791158392758&amp;orderClick=LAG&amp;Kc=" target="_blank" rel="noopener noreferrer">ë§Œë“¤ë©´ì„œ ë°°ìš°ëŠ” í´ë¦° ì•„í‚¤í…ì²˜</a><br>
<a href="https://blog.cleancoder.com/uncle-bob/2012/08/13/the-clean-architecture.html" target="_blank" rel="noopener noreferrer">ë¡œë²„íŠ¸ë§ˆë¥´í‹´í˜•ì˜ì›ë¬¸</a> â†’ <a href="https://blog.coderifleman.com/2017/12/18/the-clean-architecture/" target="_blank" rel="noopener noreferrer">í•œê¸€ë²ˆì—­</a><br>
<a href="https://martinfowler.com/bliki/TestPyramid.html" target="_blank" rel="noopener noreferrer">ë§ˆí‹´í˜•ì˜í…ŒìŠ¤íŠ¸í”¼ë¼ë¯¸ë“œ</a></p>]]></content>
        <author>
            <name>Dongle</name>
            <uri>https://github.com/sk1737030</uri>
        </author>
        <category label="Spring Boot" term="Spring Boot"/>
        <category label="Clean Architecture" term="Clean Architecture"/>
        <category label="Book" term="Book"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[ë§Œë“¤ë©´ì„œ ë°°ìš°ëŠ” í´ë¦° ì•„í‚¤í…ì²˜ ì •ë¦¬ - 1]]></title>
        <id>clean-arch-1</id>
        <link href="https://dgle.dev/clean-arch-1"/>
        <updated>2022-06-25T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Clean Architecture Study - 1]]></summary>
        <content type="html"><![CDATA[<p>ë§Œë“¤ë©´ì„œ ë°°ëŠ” í´ë¦° ì•„í‚¤í…ì²˜ë¥¼ ì½ê³  ê³µë¶€í•œ ë‚´ìš©ì„ ì •ë¦¬. - 1</p><p>ëª¨ë“  ì†ŒìŠ¤ëŠ” <a href="https://github.com/sk1737030/til/tree/master/clean-architecture" target="_blank" rel="noopener noreferrer">ì´ê³³ì—</a> ìˆìŠµë‹ˆë‹¤:)</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="ê³„ì¸µí˜•-ì•„í‚¤í…ì²˜ì˜-ë¬¸ì œì ">ê³„ì¸µí˜• ì•„í‚¤í…ì²˜ì˜ ë¬¸ì œì <a class="hash-link" href="#ê³„ì¸µí˜•-ì•„í‚¤í…ì²˜ì˜-ë¬¸ì œì " title="Direct link to heading">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_mojV" id="1-ì„œë¹„ìŠ¤ì—ì„œ-ì˜ì†ì„±ì—-ê°•í•œ-ê²°í•©ì´-ìƒê¸´ë‹¤">1. ì„œë¹„ìŠ¤ì—ì„œ ì˜ì†ì„±ì— ê°•í•œ ê²°í•©ì´ ìƒê¸´ë‹¤<a class="hash-link" href="#1-ì„œë¹„ìŠ¤ì—ì„œ-ì˜ì†ì„±ì—-ê°•í•œ-ê²°í•©ì´-ìƒê¸´ë‹¤" title="Direct link to heading">â€‹</a></h3><p><img loading="lazy" alt="Untitled" src="/assets/images/Untitled-43962373f5c365a4e0c6dd908ed1bde7.png" width="1364" height="734" class="img_E7b_">
ì¼ë°˜ì ì¸ í”„ë¡œì íŠ¸ êµ¬ì¡°ìƒ ì„œë¹„ìŠ¤ëŠ” ì˜ì†ì„± ëª¨ë¸ì„ ë¹„ì§€ë‹ˆìŠ¤ ëª¨ë¸ì²˜ëŸ¼ ì‚¬ìš©í•˜ê²Œ ë˜ê³  ì´ë¡œ ì¸í•´ ë„ë©”ì¸ ë¡œì§ë¿ë§Œ ì•„ë‹ˆë¼ ì—¬ëŸ¬ ì˜ì†ì„± ê³„ì¸µê³¼ ê´€ë ¨ëœ ì‘ì—…ë“¤ì„(íŠ¸ëœì­ì…˜, ì¦‰ì‹œë¡œë”©, ì§€ì—°ë¡œë”©, ìºì‹œ í”ŒëŸ¬ì‹œ)ë“±ë“±ì„ í•´ì•¼í•œë‹¤.  </p><br><h3 class="anchor anchorWithStickyNavbar_mojV" id="2-ì§€ë¦„ê¸¸ì„-íƒí•˜ê¸°-ì‰¬ì›Œì§„ë‹¤">2. ì§€ë¦„ê¸¸ì„ íƒí•˜ê¸° ì‰¬ì›Œì§„ë‹¤<a class="hash-link" href="#2-ì§€ë¦„ê¸¸ì„-íƒí•˜ê¸°-ì‰¬ì›Œì§„ë‹¤" title="Direct link to heading">â€‹</a></h3><p><img loading="lazy" alt="Untitled" src="/assets/images/Untitled 1-e6377eb94a979516c00ca865ca028415.png" width="1400" height="626" class="img_E7b_">
ì—¬ëŸ¬ëª…ì´ ê°œë°œí•˜ê³  ì‹œê°„ì´ ì§€ë‚˜ë‹¤ë³´ë©´ ìœ í‹¸ë¦¬í‹°, í—¬í¼ ë“± ì—¬ëŸ¬ ì»´í¬ë„ŒíŠ¸ë“¤ì´ ì˜ì†ì„±ì— ì¶”ê°€í•˜ì—¬ ê°œë°œì„ í•˜ê¸°ì‰½ê³  í¸í•˜ê¸° ë•Œë¬¸ì— ê²°êµ­ ì˜ì†ì„± ë ˆì´ì–´ê°€ ë¹„ëŒ€í•´ì§€ëŠ” í˜„ìƒì´ ì¼ì–´ë‚˜ê²Œëœë‹¤.  </p><br><h3 class="anchor anchorWithStickyNavbar_mojV" id="3-ì„œë¹„ìŠ¤-ê³„ì¸µì„-ìŠ¤í‚µ-í• -ìˆ˜ê°€-ìˆë‹¤">3. ì„œë¹„ìŠ¤ ê³„ì¸µì„ ìŠ¤í‚µ í•  ìˆ˜ê°€ ìˆë‹¤<a class="hash-link" href="#3-ì„œë¹„ìŠ¤-ê³„ì¸µì„-ìŠ¤í‚µ-í• -ìˆ˜ê°€-ìˆë‹¤" title="Direct link to heading">â€‹</a></h3><p><img loading="lazy" alt="Untitled" src="/assets/images/Untitled 2-e09a412c92e8ef89f563909c5a51e694.png" width="1390" height="848" class="img_E7b_"></p><p>ê°„ë‹¨í•œ ë””ë¹„ ì €ì¥ì¼ë¿ì¸ ë‹¨ìˆœí•œ APIì¼ ê²½ìš° ì¤‘ê°„ì— ìˆëŠ” ì„œë¹„ìŠ¤ë¥¼ ê±´ë„ˆë›°ê³  ë°”ë¡œ ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ ì˜ì†ì„± ê³„ì¸µì— ì ‘ê·¼ì„ í•´ì„œ ì‘ì—…ì„ í•  ë•Œê°€ ìˆëŠ”ë° ì´ë ‡ê²Œ ë˜ë©´ ì—¬ëŸ¬ ë¬¸ì œë“¤ì´ ë°œìƒ í•  ìˆ˜ ìˆë‹¤. </p><p>ì²« ë²ˆì§¸ ë¬¸ì œëŠ” ìš”êµ¬ì‚¬í•­ì´ ë³€ê²½ì´ë˜ë©´ Controller ì—¬ëŸ¬ ì¶”ê°€ì ì¸ ì±…ì„ë“¤ì´ ì¶”ê°€ê°€ë˜ê¸° ì‰¬ì›Œì§€ëŠ”ë°(í˜¼ì í•  ë•ŒëŠ” ê´œì°®ì§€ë§Œ, ì—¬ëŸ¬ì‚¬ëŒì´ í˜‘ì—…ì„í•˜ë‹¤ ë³´ë©´), ë ˆì´ì–´ê°„ì˜ ì±…ì„ì´ ì •ë§ ì• ë§¤ëª¨í˜¸í•´ ì§€ê²Œëœë‹¤. </p><p>ë‘ ë²ˆì§¸ ë¬¸ì œëŠ” í…ŒìŠ¤íŠ¸ ì½”ë“œì—ì„œì˜ ë³µì¡ë„ê°€ ì˜¬ë¼ê°€ê²Œ ëœë‹¤. mockì„ ë§Œë“œëŠ” ë“± ì¶”ê°€ì ì¸ ì‘ì—…ì„ í•´ì•¼ í•  í•„ìš”ê°€ ìˆê²Œë˜ëŠ”ë° ì´ëŸ¬ë©´ í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ì´í•´í•˜ëŠ”ë°ë„ ì‹œê°„ì´ ë” ê±¸ë¦¬ê³  ê·¸ëŸ¬ë©´ í…ŒìŠ¤íŠ¸ ì½”ë“œ ì§œê¸°ê°€ ì ì  ë” í˜ë“¤ì–´ì§€ê³  ì‹«ì–´ì§€ê²Œëœë‹¤. </p><br><h3 class="anchor anchorWithStickyNavbar_mojV" id="4-ìˆ˜ì •ì´-í˜ë“¤ì–´ì§„ë‹¤">4. ìˆ˜ì •ì´ í˜ë“¤ì–´ì§„ë‹¤.<a class="hash-link" href="#4-ìˆ˜ì •ì´-í˜ë“¤ì–´ì§„ë‹¤" title="Direct link to heading">â€‹</a></h3><p><img loading="lazy" alt="Untitled" src="/assets/images/Untitled 3-d4ff12083fb582a34b5b03a1ea408da3.png" width="1370" height="826" class="img_E7b_"></p><p>ì—¬ëŸ¬ëª…ì´ í˜‘ì—…ì„í•˜ë©´ì„œ ì‹œê°„ì´ íë¥´ë‹¤ë³´ë©´ ì„œë¹„ìŠ¤ê³„ì¸µì˜ ì±…ì„ì´ ì ì  ë§ì•„ì§€ê²Œ ë˜ëŠ”ë°, ì´ë ‡ê²Œ ì§„í–‰ë˜ë‹¤ë³´ë©´ í…ŒìŠ¤íŠ¸ ì½”ë“œë„ ì§œê¸°ê°€ ì ì  í˜ë“¤ì–´ì§€ê³ , ê¸°ëŠ¥ì„ ì¶”ê°€ í˜¹ì€ ìˆ˜ì • í•´ì•¼ í•  ë•Œ ì„ ëœ» ì‚¬ì´ë“œ ì´í™íŠ¸ë¥¼ ì˜ˆì¸¡í•˜ê¸°ê°€ í˜ë“¤ì–´ì§€ê²Œ ëœë‹¤.</p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>ê¸°íšì: ì´ê±° ê¸°íšì´ ì¶”ê°€ë˜ì–´ì„œ, ê°„ë‹¨í•œ ê¸°ëŠ¥ í•˜ë‚˜ ì¶”ê°€ í•  ìˆ˜ ìˆì„ê¹Œìš”?<br>
<!-- -->ë‚˜: ìŒ.. ì´ê±´ í•œ ë²ˆ ë´ì•¼í•  ê±° ê°™ì•„ìš”. ì¡°ê¸ˆ ì†ŒìŠ¤ê°€ ë³µì¡í•´ì„œâ€¦ (ë˜ë¥´ë¥µ)</p></div></div><br><h2 class="anchor anchorWithStickyNavbar_mojV" id="ìœ¡ê°í˜•-ì•„í‚¤í…ì³í—¥ì‚¬ê³ ë‚ ">ìœ¡ê°í˜• ì•„í‚¤í…ì³(í—¥ì‚¬ê³ ë‚ )<a class="hash-link" href="#ìœ¡ê°í˜•-ì•„í‚¤í…ì³í—¥ì‚¬ê³ ë‚ " title="Direct link to heading">â€‹</a></h2><p><img loading="lazy" alt="Untitled" src="/assets/images/Untitled 4-fc7f43037533474f4154affedf6ea8bd.png" width="1518" height="816" class="img_E7b_"></p><p>ìœ¡ê°í˜• ì•„í‚¤í…ì²˜ëŠ” ì•Œë¦¬ìŠ¤í…Œì–´ ì½”ë²ˆì´ ë§Œë“  ìš©ì–´ë¡œ, ë¡œë²„íŠ¸ ë§ˆí‹´ì´ í´ë¦° ì°¨í‚¤í…ì²˜ì—ì„œ ì¡°ê¸ˆ ë” ì¼ë°˜ì ì¸ ìš©ì–´ë¡œ ì„¤ëª… í•˜ì˜€ë‹¤. </p><p>ì•ˆì—ëŠ” ë„ë©”ì¸ ì—”í‹°í‹°ì™€ ì´ì™€ ìƒí˜¸ì‘ìš©í•˜ëŠ” ìœ ìŠ¤ì¼€ì´ìŠ¤ê°€ ìˆë‹¤. ìœ¡ê°í˜• ë°”ê¹¥ì—ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ê³¼ ìƒí˜¸ì‘ìš©í•˜ëŠ” ë‹¤ì–‘í•œ ì–´ëŒ‘í„°ë“¤ì´ ìˆë‹¤. </p><p>ì™¼ìª½ì— ìˆëŠ” ì–´ëŒ‘í„°ë“¤ì€ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì£¼ë„í•˜ëŠ” ì–´ëŒ‘í„°ë“¤ì´ë‹¤. ì½”ì–´ì™€ ì–´ëŒ‘í„°ë“¤ê°„ì— í†µì‹ ì„ í•˜ë ¤ë©´ ê°ê°ì˜ í¬íŠ¸ë“¤ì„ ì œê³µí•´ì•¼í•œë‹¤. ì´ í¬íŠ¸ë“¤ì€ <strong>ì¸í„°í˜ì´ìŠ¤</strong>ë“¤ì´ ë˜ëŠ” ê²ƒì´ë‹¤. </p><p>ê°€ì¥ ë°”ê¹¥ìª½ì— ìˆëŠ” ê³„ì¸µì€ ì• í”Œë¦¬ì¼€ì´ì…˜ê³¼ ë‹¤ë¥¸ ì‹œìŠ¤í…œ ê°„ì˜ ë²ˆì—­ì„ ë‹´ë‹¹í•˜ëŠ” ì–´ëŒ‘í„°ë¡œ êµ¬ì„±ë˜ì–´ ìˆë‹¤. </p><br><h3 class="anchor anchorWithStickyNavbar_mojV" id="caseë§ˆë‹¤-ë‹¤ë¥¸-ì¶œë ¥-ëª¨ë¸">Caseë§ˆë‹¤ ë‹¤ë¥¸ ì¶œë ¥ ëª¨ë¸<a class="hash-link" href="#caseë§ˆë‹¤-ë‹¤ë¥¸-ì¶œë ¥-ëª¨ë¸" title="Direct link to heading">â€‹</a></h3><p>í•­ìƒ ë‚˜ëŠ” ì´ ì§ˆë¬¸ì— ê³ ë¯¼ì„ ë§ì´ í–ˆë‹¤. í˜¸ì¶œìì—ê²Œ ì •ë³´ë¥¼ ì–´ë””ê¹Œì§€ ì¤˜ì•¼í• ê¹Œë¼ëŠ” ì§ˆë¬¸ì— ì‚¬ì‹¤ ì •ë‹µì´ ì—†ì§€ë§Œ, ì—¬ëŸ¬ ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ ê°™ì€ ì„œë¹„ìŠ¤ì— ì ‘ê·¼ì„ í•´ì•¼ í•  ë•Œ ì²˜ìŒì—ëŠ” ê°™ì€ ëª¨ë¸ë¡œ ëŒë ¤ì£¼ê²Œ ê°œë°œì„ í•˜ê³  ë‚˜ì¤‘ì— ì‹œê°„ì´ ì§€ë‚˜ ì ì  ëˆˆë©ì´ì²˜ëŸ¼ ì ì  ì»¤ì§€ëŠ” ëª¨ë¸ë“¤ì„ ê²½í—˜ì„ ë§ì´ í•´ì„œ ê³ ë¯¼ì´ ë§ì•˜ëŠ”ë° ì±…ì—ì„œ í•˜ëŠ” ë§ì´ </p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>ìœ ìŠ¤ì¼€ì´ìŠ¤ë¥¼ ê°€ëŠ¥í•œ í•œ êµ¬ì²´ì ìœ¼ë¡œ ìœ ì§€í•˜ê¸° ìœ„í•´ì„œëŠ” <strong>ê³„ì† ì§ˆë¬¸ì„ í•´ì•¼í•œë‹¤</strong>. ë§Œì•½ ì˜ì‹¬ìŠ¤ëŸ½ë‹¤ë©´ ê°€ëŠ¥í•œ í•œ ì ê²Œ ë°˜í™˜í•˜ì. ìœ ìŠ¤ì¼€ì´ìŠ¤ë“¤ ê°„ì— ê°™ì€ ì¶œë ¥ ëª¨ë¸ì„ ê³µìœ í•˜ê²Œ ë˜ë©´ ìœ ìŠ¤ì¼€ì´ìŠ¤ë“¤ë„ ê°•í•˜ê²Œ ê²°í•©ëœë‹¤. í•œ ìœ ìŠ¤ì¼€ì´ìŠ¤ì—ì„œ ì¶œë ¥ ëª¨ë¸ì— ìƒˆë¡œìš´ í•„ë“œê°€ í•„ìš”í•´ì§€ë©´ ì´ ê°’ê³¼ ê´€ë ¨ì´ ì—†ëŠ” ë‹¤ë¥¸ ìœ ìŠ¤ì¼€ì´ìŠ¤ë“¤ì—ì„œë„ ì´ í•„ë“œë¥¼ ì²˜ë¦¬í•´ì•¼ í•œë‹¤. ê³µìœ  ëª¨ë¸ì€ ì¥ê¸°ì ìœ¼ë¡œ ë´¤ì„ ë•Œ ê°–ê°€ì§€ ì´ìœ ë¡œ ì ì  ì»¤ì§€ê²Œ ë¼ ìˆë‹¤. <strong>ë‹¨ì¼ ì±…ì„ ì›ì¹™ì„ ì ìš©í•˜ê³  ëª¨ë¸ì„ ë¶„ë¦¬í•´ì„œ ìœ ì§€í•˜ëŠ” ê²ƒì€ ìœ ìŠ¤ì¼€ì´ìŠ¤ì˜ ê²°í•©ì„ ì œê±°í•˜ëŠ” ë° ë„ì›€ì´ ëœë‹¤.</strong></p></div></div><br><h3 class="anchor anchorWithStickyNavbar_mojV" id="ì›¹-ì–´ëŒ‘í„°ì˜-ì±…ì„">ì›¹ ì–´ëŒ‘í„°ì˜ ì±…ì„<a class="hash-link" href="#ì›¹-ì–´ëŒ‘í„°ì˜-ì±…ì„" title="Direct link to heading">â€‹</a></h3><ol><li>HTTP ìš”ì²­ì„ ìë°” ê°ì²´ë¡œ ë§¤í•‘</li><li>ê¶Œí•œ ê²€ì‚¬</li><li>ì…ë ¥ ìœ íš¨ì„±ê²€ì¦<ul><li>ìœ ìŠ¤ì¼€ì´ìŠ¤ì—ì„œì˜ ì…ë ¥ ëª¨ë¸ ê²€ì¦ê³¼ ì–´ëŒ‘í„°ì—ì„œì˜ ê²€ì¦ì˜ ì°¨ì´ëŠ” <strong>ë§¥ë½ì˜ ì°¨ì´</strong>ì¸ë° ìœ ìŠ¤ì¼€ì´ìŠ¤ì—ì„œì˜ ì…ë ¥ ëª¨ë¸ì—ì„œ ìœ íš¨í•œ ì…ë ¥ë§Œ í—ˆìš©í•´ì•¼í•œë‹¤. ë‚´ ìƒê°ì—ëŠ” ì¶œê¸ˆê³¼ ê´€ë ¨ëœ ìœ ìŠ¤ì¼€ì´ìŠ¤ì—ì„œ ìœ ìŠ¤ì¼€ì´ìŠ¤ì—ì„œ ê²€ì¦ í•  ë•Œ ìˆì„ ë•Œ â€˜ì”ê¸ˆì€ ëˆì€ 0ì› ë³´ë‹¤ ë” ì»¤ì•¼ í•œë‹¤â€™ ì˜ ì°¨ì´ ì´ì§€ ì•Šì„ê¹Œë¼ê³  ìƒê°ë“ ë‹¤.</li></ul></li><li>ì…ë ¥ì„ ìœ ìŠ¤ì¼€ì´ìŠ¤ì˜  ì…ë ¥ ëª¨ë¸ë¡œ ë§¤í•‘</li><li>ìœ ìŠ¤ì¼€ì´ìŠ¤ í˜¸ì¶œ</li><li>ìœ ìŠ¤ì¼€ì´ìŠ¤ì˜ ì¶œë ¥ì„ HTTPë¡œ ë§¤í•‘</li><li>HTTP ì‘ë‹µì„ ë°˜í™˜</li></ol><br><h3 class="anchor anchorWithStickyNavbar_mojV" id="createë¡œ-ì´ë¦„ì„-ì§–ëŠ”ê±°ëŠ”-ì§€ì–‘í•˜ì">Createë¡œ ì´ë¦„ì„ ì§–ëŠ”ê±°ëŠ” ì§€ì–‘í•˜ì<a class="hash-link" href="#createë¡œ-ì´ë¦„ì„-ì§–ëŠ”ê±°ëŠ”-ì§€ì–‘í•˜ì" title="Direct link to heading">â€‹</a></h3><p>ì´ë¯¸ ì–´ë”˜ê°€ì— ë§ì´ ì“°ì´ê³  ìˆëŠ” ì˜ˆì•½ì–´ì´ê¸° ë•Œë¬¸ì— Createâ†’Register ë¡œ ë³€ê²½í•˜ì—¬ ì´ë¦„ì„ ì§–ì.<br>
<!-- -->CreteAccountController â†’ RegisterAccountController<br>
<!-- -->Create, Update, Delete â€¦ namingìœ¼ë¡œ ì—­í• ì„ ë§Œë“¤ê¸° ì „ì— í•œ ë²ˆë” ìƒê°ì„ í•´ë³´ëŠ” ê²Œ ì¢‹ë‹¤.  </p><br><h3 class="anchor anchorWithStickyNavbar_mojV" id="ì—¬ëŸ¬-ì‘ì€-í´ë˜ìŠ¤ë“¤ì„-ë§Œë“œëŠ”-ê²ƒì„-ë‘ë ¤ì›Œí•´ì„œëŠ”-ì•ˆëœë‹¤">ì—¬ëŸ¬ ì‘ì€ í´ë˜ìŠ¤ë“¤ì„ ë§Œë“œëŠ” ê²ƒì„ ë‘ë ¤ì›Œí•´ì„œëŠ” ì•ˆëœë‹¤.<a class="hash-link" href="#ì—¬ëŸ¬-ì‘ì€-í´ë˜ìŠ¤ë“¤ì„-ë§Œë“œëŠ”-ê²ƒì„-ë‘ë ¤ì›Œí•´ì„œëŠ”-ì•ˆëœë‹¤" title="Direct link to heading">â€‹</a></h3><p>ì—¬ëŸ¬ ì‘ì€ í´ë˜ìŠ¤ë“¤ì„ ë§Œë“œëŠ” ê²ƒì„ ë‘ë ¤ì›Œí•´ì„œëŠ” ì•ˆëœë‹¤. ì‘ì€ í´ë˜ìŠ¤ë“¤ì€ íŒŒì•…í•˜ê¸° ì‰½ê³ , í…ŒìŠ¤íŠ¸í•˜ê¸° ì‰½ê³ , ì—¬ëŸ¬ëª…ì´ì„œ ì‘ì—…ì„ í•  ìˆ˜ ìˆê²Œëœë‹¤. ì²˜ìŒì—ëŠ” ê³µìˆ˜ê°€ ë” ë“¤ê² ì§€ë§Œ ë‚˜ì¤‘ì— ìœ ì§€ë³´ìˆ˜ í•  ë•Œì—ëŠ” ì‹œê°„ì´ ë‹¨ì¶•ë  ê²ƒì´ë‹¤.</p><br><h3 class="anchor anchorWithStickyNavbar_mojV" id="ì˜ì†ì„±-ì–´ëŒ‘í„°">ì˜ì†ì„± ì–´ëŒ‘í„°<a class="hash-link" href="#ì˜ì†ì„±-ì–´ëŒ‘í„°" title="Direct link to heading">â€‹</a></h3><p><img loading="lazy" alt="Untitled" src="/assets/images/Untitled 5-b8777d388b7088ad61fc5cfc2e8f1851.png" width="1460" height="532" class="img_E7b_"></p><h3 class="anchor anchorWithStickyNavbar_mojV" id="ì˜ì†ì„±-ì–´ëŒ‘í„°ì˜-ì±…ì„">ì˜ì†ì„± ì–´ëŒ‘í„°ì˜ ì±…ì„<a class="hash-link" href="#ì˜ì†ì„±-ì–´ëŒ‘í„°ì˜-ì±…ì„" title="Direct link to heading">â€‹</a></h3><ol><li>ì…ë ¥ì„ ë°›ëŠ”ë‹¤.</li><li>ì…ë ¥ì„ ë°ì´í„°ë² ì´ìŠ¤ í¬ë§·ìœ¼ë¡œ ë§¤í•‘í•œë‹¤.</li><li>ì…ë ¥ì„ ë°ì´í„°ë² ì´ìŠ¤ë¡œ ë³´ë‚¸ë‹¤</li><li>ë°ì´í„°ë² ì´ìŠ¤ ì¶œë ¥ì„ ì• í”Œë¦¬ì¼€ì´ì…˜ í¬ë§·ìœ¼ë¡œ ë§¤í•‘í•œë‹¤.</li><li>ì¶œë ¥ì„ ë°˜í™˜í•œë‹¤.</li></ol><br><br><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>ìš”ê¸°ì„œë„ ë§ˆì°¬ê°€ì§€ë¡œ í‰ì†Œì— ì˜ì†ì„± ë ˆí¬ì§€í† ë¦¬ê°€ ì—¬ëŸ¬ ì±…ì„ë“¤ì„ í•œ ë²ˆì— ê°€ì§€ê³  ìˆëŠ” ë¶€ë¶„ì´ ë§ì•„ì„œ ì–˜ë¥¼ ì–´ë–»ê²Œ í•´ì•¼í•˜ë‚˜ ê³ ë¯¼ì´ë§ì•˜ëŠ”ë°, ì´ ì±…ì—ì„œ <strong>ISP</strong>ë¥¼ ì§€í‚¤ì§€ ì•ŠëŠ”ì§€ í™•ì¸í•´ë³´ë¼ê³  ì¡°ì–¸ì„ í•´ì¤€ë‹¤. ì§€í‚¤ë ¤ê³  ë…¸ë ¥ì„ í•˜ë‹¤ë³´ë©´ ì±…ì„ì„ ë¶„ì‚° í•  ìˆ˜ ìˆì–´ì§„ë‹¤.</p></div></div><p>ì°¸ê³ <br>
<a href="http://www.kyobobook.co.kr/product/detailViewKor.laf?ejkGb=KOR&amp;mallGb=KOR&amp;barcode=9791158392758&amp;orderClick=LAG&amp;Kc=" target="_blank" rel="noopener noreferrer">ë§Œë“¤ë©´ì„œ ë°°ìš°ëŠ” í´ë¦° ì•„í‚¤í…ì²˜</a><br>
<a href="https://blog.cleancoder.com/uncle-bob/2012/08/13/the-clean-architecture.html" target="_blank" rel="noopener noreferrer">ë¡œë²„íŠ¸ë§ˆë¥´í‹´í˜•ì˜ì›ë¬¸</a> â†’ <a href="https://blog.coderifleman.com/2017/12/18/the-clean-architecture/" target="_blank" rel="noopener noreferrer">í•œê¸€ë²ˆì—­</a></p>]]></content>
        <author>
            <name>Dongle</name>
            <uri>https://github.com/sk1737030</uri>
        </author>
        <category label="Spring Boot" term="Spring Boot"/>
        <category label="Clean Architecture" term="Clean Architecture"/>
        <category label="Book" term="Book"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Spring Kafka Graceful Shutdown]]></title>
        <id>kafkashutodwn</id>
        <link href="https://dgle.dev/kafkashutodwn"/>
        <updated>2022-06-20T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Spring kafkaëŠ” Graceful shutdowní•˜ê²Œ ì˜ ì£½ì„ê¹Œ?]]></summary>
        <content type="html"><![CDATA[<p>Consumerê°€ ë©”ì„¸ì§€ë¥¼ ì²˜ë¦¬ì¤‘ì— Spring Boot ì–´í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ shutdown eventê°€ ì¼ì–´ ë‚¬ì„ ë•Œ ê³¼ì—° ì˜ Shutdown Gracefulí•˜ê²Œ  ì¢…ë£Œê°€ ë˜ëŠ”ì§€ê°€ ê¶ê¸ˆí•´ì„œ í•´ë³´ëŠ” ì‹¤í—˜. </p><p><a href="https://github.com/sk1737030/til/tree/master/spring-kafka-graceful-shutdown" target="_blank" rel="noopener noreferrer">ëª¨ë“  ì†ŒìŠ¤ëŠ” ì´ê³³</a>ì—ì„œ í™•ì¸ ê°€ëŠ¥í•©ë‹ˆë‹¤ :)</p><h1>Spring Boot Kafka Grace full Shutdown</h1><p>Consumerê°€ ë©”ì„¸ì§€ë¥¼ ì²˜ë¦¬ì¤‘ì— Spring Boot ì–´í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ shutdown eventê°€ ì¼ì–´ ë‚¬ì„ ë•Œ ê³¼ì—° ì˜ Shutdown Gracefulí•˜ê²Œ  ì¢…ë£Œê°€ ë˜ëŠ”ì§€ê°€ ê¶ê¸ˆí•´ì„œ í•´ë³´ëŠ” ì‹¤í—˜. </p><h2 class="anchor anchorWithStickyNavbar_mojV" id="ë¬´ì—‡ì„-í…ŒìŠ¤íŠ¸í•˜ëƒ">ë¬´ì—‡ì„ í…ŒìŠ¤íŠ¸í•˜ëƒ<a class="hash-link" href="#ë¬´ì—‡ì„-í…ŒìŠ¤íŠ¸í•˜ëƒ" title="Direct link to heading">â€‹</a></h2><p>Consumerê°€ ì»¨ìŠ˜ í›„ ë°ì´í„°ë¥¼ ì˜ commití•˜ëŠ”ì§€ Conusmer info ê´€ì°° </p><p><code>shutdownTimeout</code> : defualt 30ì´ˆ </p><p><code>Kafka version</code>: 2.7.1</p><p><code>SpringBootVersion</code>: v2.5.6</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="ë°©ë²•">ë°©ë²•<a class="hash-link" href="#ë°©ë²•" title="Direct link to heading">â€‹</a></h2><ol><li><code>shutdownTimeout</code>  ë‚´ ì •ìƒì ìœ¼ë¡œ ëª¨ë“  ë©”ì„¸ì§€ê°€ ì˜ ì²˜ë¦¬ ë˜ë„ë¡<ol><li>Spring Boot Kafka ë©”ì„¸ì§€ë¥¼ 10ê°œ ìƒì„±</li><li>Consume í•  ë•Œ ì²˜ë¦¬ ì‹œê°„ì´ ê°œë‹¹ 1ì´ˆê°€ ê±¸ë¦¬ë„ë¡ ì‹¤í—˜ </li><li>ëª¨ë“  ë©”ì„¸ì§€ë¥¼ ì†Œë¹„ í•  ë•Œê¹Œì§€ ìµœì†Œ 10ì´ˆì˜ ì‹œê°„ì´ í•„ìš”í•œ ì‘ì—…ìœ¼ë¡œ ì„¤ì •</li><li>ì»¨ìŠˆë¨¸ ì»¤ë°‹ì´ ì–´ë–»ê²Œ ë˜ëŠ”ì§€ í™•ì¸</li></ol></li><li><code>shutdownTimeout</code>ì„ ë„˜ì–´ì„œë„ë¡ ì„¤ì • <ol><li>Spring Boot Kafka ë©”ì„¸ì§€ë¥¼ 10ê°œ ìƒì„±</li><li>Consume í•  ë•Œ ì²˜ë¦¬ ì‹œê°„ì´ ê°œë‹¹ 10ì´ˆê°€ ê±¸ë¦¬ë„ë¡ ì‹¤í—˜ </li><li>ëª¨ë“  ë©”ì„¸ì§€ë¥¼ ì†Œë¹„ í•  ë•Œê¹Œì§€ ìµœì†Œ 100ì´ˆì˜ ì‹œê°„ì´ í•„ìš”í•œ ì‘ì—…ìœ¼ë¡œ ì„¤ì • </li><li>ì»¨ìŠˆë¨¸ ì»¤ë°‹ì´ ì–´ë–»ê²Œ ë˜ëŠ”ì§€ í™•ì¸</li></ol></li></ol><p><code>Shutdown Signal</code>ì€ ë‹¨ìˆœí•˜ê²Œ 2ë¡œ í…ŒìŠ¤íŠ¸í•  ì˜ˆì •ì´ë‹¤.</p><p>linuxì˜ shutdow number í™•ì¸</p><p><img loading="lazy" alt="[https://linuxhint.com/kill-signal-numbers-linux/](https://linuxhint.com/kill-signal-numbers-linux/)" src="/assets/images/Untitled-671ac2e53ea4b2c169c8bb71835d55b4.png" width="1176" height="487" class="img_E7b_">  </p><p><a href="https://linuxhint.com/kill-signal-numbers-linux/" target="_blank" rel="noopener noreferrer">https://linuxhint.com/kill-signal-numbers-linux/</a></p><ul><li><strong>SIGKILL (9)</strong>: SIGKILL signal ì€ í”„ë¡œì„¸ìŠ¤ë¥¼ ì¦‰ê° ì¢…ë£Œ í•  ë•Œ ì‚¬ìš©í•œë‹¤.</li><li><strong>SIGINT(2)</strong>: ì‚¬ìš©ìì˜ ìš”ì²­ìœ¼ë¡œ ì¤‘ë‹¨ì´ ë  ë•Œ ì‚¬ìš©í•œë‹¤. (e.g., Ctrl+C).</li><li>S<strong>IGTERM(15)</strong>: SIGTERM signal ì¢…ë£Œ ìš”ì²­ì„ ë³´ë‚¸ë‹¤, ìš”ì²­ì„ ë³´ë‚¼ ë¿ SIGKILLì€ ì•„ë‹ˆë‹¤.</li></ul><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>aSigterm</h5></div><div class="admonition-content"><p>ì•ˆì „í•˜ê²Œ ì–´í”Œë¦¬ì¼€ì´ì…˜ì„ ì¢…ë£Œí•˜ê³  ì‹¶ìœ¼ë©´ <code>SIGINT</code>ë‚˜ <code>SIGTEMR</code>ìœ¼ë¡œ ìš”ì²­ì„ ì¶”ì²œí•œë‹¤.</p></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="ì‹¤í—˜-ë°-ê²°ê³¼">ì‹¤í—˜ ë° ê²°ê³¼<a class="hash-link" href="#ì‹¤í—˜-ë°-ê²°ê³¼" title="Direct link to heading">â€‹</a></h2><p>ê°ì¢… ì„¤ì •ì€ defaultë¡œ ì„¤ì •í•˜ê³  ì§„í–‰í•œë‹¤.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">fetch.max.bytes = 52428800</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fetch.max.wait.ms = 500</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fetch.min.bytes = 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auto.commit.interval.ms = 5000</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="1ë²ˆ">1ë²ˆ<a class="hash-link" href="#1ë²ˆ" title="Direct link to heading">â€‹</a></h3><p>Consumer test.offset.1ì˜  offset í™•ì¸  </p><p><img loading="lazy" alt="Untitled" src="/assets/images/Untitled 1-4f9e3d4c75374a28b08744721e2462e6.png" width="1658" height="168" class="img_E7b_">  </p><ul><li><code>current-offset</code>: 36</li><li><code>Lag</code>: 9</li></ul><p>ì–´í”Œë¦¬ì¼€ì´ì…˜ ì¢…ë£Œ <code>signal 2: SIGINT</code>  </p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">2022-06-08 16:45:18.347 DEBUG 11696 --- [ionShutdownHook] s.c.a.AnnotationConfigApplicationContext : Closing org.springframework.context.annotation.AnnotationConfigApplicationContext@34d046b6, started on Wed Jun 08 16:45:09 KST 2022</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2022-06-08 16:45:18.347 DEBUG 11696 --- [ionShutdownHook] ySourcesPropertyResolver$DefaultResolver : Found key 'spring.liveBeansView.mbeanDomain' in PropertySource 'systemProperties' with value of type String</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2022-06-08 16:45:18.348 DEBUG 11696 --- [ionShutdownHook] o.s.c.support.DefaultLifecycleProcessor  : Stopping beans in phase 2147483547</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>Debugë¡œ ë¡œê·¸ í™•ì¸  </p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">essageListenerContainer$ListenerConsumer : Commit list: {test-0=OffsetAndMetadata{offset=45, leaderEpoch=null, metadata=''}}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">essageListenerContainer$ListenerConsumer : Committing: {test-0=OffsetAndMetadata{offset=45, leaderEpoch=null, metadata=''}}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-test.offset.1-1, groupId=test.offset.1] Sending OFFSET_COMMIT request with header RequestHeader(apiKey=OFFSET_COMMIT, apiVersion=7, clientId=consumer-test.offset.1-1, correlationId=17) and timeout 30000 to node 2147483646: {group_id=test.offset.1,generation_id=5,member_id=consumer-test.offset.1-1-0fd44995-c1a6-451a-9987-ab35edab9f74,group_instance_id=null,topics=[{name=test,partitions=[{partition_index=0,committed_offset=45,committed_leader_epoch=-1,committed_metadata=}]}]}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-test.offset.1-1, groupId=test.offset.1] Received OFFSET_COMMIT response from node 2147483646 for request with header RequestHeader(apiKey=OFFSET_COMMIT, apiVersion=7, clientId=consumer-test.offset.1-1, correlationId=17): OffsetCommitResponseData(throttleTimeMs=0, topics=[OffsetCommitResponseTopic(name='test', partitions=[OffsetCommitResponsePartition(partitionIndex=0, errorCode=0)])])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-test.offset.1-1, groupId=test.offset.1] Committed offset 45 for partition test-0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-test.offset.1-1, groupId=test.offset.1] Executing onLeavePrepare with generation Generation{generationId=5, memberId='consumer-test.offset.1-1-0fd44995-c1a6-451a-9987-ab35edab9f74', protocol='range'} and memberId consumer-test.offset.1-1-0fd44995-c1a6-451a-9987-ab35edab9f74</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-test.offset.1-1, groupId=test.offset.1] Revoke previously assigned partitions test-0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">o.s.k.l.KafkaMessageListenerContainer    : test.offset.1: partitions revoked: [test-0]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">essageListenerContainer$ListenerConsumer : Commit list: {}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">o.a.k.c.c.internals.AbstractCoordinator  : [Consumer clientId=consumer-test.offset.1-1, groupId=test.offset.1] Member consumer-test.offset.1-1-0fd44995-c1a6-451a-9987-ab35edab9f74 sending LeaveGroup request to coordinator localhost:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-test.offset.1-1, groupId=test.offset.1] Sending LEAVE_GROUP request with header RequestHeader(apiKey=LEAVE_GROUP, apiVersion=2, clientId=consumer-test.offset.1-1, correlationId=18) and timeout 30000 to node 2147483646: {group_id=test.offset.1,member_id=consumer-test.offset.1-1-0fd44995-c1a6-451a-9987-ab35edab9f74}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">o.a.k.c.c.internals.AbstractCoordinator  : [Consumer clientId=consumer-test.offset.1-1, groupId=test.offset.1] Resetting generation due to consumer pro-actively leaving the group</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">o.a.k.clients.consumer.KafkaConsumer     : [Consumer clientId=consumer-test.offset.1-1, groupId=test.offset.1] Unsubscribed all topics or patterns and assigned partitions</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">o.s.s.c.ThreadPoolTaskScheduler          : Shutting down ExecutorService</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">o.a.k.c.c.internals.AbstractCoordinator  : [Consumer clientId=consumer-test.offset.1-1, groupId=test.offset.1] Heartbeat thread has closed</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-test.offset.1-1, groupId=test.offset.1] Executing onLeavePrepare with generation Generation{generationId=-1, memberId='', protocol='null'} and memberId</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">o.a.k.c.c.internals.AbstractCoordinator  : [Consumer clientId=consumer-test.offset.1-1, groupId=test.offset.1] Resetting generation due to consumer pro-actively leaving the group</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-test.offset.1-1, groupId=test.offset.1] Received LEAVE_GROUP response from node 2147483646 for request with header RequestHeader(apiKey=LEAVE_GROUP, apiVersion=2, clientId=consumer-test.offset.1-1, correlationId=18): LeaveGroupResponseData(throttleTimeMs=0, errorCode=0, members=[])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">o.a.k.c.c.internals.AbstractCoordinator  : [Consumer clientId=consumer-test.offset.1-1, groupId=test.offset.1] LeaveGroup response with Generation{generationId=5, memberId='consumer-test.offset.1-1-0fd44995-c1a6-451a-9987-ab35edab9f74', protocol='range'} returned successfully: ClientResponse(receivedTimeMs=1655698563052, latencyMs=12, disconnected=false, requestHeader=RequestHeader(apiKey=LEAVE_GROUP, apiVersion=2, clientId=consumer-test.offset.1-1, correlationId=18), responseBody=LeaveGroupResponseData(throttleTimeMs=0, errorCode=0, members=[]))</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>í¥ë¯¸ë¡œìš´ ë¡œê·¸ê°€ ëª‡ ê°œ ë³´ì¸ë‹¤. </p><ol><li>OFFSET_COMMIT  </li><li>Revoke Listenerê°€ ì‘ë™ì„ í•˜ê³   </li><li>LeaveGroup Request  </li><li>Thread Shutodnw Eventê°€ ì‹œì‘ì„ í•˜ê³    </li><li>HeaerBeat threadê°€ ì¢…ë£Œ ë˜ê³    </li><li>LeaveGroupì„ ë°›ëŠ”ë‹¤.  </li></ol><p>topicì˜ offset í™•ì¸<br>
<img loading="lazy" alt="Untitled" src="/assets/images/Untitled 2-72f0b62cfd75f63232ff3318a762c11b.png" width="1444" height="252" class="img_E7b_">  </p><ul><li><code>current-offset</code>:45</li><li><code>lag</code>: 0</li></ul><h3 class="anchor anchorWithStickyNavbar_mojV" id="2ë²ˆ">2ë²ˆ<a class="hash-link" href="#2ë²ˆ" title="Direct link to heading">â€‹</a></h3><p>Consumer test.offset.1ì˜  offset í™•ì¸ </p><p><img loading="lazy" alt="Untitled" src="/assets/images/Untitled 1-4f9e3d4c75374a28b08744721e2462e6.png" width="1658" height="168" class="img_E7b_"></p><ul><li>current-offset: 36</li><li>Lag: 9</li></ul><p>ì–´í”Œë¦¬ì¼€ì´ì…˜ ì¢…ë£Œ <code>signal 2: SIGINT</code></p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">2022-06-08 16:45:18.347 DEBUG 11696 --- [ionShutdownHook] s.c.a.AnnotationConfigApplicationContext : Closing org.springframework.context.annotation.AnnotationConfigApplicationContext@34d046b6, started on Wed Jun 08 16:45:09 KST 2022</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2022-06-08 16:45:18.347 DEBUG 11696 --- [ionShutdownHook] ySourcesPropertyResolver$DefaultResolver : Found key 'spring.liveBeansView.mbeanDomain' in PropertySource 'systemProperties' with value of type String</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2022-06-08 16:45:18.348 DEBUG 11696 --- [ionShutdownHook] o.s.c.support.DefaultLifecycleProcessor  : Stopping beans in phase 2147483547</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>Shout down TimeOut ì´í›„ ë¡œê·¸ë¥¼ ë³¸ë‹¤ë©´</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">2022-06-03 18:16:35.861  INFO 9116 --- [ionShutdownHook] o.s.c.support.DefaultLifecycleProcessor  :</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> **Failed to shut down 1 bean with phase value 2147483547 within timeout of 30000ms:** </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[org.springframework.kafka.config.internalKafkaListenerEndpointRegistry]</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>Offset í™•ì¸</p><p><img loading="lazy" alt="Untitled" src="/assets/images/Untitled 3-280c06be7968e3cb3a0a375f7c5bfe0d.png" width="1440" height="264" class="img_E7b_"></p><p><code>shutdown timeout</code>ìœ¼ë¡œ ì¸í•´ Commitì´ ì •ìƒì ìœ¼ë¡œ ì•ˆëœ ìƒíƒœì´ë‹¤.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="ê²°ë¡ ">ê²°ë¡ <a class="hash-link" href="#ê²°ë¡ " title="Direct link to heading">â€‹</a></h3><p>Timeout ì´ë‚´ì— ë©”ì‹œì§€ëŠ” ì˜ <code>Graceful</code>í•˜ê²Œ ì²˜ë¦¬í•œë‹¤. ê·¸ëŸ¬ë‚˜ ë§Œì•½ timeout ë‚´ì— ì²˜ë¦¬ë¥¼ ëª» í•œë‹¤ë©´ ë©”ì‹œì§€ë¥¼ ì¤‘ë³µìœ¼ë¡œ ì²˜ë¦¬í•˜ëŠ” ìƒí™©ì´ ë‚˜íƒ€ë‚  ìˆ˜ ìˆìœ¼ë‹ˆ, ì ì ˆí•œ ë°©ì–´ ë¡œì§ê³¼ ìˆ˜ë™ commitìœ¼ë¡œ í’€ì–´ì„œ ì²˜ë¦¬ë¥¼í•˜ê±°ë‚˜ timeoutì„ ì•Œë§ê²Œ ì„¤ì •í•´ì•¼ í•  ê±° ê°™ë‹¤.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="ì°¸ê³ ">ì°¸ê³ <a class="hash-link" href="#ì°¸ê³ " title="Direct link to heading">â€‹</a></h3><p><a href="https://docs.spring.io/spring-kafka/docs/2.5.17.RELEASE/reference/html/" target="_blank" rel="noopener noreferrer">https://docs.spring.io/spring-kafka/docs/2.5.17.RELEASE/reference/html/</a><br>
<a href="https://bravenamme.github.io/2020/10/06/graceful-shutdown/" target="_blank" rel="noopener noreferrer">https://bravenamme.github.io/2020/10/06/graceful-shutdown/</a><br>
<a href="https://docs.confluent.io/confluent-cli/current/overview.html" target="_blank" rel="noopener noreferrer">https://docs.confluent.io/confluent-cli/current/overview.html</a><br>
<a href="https://kafka.apache.org/documentation/" target="_blank" rel="noopener noreferrer">https://kafka.apache.org/documentation/</a><br>
<a href="https://linuxhint.com/kill-signal-numbers-linux/" target="_blank" rel="noopener noreferrer">signum ë²ˆí˜¸ ì„¤ëª…</a>
<a href="https://github.com/adevinta/zoe" target="_blank" rel="noopener noreferrer">zoe kafka cli</a><br>
<a href="https://docs.confluent.io/platform/current/installation/configuration/consumer-configs.html" target="_blank" rel="noopener noreferrer">consume Config ì„¤ëª…</a></p>]]></content>
        <author>
            <name>Dongle</name>
            <uri>https://github.com/sk1737030</uri>
        </author>
        <category label="SpringBoot" term="SpringBoot"/>
        <category label="Kafka" term="Kafka"/>
        <category label="Graceful" term="Graceful"/>
        <category label="Shutdown" term="Shutdown"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[ë‚´ê°€ ê²ªì€ N + 1 ë¬¸ì œ]]></title>
        <id>my_n+1</id>
        <link href="https://dgle.dev/my_n+1"/>
        <updated>2022-05-28T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Spring Boot N+1 JPA]]></summary>
        <content type="html"><![CDATA[<p>JPAë¥¼ ì“°ë©´ì„œ ìš°ë¦¬ê°€ ì¼ë°˜ì ìœ¼ë¡œ ë°œìƒí•˜ì—¬ì„œ í•´ë³¼ ê±´ ë‹¤ í•´ë´ë„ ì•ˆëì—ˆë˜ N+1 ë¬¸ì œ </p><p><a href="https://github.com/sk1737030/til/tree/master/til-jpa" target="_blank" rel="noopener noreferrer">ëª¨ë“  ì†ŒìŠ¤ëŠ” ì´ê³³</a>ì—ì„œ í™•ì¸ ê°€ëŠ¥í•©ë‹ˆë‹¤ :)</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="n--1-ë¬¸ì œ">N + 1 ë¬¸ì œ<a class="hash-link" href="#n--1-ë¬¸ì œ" title="Direct link to heading">â€‹</a></h2><p>JPAë¥¼ ì“°ë©´ì„œ ìš°ë¦¬ê°€ ì¼ë°˜ì ìœ¼ë¡œ ë°œìƒí•˜ì—¬ì„œ í•´ë³¼ ê±´ ë‹¤ í•´ë´ë„ ì•ˆëì—ˆë˜ N+1 ë¬¸ì œ<br>
<!-- -->ì¼ë°˜ì ìœ¼ë¡œ ìš°ë¦¬ê°€ í”íˆ N+1ë¬¸ì œê°€ ë°œìƒì„ í•  ìˆ˜ ìˆëŠ”ë° ì´ë¯¸ ë§ì€ ì‚¬ëŒì´ ì•Œê² ì§€ë§Œ í‚¹ê°“ì˜í™˜ë‹˜ì˜ ì±…ì„ ë³´ê±°ë‚˜ ê°•ì˜ë¥¼ ë³´ë©´ ì§„ì§œ ë‹¤ í•´ê²°ì´ ê°€ëŠ¥í–ˆëŠ”ë°<br>
<!-- -->ë‚´ê°€ ë§ˆì£¼í•œ ë¬¸ì œëŠ” í•´ê²°ì´ ì•ˆ ëì—ˆë‹¤. ì¼ë°˜ì ìœ¼ë¡œ í•´ê²°ì„ ìœ„í•´ ê·¸ì— ìƒí™©ë§ˆë‹¤ ë‹¤ë¥´ê² ì§€ë§Œ í”í•˜ê²Œ ê°€ì¥ ë¨¼ì € lazyë¡œ ë³€ê²½, fetch join, fetch sizeì¡°ì • ë“± ì—¬ëŸ¬ ì‘ì—…ì„ í–ˆëŠ”ë°<br>
<!-- -->í•´ê²°ì´ ì•ˆ ëì—ˆë‹¤.</p><p>ì½”ë“œê°€ ë§ì´ ë‹¤ë¥´ê³  ë„ë©”ì¸ë„ ë‹¤ë¥´ì§€ë§Œ ê·¸ë‚˜ë§ˆ ë¹„ìŠ·í•˜ê²Œ ì½”ë“œë¥¼ ì¬í˜„ í•´ë³´ìë©´</p><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token annotation punctuation" style="color:#393A34">@Entity</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token annotation punctuation" style="color:#393A34">@NoArgsConstructor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">access </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name">AccessLevel</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">PROTECTED</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token annotation punctuation" style="color:#393A34">@AllArgsConstructor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">access </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name">AccessLevel</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">PROTECTED</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token annotation punctuation" style="color:#393A34">@Getter</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">Member</span><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token annotation punctuation" style="color:#393A34">@Id</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token annotation punctuation" style="color:#393A34">@Column</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">name </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"member_id"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">private</span><span class="token plain"> </span><span class="token class-name">Long</span><span class="token plain"> id</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">private</span><span class="token plain"> </span><span class="token class-name">String</span><span class="token plain"> memberEmail</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token annotation punctuation" style="color:#393A34">@OneToMany</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">mappedBy </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"Member"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> cascacde </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name">CascadeType</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ALL</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> orphanRemoval </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">private</span><span class="token plain"> </span><span class="token class-name">Set</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">Order</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain">  orders </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name">LinkedHashSet</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token annotation punctuation" style="color:#393A34">@Entity</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token annotation punctuation" style="color:#393A34">@NoArgsConstructor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">access </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name">AccessLevel</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">PROTECTED</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token annotation punctuation" style="color:#393A34">@AllArgsConstructor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">access </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name">AccessLevel</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">PROTECTED</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token annotation punctuation" style="color:#393A34">@Getter</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">Order</span><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token annotation punctuation" style="color:#393A34">@ID</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token annotation punctuation" style="color:#393A34">@Column</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">name </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"order_id"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    priate </span><span class="token class-name">Long</span><span class="token plain"> id</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token annotation punctuation" style="color:#393A34">@ManyToOne</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">fetch </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name">FetchType</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">LAZY</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token annotation punctuation" style="color:#393A34">@JoinColumn</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">name </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"memberEmail"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> referencedColumnName </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"memberEmail"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> nullable </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> updatable </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">private</span><span class="token plain"> </span><span class="token class-name">Set</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">Order</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain">  order </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name">LinkedHashSet</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ì´ëŸ° ëŠë‚Œì˜ Entityì˜€ë‹¤.<br>
<!-- -->ì´ë•Œì˜ ë‚˜ ë¹¼ê³  ì—”í‹°í‹°ê°€ ì–´ë–¤ ë¬¸ì œê°€ ìˆëŠ”ì§€ ì•Œê² ì§€ë§Œ ì´ë•Œê¹Œì§€ëŠ” ë‚˜ëŠ” ê¿ˆì—ë„ ëª°ëë‹¤. <del>5ì‹œê°„ì„ ë²„ë¦´ ì¤„ì€ ëª°ëë‹¤!</del>  </p><p>ê¸°íš: íšŒì›ìœ¼ë¡œ ì£¼ë¬¸ ì •ë³´ë¥¼ ë³¼ ìˆ˜ ìˆê²Œ í•´ì£¼ì„¸ìš”<br>
<!-- -->ë‚˜: members ê¸°ì¤€ìœ¼ë¡œ Orderë¥¼ ë‹¤ ê°€ì ¸ì˜¤ë©´ ë˜ê² êµ¬ë‚˜! ìŒ ê·¸ëŸ¬ë©´ ê°€ì ¸ì˜¬ ë•Œ ì†ë„ë¥¼ ìœ„í•´ fetch join í•´ì„œ ê°€ì ¸ì™€ì•¼ì§€!<br>
<img loading="lazy" alt="Untitled" src="/assets/images/Untitled-9b8cd5d5174ff20668e14bba4284770a.png" width="400" height="242" class="img_E7b_"></p><p>ê·¸ë ‡ê²Œ ë‹¤ì„¯ì‹œê°„ì„ ì¡ì•„ë¨¹ì„ ì¤„ì€ ëª°ëì—ˆë‹¤.<br>
<!-- -->ì•„ë‹ˆ ì§„ì§œ í•‘ê³„ë¥¼ ëŒ€ìë©´ ì´ë ‡ê²Œ ì—”í‹°í‹°ë¥¼ êµ¬ì„±í•œ ê±´ ë‚´ê°€ ì•„ë‹ˆë¼ ê¸°ì¡´ ì½”ë“œë¥¼ ê°€ì§€ê³  ë‹¤ë¥¸ ê³³ì—ì„œ ì“°ë‹¤ê°€ ì´ë ‡ê³  ì €ë ‡ê³ .. êµ¬êµ¬ì ˆì ˆ <del><strong>í• ë§í•˜ì•ˆ</strong></del></p><p><img loading="lazy" alt="Untitled" src="/assets/images/Untitled 1-38ae4d40957764c77112ba335338f0c4.png" width="225" height="225" class="img_E7b_"></p><h3 class="anchor anchorWithStickyNavbar_mojV" id="ë‚´ê°€-ê·¸ë¦°-ê·¸ë¦°-ì¿¼ë¦¬">ë‚´ê°€ ê·¸ë¦° ê·¸ë¦° ì¿¼ë¦¬<a class="hash-link" href="#ë‚´ê°€-ê·¸ë¦°-ê·¸ë¦°-ì¿¼ë¦¬" title="Direct link to heading">â€‹</a></h3><div class="codeBlockContainer_I0IT language-sql theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sql codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> a</span><span class="token punctuation" style="color:#393A34">.</span><span class="token operator" style="color:#393A34">*</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> b</span><span class="token punctuation" style="color:#393A34">.</span><span class="token operator" style="color:#393A34">*</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> member m </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">inner</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">join</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">order</span><span class="token plain"> o </span><span class="token keyword" style="color:#00009f">on</span><span class="token plain"> m</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">memberEmail </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> o</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">memberEmail</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ì´ëŸ° ëŠë‚Œì˜ (<del>ë„ˆë„ í•œë°© ë‚˜ë„í•œë°©</del>)ì¿¼ë¦¬ë¥¼ ì›í•´ì„œ</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="fetchë¥¼-ì“°ì">Fetchë¥¼ ì“°ì<a class="hash-link" href="#fetchë¥¼-ì“°ì" title="Direct link to heading">â€‹</a></h3><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">interface</span><span class="token plain"> </span><span class="token class-name">ProblemRepository</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">extends</span><span class="token plain"> </span><span class="token class-name">JpaRepository</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">Member</span><span class="token generics punctuation" style="color:#393A34">,</span><span class="token generics"> </span><span class="token generics class-name">Long</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">private</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">final</span><span class="token plain"> </span><span class="token class-name">JPAQueryFactory</span><span class="token plain"> queryFactory</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token annotation punctuation" style="color:#393A34">@Query</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"SELECT distinct m FROM Member m join fetch m.orders"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">List</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">Member</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">findAllFetch</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ì´ë ‡ê²Œ ì¡°íšŒë¥¼ í–ˆëŠ”ë° </p><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token annotation punctuation" style="color:#393A34">@Test</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">save</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><span class="token comment" style="color:#999988;font-style:italic">// Given</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> i</span><span class="token operator" style="color:#393A34">++</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">Member</span><span class="token plain"> memFixture </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Member</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"@naver.com"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">Order</span><span class="token plain"> orderFixture </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Order</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">i </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"delivery"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        memFixture</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">addOrder</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">orderFixture</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        problemRepository</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">save</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">memFixture</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        em</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">flush</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        em</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">clear</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">List</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">Member</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> members </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> problemRepository</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">findAllFetch</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">assertThat</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">members</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">size</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">isEqualTo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">assertThat</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">members</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getOrders</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">size</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">isEqualTo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">assertThat</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">members</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getOrders</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">size</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">isEqualTo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>í¸ì˜ë¥¼ ìœ„í•´ì„œ ëŒ€ì¶© ì´ë ‡ê²Œ í–ˆë‹¤ ê°€ì •í•˜ê³ ..  í…ŒìŠ¤íŠ¸ë¥¼ ëŒë ¤ì„œ í™•ì¸í•´ë³´ë‹ˆ  </p><div class="codeBlockContainer_I0IT language-yaml theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-yaml codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">Hibernate</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  distinct member0_.member_id as member_i1_0_0_</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  orders1_.order_id as order_id1_1_1_</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  member0_.member_email as member_e2_0_0_</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  orders1_.member_email as member_e3_1_1_</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  orders1_.order_status as order_st2_1_1_</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  orders1_.member_email as member_e3_1_0__</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  orders1_.order_id as order_id1_1_0__ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  t_member member0_ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">inner join</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  t_order orders1_ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      on member0_.member_email=orders1_.member_email</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ìŒ .. ì˜ˆìƒí•œ ì¿¼ë¦¬ë„¤ </p><div class="codeBlockContainer_I0IT language-yaml theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-yaml codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">Hibernate</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /* load com.example.tiljpa.problem.Member </span><span class="token important">*/</span><span class="token plain"> select</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        member0_.member_id as member_i1_0_0_</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        member0_.member_email as member_e2_0_0_ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    from</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        t_member member0_ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    where</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        member0_.member_email=</span><span class="token punctuation" style="color:#393A34">?</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">Hibernate</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /* load com.example.tiljpa.problem.Member </span><span class="token important">*/</span><span class="token plain"> select</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        member0_.member_id as member_i1_0_0_</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        member0_.member_email as member_e2_0_0_ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    from</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        t_member member0_ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    where</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        member0_.member_email=</span><span class="token punctuation" style="color:#393A34">?</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>?????? ì´ëŸ° ì¿¼ë¦¬ë“¤ì´ ì¡°íšŒí•œ ë©¤ë²„ ìˆ˜ë§Œí¼ ë‹¤ì‹œ ì¿¼ë¦¬ê°€ ì«˜ë¼ë¼ë¼ë¼ë¼ë¼ë¼ë¼ë¼ë¼ë¼ë¼ë¼ë½ ë‚˜ê°€ë²„ë ¸ë‹¤..</p><p>ì´ë•Œ ì—¥..? ì™œ fetch joinì„ í•˜ê³  ì¿¼ë¦¬ë¥¼ ê°€ì ¸ì™”ëŠ”ë° ë‹¤ì‹œ memberì¿¼ë¦¬ê°€ ë‚˜ê°€ì§€?? </p><p>ì´ë–„ë¶€í„° ë©˜ë¶•ì˜ ì‹œì‘ì´ì˜€ë‹¤.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="ë””ë²„ê¹…í•˜ë©´ì„œì˜-ì¶”ì¸¡">ë””ë²„ê¹…í•˜ë©´ì„œì˜ ì¶”ì¸¡<a class="hash-link" href="#ë””ë²„ê¹…í•˜ë©´ì„œì˜-ì¶”ì¸¡" title="Direct link to heading">â€‹</a></h3><ol><li>ì¼ë‹¨ fetch modeë¥¼ eagerë¡œ ë°”ê¿”ë³´ì.. <ul><li>ì‹¤íŒ¨</li></ul></li><li>querydslë¡œ joinì„ í•˜ë©´ ë‹¤ë¥¼ê¹Œ? <ul><li>ì‹¤íŒ¨</li></ul></li><li>equalsë‘ hashcodeë¥¼ ë„£ì–´ë³´ì<ul><li>ì‹¤íŒ¨</li></ul></li><li>ì•„ ì´ê±´ì•„ë‹Œê±°ê°™ì€ë° ymlì— batch sizeë¥¼ ë„£ì–´ë³´ì <ul><li>ë‹¹ì—°íˆ ì‹¤íŒ¨</li></ul></li><li>transacton(readonly=true) ë•Œë¬¸ì— ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ê°€ ì¼ì„ ì•ˆí•˜ë‚˜? ì¢‹ì•„ transactionìœ¼ë¡œë§Œ í•˜ì <ul><li>ì‹¤íŒ¨</li></ul></li><li>ì•„ ì¢‹ì•„ ì¼ë‹¨ ë””ë²„ê¹…ì„ í•´ë³´ì <div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">- ë””ë²„ê¹… í•˜ë©´ì„œ ë³´ë‹¤ë³´ë‹ˆ ìµœì´ˆ fetchë¡œ ë°›ì€ member ê°ì²´ì˜ ì£¼ì†Œì™€ orderê°€ ê°€ì§€ê³  ìˆëŠ” memberê°ì²´ì˜ ì£¼ì†Œê°€ í™•ì—°íˆ ë‹¬ëë‹¤.  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">![Untitled](./2022-05-28/Untitled%202.png)          </span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div>ì–´ ë­ì•¼ ì™œë‹¬ë¼... ì´ë–„ë¶€í„° ë¬´í•œ ì±—ë°”í€´ ëŒë“¯ ê·¸ëŸ¬ë©´ orderì˜ modeë¥¼ eagerë¡œ ë°”ê¾¸ì! (ì‚¬ì‹¤ ì´ë¯¸ í•´ë´¤ë˜ê±°ì˜€ë‹¤) ë‹¹ì—°íˆ ì‹¤íŒ¨<br><img loading="lazy" alt="Untitled" src="/assets/images/Untitled 3-1368a6ee87c516b456e672ef751bd824.png" width="224" height="225" class="img_E7b_"></li></ol><p>ë„ì €íˆ ì¢‹ì€ ìƒê°ì´ ë– ì˜¤ë¥´ì§€ ì•Šì•„ ì‚°ì±…ì„í•˜ê³  ì˜¨ í›„ </p><h3 class="anchor anchorWithStickyNavbar_mojV" id="ë¬¸ë“">ë¬¸ë“<a class="hash-link" href="#ë¬¸ë“" title="Direct link to heading">â€‹</a></h3><p>ë¬¸ë“ ìš°ë¦¬ê°€ joinì„ í•˜ë©´ rdbì—ì„œ ë‹¹ì—°íˆ ì—¬ëŸ¬ ê°œ ë‚˜ì˜¤ëŠ” ë¬¸ì œë¥¼ ìš°ë¦¬ëŠ” í”íˆ distnctë¥¼ í•˜ëŠ”ë° ì´ë•Œ jpaì—ì„œëŠ” <strong><code>Entityì˜ @Id</code></strong>ë¡œ ì¤‘ë³µì„ ì œê±°í•˜ëŠ” ê²Œ ìƒê°ì´ ì§€ë‚˜ê°€ëŠ”ë° ì•„ ê·¸ëŸ¬ë©´ <strong>fetchjoin</strong>í•œ ì´í›„ ê°€ì ¸ì™”ì—ˆì„ ë•Œ ì˜ì†ì„± ì»¨í…ŒìŠ¤íŠ¸ì—ì„œ <code>**@Id</code>** ë¡œ êµ¬ë¶„ì„ í•œë‹¤ê³  ìƒê°ì´ ë“¤ì–´ ê¸°ì¡´ <code>JoinColumnì— member_email</code>ë¡œ ë˜ì–´ìˆëŠ” ì½”ë“œë¥¼ <code>member_id</code>ë¡œ ë³€ê²½í–ˆë‹¤. </p><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token annotation punctuation" style="color:#393A34">@Entity</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token annotation punctuation" style="color:#393A34">@NoArgsConstructor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">access </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name">AccessLevel</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">PROTECTED</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token annotation punctuation" style="color:#393A34">@AllArgsConstructor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">access </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name">AccessLevel</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">PROTECTED</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token annotation punctuation" style="color:#393A34">@Getter</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">Order</span><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token annotation punctuation" style="color:#393A34">@ID</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token annotation punctuation" style="color:#393A34">@Column</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">name </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"order_id"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    priate </span><span class="token class-name">Long</span><span class="token plain"> id</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token annotation punctuation" style="color:#393A34">@ManyToOne</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">fetch </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name">FetchType</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">LAZY</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token annotation punctuation" style="color:#393A34">@JoinColumn</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">name </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"member_id"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> referencedColumnName </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"member_id"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> nullable </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> updatable </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">private</span><span class="token plain"> </span><span class="token class-name">Set</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">Member</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> members </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name">LinkedHashSet</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ëˆˆ ìˆ˜ìˆ  í›„ ê±´ì¡°í•œ ëˆˆ ë•Œë¬¸ì— ëˆˆì„ ê°œìŠ¤ì¸ ë¦„í•œ ëˆˆë¹›ìœ¼ë¡œ ëª¨ë‹ˆí„°ë¥¼ ëš«ì–´ì§€ê²Œ ë³´ë©° ìƒê° ì¤‘ì— ìŠ¤ì³ ê°€ëŠ” ìƒê°ì´ ìˆì—ˆëŠ”ë°, Hibernate ì…ì¥ì—ì„œ ìƒê°(ë‡Œ ì½”ë”©)ì„ í•´ë³¸ë‹¤ë©´ ë‹¹ì—° í•  ìˆ˜ ë°–ì— ì—†êµ¬ë‚˜ë¼ëŠ” ìƒê°ì´ ë“¤ì—ˆë‹¤.<br>
<!-- -->ì¿¼ë¦¬ë¥¼ jqplë¡œ ë‚ ë ¤ ë³´ë‚´ê³  ì˜¨ í›„ì— <strong>ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì— ì¹œêµ¬ë¥¼ memberIdë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì»¨í…ìŠ¤íŠ¸ í…Œì´ë¸”ì— ê°’ì„ ë„£ì–´ë†“ê³ ,</strong> orderë¥¼ ë³´ëŠ”ë° ì•ˆì— Lazyê°€ ë–¡í•˜ë‹ˆ ì„ ì–¸ë˜ì–´ ìˆëŠ” ê±¸ ë³´ê³  í—ˆê²ì§€ê² ë‹¤ì‹œ ì°¾ìœ¼ë ¤ê³  ì»¨í…ìŠ¤íŠ¸ì—ì„œ ì°¾ì•˜ëŠ”ë° ì•ˆë³´ì˜€ë˜ ê²ƒì´ë‹¤.<br>
<!-- -->ê·¸ë˜ì„œ 1ì°¨ ìºì‹œì— ì—†ë„¤(Joincolumnì— ì„ ì–¸ëœ member_emailì„ ê°€ì§€ê³  keyë¥¼ ì°¾ë‹¤ ë³´ë‹ˆ ì‹¤ì œë¡œëŠ” fetchjoinìœ¼ë¡œ ë„£ì—ˆë˜ keyëŠ” memberIdì´ì˜€ì–´ì„œ) ê·¸ëŸ¬ë©´ dbì—ì„œ ì¡°íšŒí•´ì•¼ê² ë‹¤ê³  íŒë‹¨í•˜ê³  ë‹¤ì‹œ lazyì¡°ì¸ì„ ë‚ ë ¤ ë°œìƒí•œ ë¬¸ì œì¸ ê±°ì§€ ì•Šì„ê¹Œ?</p><p>ì°¸ê³ <br>
<a href="https://www.inflearn.com/course/%EC%8A%A4%ED%94%84%EB%A7%81%EB%B6%80%ED%8A%B8-JPA-API%EA%B0%9C%EB%B0%9C-%EC%84%B1%EB%8A%A5%EC%B5%9C%EC%A0%81%ED%99%94/" target="_blank" rel="noopener noreferrer">Inflearn ì˜í™˜ë‹˜ ê°•ì˜</a><br>
<a href="http://www.kyobobook.co.kr/product/detailViewKor.laf?mallGb=KOR&amp;ejkGb=KOR&amp;barcode=9788960777330" target="_blank" rel="noopener noreferrer">JPA í”„ë¡œê·¸ë˜ë°</a>
<a href="https://docs.spring.io/spring-data/jpa/docs/2.5.11/reference/html/" target="_blank" rel="noopener noreferrer">docs</a></p>]]></content>
        <author>
            <name>Dongle</name>
            <uri>https://github.com/sk1737030</uri>
        </author>
        <category label="SpringBoot" term="SpringBoot"/>
        <category label="JPA" term="JPA"/>
        <category label="N+1" term="N+1"/>
        <category label="Hibernate" term="Hibernate"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[DB transaction Isolationì— ëŒ€í•´ì„œ ì•Œì•„ë³´ì]]></title>
        <id>db-isolation</id>
        <link href="https://dgle.dev/db-isolation"/>
        <updated>2022-05-24T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Db íŠ¸ëœì­ì…˜ Isolation]]></summary>
        <content type="html"><![CDATA[<p>ì˜ˆì „ì— í•œ ë²ˆ ì½ì—ˆë˜ RealMysqlë¥¼ ë‹¤ì‹œê¸ˆ ì½ìœ¼ë©´ì„œ ì •ë¦¬í•˜ëŠ” Transaction Isolation!</p><h1>Transaction Isolation Level</h1><h3 class="anchor anchorWithStickyNavbar_mojV" id="acid">ACID<a class="hash-link" href="#acid" title="Direct link to heading">â€‹</a></h3><p>ACIDëŠ” ë°ì´í„°ë² ì´ìŠ¤ ë‚´ì—ì„œ ì¼ì–´ë‚˜ëŠ” í•˜ë‚˜ì˜ íŠ¸ëœì­ì…˜(transaction)ì˜ ì•ˆì „ì„±ì„ ë³´ì¥í•˜ê¸° ìœ„í•´ í•„ìš”í•˜ë‹¤.</p><ul><li><code>Atomicity</code>: transactionì˜ ì‘ì—…ì´ ë¶€ë¶„ì ìœ¼ë¡œ ì„±ê³µí•˜ëŠ” ì¼ì´ ì—†ë„ë¡ ë³´ì¥í•˜ëŠ” ì„±ì§ˆì´ë‹¤. ì†¡ê¸ˆí•˜ëŠ” ì‚¬ëŒì˜ ê³„ì¢Œì—ì„œ ëˆì€ ë¹ ì ¸ë‚˜ê°”ëŠ”ë° ë°›ëŠ” ì‚¬ëŒì˜ ê³„ì¢Œì— ëˆì´ ë“¤ì–´ì˜¤ì§€ ì•ŠëŠ” ì¼ì€ ì—†ì–´ì•¼ í•œë‹¤.  </li><li><code>Consistency</code>: transactionì´ ëë‚  ë•Œ DBì˜ ì—¬ëŸ¬ ì œì•½ ì¡°ê±´ì— ë§ëŠ” ìƒíƒœë¥¼ ë³´ì¥í•˜ëŠ” ì„±ì§ˆì´ë‹¤. ì†¡ê¸ˆí•˜ëŠ” ì‚¬ëŒì˜ ê³„ì¢Œ ì”ê³ ê°€ 0ë³´ë‹¤ ì‘ì•„ì§€ë©´ ì•ˆ ëœë‹¤.  </li><li><code>Isolation</code>: transactionì´ ì§„í–‰ë˜ëŠ” ì¤‘ê°„ ìƒíƒœì˜ ë°ì´í„°ë¥¼ ë‹¤ë¥¸ transactionì´ ë³¼ ìˆ˜ ì—†ë„ë¡ ë³´ì¥í•˜ëŠ” ì„±ì§ˆì´ë‹¤. ì†¡ê¸ˆí•˜ëŠ” ì‚¬ëŒì˜ ê³„ì¢Œì—ì„œ ëˆì€ ë¹ ì ¸ë‚˜ê°”ëŠ”ë° ë°›ëŠ” ì‚¬ëŒì˜ ê³„ì¢Œì— ëˆì´ ì•„ì§ ë“¤ì–´ê°€ì§€ ì•Šì€ DB ìƒí™©ì„ ë‹¤ë¥¸ transactionì´ ì½ìœ¼ë©´ ì•ˆ ëœë‹¤.  </li><li><code>Durability</code>: transactionì´ ì„±ê³µí–ˆì„ ê²½ìš° í•´ë‹¹ ê²°ê³¼ê°€ ì˜êµ¬ì ìœ¼ë¡œ ì ìš©ë¨ì„ ë³´ì¥í•˜ëŠ” ì„±ì§ˆì´ë‹¤. í•œ ë²ˆ ì†¡ê¸ˆì´ ì„±ê³µí•˜ë©´ ì€í–‰ ì‹œìŠ¤í…œì— ì¥ì• ê°€ ë°œìƒí•˜ë”ë¼ë„ ì†¡ê¸ˆì´ ì„±ê³µí•œ ìƒíƒœë¡œ ë³µêµ¬í•  ìˆ˜ ìˆì–´ì•¼ í•œë‹¤.  </li></ul><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>ë™ì‹œì„±</h5></div><div class="admonition-content"><p>ACIDë¥¼ ë†’ì´ë©´ ë†’ì¼ ìˆ˜ë¡ ë™ì‹œì„±ì´ ë–¨ì–´ì§„ë‹¤, </p></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="read-uncommitted-dirty-read">Read Uncommitted (Dirty Read)<a class="hash-link" href="#read-uncommitted-dirty-read" title="Direct link to heading">â€‹</a></h3><ul><li>ì¼ë°˜ì ìœ¼ë¡œ ê±°ì˜ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ”ë‹¤.  </li><li>ë³€ê²½ ë‚´ìš©ì´ commitì´ë‚˜ Rollback ì—¬ë¶€ì— ìƒê´€ ì—†ì´ ë‹¤ë¥¸ íŠ¸ëœì­ì…˜ì—ê²Œ ë³´ì—¬ì¤€ë‹¤.  </li><li>ì–´ë–¤ íŠ¸ë™ì­ì…˜ì—ì„œ ì²˜ë¦¬í•œ ì‘ì—…ì´ ì™„ë£Œë˜ì§€ ì•Šì•˜ëŠ”ë°ë„ ë‹¤ë¥¸ íŠ¸ëœì­ì…˜ì—ì„œ ë³¼ ìˆ˜ ìˆê²Œ ëœë‹¤.  </li><li>Dirty readë¥¼ ìœ ë°œí•œë‹¤.</li></ul><h3 class="anchor anchorWithStickyNavbar_mojV" id="read-committed">Read Committed<a class="hash-link" href="#read-committed" title="Direct link to heading">â€‹</a></h3><ul><li>Oracle Dbmsì—ì„œ ê¸°ë³¸ì ìœ¼ë¡œ ì‚¬ìš©ë˜ê³  ìˆëŠ” ê²©ë¦¬ ìˆ˜ì¤€(<code>Shared Lock</code>ì„ ì‚¬ìš©í•œë‹¤)<ul><li>Shared Lock<ul><li>ì¼ë°˜ì ì¸ SELECT ì¿¼ë¦¬ëŠ” lockì„ ì‚¬ìš©í•˜ì§€ ì•Šê³  DBë¥¼ ì½ì–´ ë“¤ì¸ë‹¤. í•˜ì§€ë§Œ <code>SELECT ... FOR SHARE</code> ë“± ì¼ë¶€ SELECT ì¿¼ë¦¬ëŠ” read ì‘ì—…ì„ ìˆ˜í–‰í•  ë•Œ DBê°€ ê° rowì— Shared lockì„ ê±´ë‹¤.</li></ul></li></ul></li><li><code>Commitì´ ì™„ë£Œëœ ë°ì´í„°</code>ë§Œ ë‹¤ë¥¸ íŠ¸ëœì­ì…˜ì—ì„œ ì¡°íšŒ í•  ìˆ˜ ìˆë‹¤.</li><li>ì–´ë–¤ íŠ¸ëœì­ì…˜ì—ì„œ ì²˜ë¦¬í•œ ì‘ì—…ì´ Commitì´ ì•ˆë˜ì–´ ìˆë‹¤ë©´ ë‹¤ë¥¸ íŠ¸ëœì­ì…˜ì€ undo ì˜ì—­ì— ìˆëŠ” ê¸°ì¡´ ê°’ì„ ì°¸ì¡°í•´ì„œ ë³´ì—¬ì¤€ë‹¤.</li><li>Non-repetable readë¼ëŠ” ë¶€ì •í•© ë¬¸ì œ ë°œìƒ í•  ìˆ˜ ìˆë‹¤.
</li></ul><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p><code>Repeatable read</code>: í•˜ë‚˜ì˜ íŠ¸ëœì­ì…˜ ë‚´ì—ì„œ ë™ì¼ select ì¿¼ë¦¬ë¥¼ ì‹¤í–‰í–ˆì„ ë•ŒëŠ” í•­ìƒ ê°™ì€ ê²°ê³¼ê°€ ë‚˜ì™€ì•¼í•œë‹¤ëŠ” ì •í•©ì„± ì •ì˜</p></div></div><p>ë™ì¼ Transaction1 ë‚´ì—ì„œ Selectë¬¸ì˜ ê²°ê³¼ê°’ì„ ë°›ê³  ì‘ì—… ë„ì¤‘ ë§Œì•½ ë‹¤ë¥¸ Transaciton2ì—ì„œ insert ë˜ëŠ” updateë¥¼ í–ˆë‹¤ê³  ê°€ì • í–ˆì„ ë•Œ Transaction1ì—ì„œ ê°™ì€ selectì— ë‹¤ë¥¸ ê²°ê³¼ê°’ì´ ë³´ì¼ ìˆ˜ ìˆëŠ” ë¬¸ì œì´ë‹¤. </p><p>ê¸€ë¡œ ì„¤ëª…í•˜ë©´ ì¡°ê¸ˆ í–‡ê°ˆë¦¬ëŠ”ë° ê·¸ë¦¼ìœ¼ë¡œ ë³´ë©´ ì‰½ë‹¤..</p><p><img loading="lazy" alt="[https://akasai.space/db/about_isolation/](https://akasai.space/db/about_isolation/)" src="/assets/images/Untitled-d652008fc6538bcc7bfbc3f1c17629f7.png" width="645" height="554" class="img_E7b_"><br>
<a href="https://akasai.space/db/about_isolation/" target="_blank" rel="noopener noreferrer">https://akasai.space/db/about_isolation/</a></p><h3 class="anchor anchorWithStickyNavbar_mojV" id="repeatable-read">Repeatable Read<a class="hash-link" href="#repeatable-read" title="Direct link to heading">â€‹</a></h3><ul><li>Mysql InnoDBì—ì„œ ê¸°ë³¸ì ìœ¼ë¡œ ì‚¬ìš©ë˜ëŠ” ê²©ë¦¬ ìˆ˜ì¤€(Shared Lockì„ ì‚¬ìš©í•œë‹¤)</li><li>Non-repetable readë¼ëŠ” ë¶€ì •í•© ë¬¸ì œê°€ ë°œìƒí•˜ì§€ ì•ŠëŠ”ë‹¤.</li><li>Undo ê³µê°„ì— ë°±ì—…í•´ë‘ê³  ì‹¤ì œ ë ˆì½”ë“œ ê°’ì„ ë³€ê²½í•œë‹¤.</li><li>ì–¸ë‘ ì˜ì—­ì— ë°±ì—…ëœ ë ˆì½”ë“œì˜ ì—¬ëŸ¬ ë²„ì „ ê°€ìš´ë° ëª‡ ë²ˆì§¸ ì´ì „ ë²„ì „ê¹Œì§€ ì°¾ì•„ ë“¤ì–´ê°€ì•¼ í•˜ëŠ”ì§€ì— ìˆë‹¤. Undo ì˜ì—­ì—ì„œ íŠ¹ì • íŠ¸ëœì­ì…˜ ë²ˆí˜¸ì˜ êµ¬ê°„ ë‚´ì—ì„œ ë°±ì—…ëœ ë°ì´í„°ë¥¼ ë³´ì—¬ì¤€ë‹¤. í•˜ì§€ë§Œ íŠ¸ëœì­ì…˜ì„ ì¢…ë£Œí•˜ì§€ ì•Šìœ¼ë©´ ë¬´í•œì •ìœ¼ë¡œ ì–¸ë‘ ì˜ì—­ì´ ì»¤ì§ˆ ìˆ˜ ìˆì–´ì„œ ì„±ëŠ¥ í•˜ë½ì´ ë  ìˆ˜ ìˆìŒ.
</li></ul><p><img loading="lazy" alt="[https://www.cyber.pe.kr/2016/11/mysql-innodb-type.html](https://www.cyber.pe.kr/2016/11/mysql-innodb-type.html)" src="/assets/images/Untitled 1-70723248a8fd0a75d0c4aa3622ef923e.png" width="229" height="443" class="img_E7b_"><br>
<a href="https://www.cyber.pe.kr/2016/11/mysql-innodb-type.html" target="_blank" rel="noopener noreferrer">https://www.cyber.pe.kr/2016/11/mysql-innodb-type.html</a></p><ol><li>ì‹œìŠ¤í…œ í…Œì´ë¸” ì˜ì—­<ul><li>DBì˜ ì‹œìŠ¤í…œì´ ìƒì„±í•œ ì˜ì—­ì´ë‹¤. ì‚¬ìš©ìê°€ ìƒì„±í•œ ë°ì´í„°ë² ì´ìŠ¤ì™€ í…Œì´ë¸”, í…Œì´ë¸”ì— ëŒ€í•œ ë©”íƒ€ ì •ë³´ ë“±ì„ ì •ë¦¬í•˜ì—¬ ê´€ë¦¬í•œë‹¤.</li></ul></li><li>íŠ¸ëœì­ì…˜ ì˜ì—­<ul><li>DBê°€ ì¿¼ë¦¬ë¥¼ ì²˜ë¦¬í•˜ëŠ” ê³¼ì •ì—ì„œ ì‹œìŠ¤í…œ ìƒì˜ ì˜¤ë¥˜ê°€ ë°œìƒí•  ê²½ìš° ì›ìƒíƒœë¡œ ë³µêµ¬í•˜ê¸° ìœ„í•´ ì¿¼ë¦¬ ì²˜ë¦¬ ì´ì „ì˜ ë°ì´í„°ë¥¼ ë³´ê´€í•˜ëŠ” ì˜ì—­ì´ë‹¤.</li></ul></li><li>ë°ì´í„° ì˜ì—­<ul><li>ì‹¤ì œ ë°ì´í„°ê°€ ì €ì¥ë˜ëŠ” ì˜ì—­ìœ¼ë¡œ, DB ì‚¬ìš©ìê°€ ì €ì¥í•œ ëª¨ë“  ë°ì´í„°ëŠ” ì´ ì˜ì—­ì— ì €ì¥ëœë‹¤. ì´ ì˜ì—­ì—ì„œëŠ” DBì˜ ì„±ëŠ¥ì„ ìœ ì§€í•˜ê¸° ìœ„í•´ ë°ì´í„° ì‚­ì œ ì‹œ, ì™„ì „ ì‚­ì œ ëŒ€ì‹  ë°ì´í„°ê°€ ì‚­ì œëœ ê²ƒìœ¼ë¡œ í‘œì‹œë§Œ í•˜ê³  ì‚­ì œ ì˜ì—­ì— ë°ì´í„°ë¥¼ ê·¸ëŒ€ë¡œ ìœ ì§€í•œë‹¤. ì´ ê°™ì€ íŠ¹ì§• ë•Œë¬¸ì— ì‚­ì œëœ ë°ì´í„°ì˜ ë³µêµ¬ê°€ ê°€ëŠ¥í•˜ë‹¤.</li></ul></li></ol><h3 class="anchor anchorWithStickyNavbar_mojV" id="serializable">Serializable<a class="hash-link" href="#serializable" title="Direct link to heading">â€‹</a></h3><ul><li>ë™ì‹œì„±ì´ ì¤‘ìš”í•œ DBì—ì„œëŠ” ê±°ì˜ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ”ë‹¤.</li><li>ì½ê¸° ì‘ì—…ë„ ê³µìœ  ì ê¸ˆì„ íšë“ í•´ì•¼ í•˜ë©° ë™ì‹œì— ë‹¤ë¥¸ íŠ¸ëœì­ì…˜ì€ ê·¸ëŸ¬í•œ ë ˆì½”ë“œë¥¼ ë³€ê²½í•˜ì§€ ëª»í•œë‹¤.</li><li>í•œ íŠ¸ëœì­ì…˜ì—ì„œ ì½ê³  ì“°ëŠ” ë ˆì½”ë“œë¥¼ ë‹¤ë¥¸ íŠ¸ëœì­ì…˜ì—ì„œëŠ” ì ‘ê·¼ ë¶ˆê°€í•˜ë‹¤</li></ul><p>ì°¸ê³ <br>
<a href="https://suhwan.dev/2019/06/09/transaction-isolation-level-and-lock/" target="_blank" rel="noopener noreferrer">https://suhwan.dev/2019/06/09/transaction-isolation-level-and-lock/</a> - gap lock, record lock ë“± ê²©ë¦¬ ë ˆë²¨ë³„ ì„¤ëª…ì´ ìì„¸í•˜ë‹¤.<br>
<a href="https://www.cyber.pe.kr/2016/11/mysql-innodb-type.html" target="_blank" rel="noopener noreferrer">https://www.cyber.pe.kr/2016/11/mysql-innodb-type.html</a><br>
<a href="http://www.kyobobook.co.kr/product/detailViewKor.laf?mallGb=KOR&amp;ejkGb=KOR&amp;barcode=9791158392703" target="_blank" rel="noopener noreferrer">RealMysql</a></p>]]></content>
        <author>
            <name>Dongle</name>
            <uri>https://github.com/sk1737030</uri>
        </author>
        <category label="DB" term="DB"/>
        <category label="Isolation" term="Isolation"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Spring Kafka Rebalancing ì²˜ë¦¬ í•´ë³´ê¸°]]></title>
        <id>rebalnace</id>
        <link href="https://dgle.dev/rebalnace"/>
        <updated>2022-05-17T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[ì¹´í”„ì¹´ ë¦¬ë°¸ëŸ°ì‹±ì´ ì¼ì–´ë‚˜ëŠ” ê²½ìš° ì–´ë–»ê²Œ ì²˜ë¦¬]]></summary>
        <content type="html"><![CDATA[<p>Kafkaë¥¼ í†µí•´ ë©”ì‹œì§€ë¥¼ ë°›ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì„ êµ¬ì„±í•  ë•Œ í”„ë¡œë•ì…˜ í™˜ê²½ì—ì„œëŠ” ê³ ë ¤í•´ì•¼ í•  ì—¬ëŸ¬ ìƒí™©ì´ ìˆëŠ”ë° ì§€ê¸ˆ ìƒê°ë‚˜ëŠ” ëŒ€í‘œì ìœ¼ë¡œ ë©”ì‹œì§€ìœ ì‹¤, ì¤‘ë³µ ë©”ì‹œì§€ Consume, í™•ì¥ ê°€ëŠ¥í•œ key ì •í•˜ê¸°, ì¹´í”„ì¹´ ë¦¬ë°¸ëŸ°ì‹± ë“± ì¹´í”„ì¹´ë¥¼ ì‚¬ìš©í•˜ëŠ”ë° ë§ì€ í˜ë“¦ì´ ë§ì´ ìˆëŠ”ë°, ì¹´í”„ì¹´ ë¦¬ë°¸ëŸ°ì‹± ìƒí™©ì—ì„œ ìš°ë¦¬ì˜ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ë‹¹í™©í•˜ì§€ ì•Šê³  ì²˜ë¦¬ë¥¼ ì˜ í•  ìˆ˜ ìˆëŠ” ë°©ë²•ì„ ì†Œê°œí•´ ë³´ë ¤ê³  í•œë‹¤.</p><p><a href="https://github.com/sk1737030/til/tree/master/kafka-repartitioning" target="_blank" rel="noopener noreferrer">ëª¨ë“  ì†ŒìŠ¤ëŠ” ì´ê³³ì—ì„œ</a> í™•ì¸ ê°€ëŠ¥í•©ë‹ˆë‹¤ :)</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="ìŠ¤í”„ë§-ë¶€íŠ¸ì—ì„œ-kafka-rebalancing-ì²˜ë¦¬-í•´ë³´ê¸°">ìŠ¤í”„ë§ ë¶€íŠ¸ì—ì„œ Kafka Rebalancing ì²˜ë¦¬ í•´ë³´ê¸°<a class="hash-link" href="#ìŠ¤í”„ë§-ë¶€íŠ¸ì—ì„œ-kafka-rebalancing-ì²˜ë¦¬-í•´ë³´ê¸°" title="Direct link to heading">â€‹</a></h2><p>Kafkaë¥¼ í†µí•´ ë©”ì‹œì§€ë¥¼ ë°›ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì„ êµ¬ì„±í•  ë•Œ í”„ë¡œë•ì…˜ í™˜ê²½ì—ì„œëŠ” ê³ ë ¤í•´ì•¼ í•  ì—¬ëŸ¬ ìƒí™©ì´ ìˆëŠ”ë° ì§€ê¸ˆ ìƒê°ë‚˜ëŠ” ëŒ€í‘œì ìœ¼ë¡œ ë©”ì‹œì§€ìœ ì‹¤, ì¤‘ë³µ ë©”ì‹œì§€ Consume, í™•ì¥ ê°€ëŠ¥í•œ key ì •í•˜ê¸°, ì¹´í”„ì¹´ ë¦¬ë°¸ëŸ°ì‹± ë“± ì¹´í”„ì¹´ë¥¼ ì‚¬ìš©í•˜ëŠ”ë° ë§ì€ í˜ë“¦ì´ ë§ì´ ìˆëŠ”ë°, ì¹´í”„ì¹´ ë¦¬ë°¸ëŸ°ì‹± ìƒí™©ì—ì„œ ìš°ë¦¬ì˜ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ë‹¹í™©í•˜ì§€ ì•Šê³  ì²˜ë¦¬ë¥¼ ì˜ í•  ìˆ˜ ìˆëŠ” ë°©ë²•ì„ ì†Œê°œí•´ ë³´ë ¤ê³  í•œë‹¤.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="ì¹´í”„ì¹´-ë¦¬ë°¸ëŸ°ì‹±ì´ë€">ì¹´í”„ì¹´ ë¦¬ë°¸ëŸ°ì‹±ì´ë€?<a class="hash-link" href="#ì¹´í”„ì¹´-ë¦¬ë°¸ëŸ°ì‹±ì´ë€" title="Direct link to heading">â€‹</a></h3><p>ë¨¼ì € ë¦¬ë°¸ëŸ°ì‹±ì´ ë­”ì§€ ì ê¹ ì•Œì•„ë³´ê³  ê°„ë‹¤ë©´, Kafka í† í”½ì„ êµ¬ì„±í•  ë•Œ í•œ í† í”½ì„ ì—¬ëŸ¬ ê°œì˜ Partitionsë“¤ë¡œ êµ¬ì„±í•˜ëŠ” ì¼ì´ ë§ì€ë°, ìì—°ìŠ¤ëŸ½ê²Œ Consumer(<code>ê°™ì€ Group.Id</code>)ë„ ì—¬ëŸ¬ ê°œë¡œ êµ¬ì„±ì´ ëœë‹¤. ì´ë•Œ ë©”ì‹œì§€ë¥¼ Consume í•˜ëŠ” ìƒí™©ì—ì„œ Consumerê°€ ì—¬ëŸ¬ ê°€ì§€ ìƒí™©ìœ¼ë¡œ ì¸í•˜ì—¬ Brokerì™€ ì—°ê²°ì´ ëŠì–´ì¡Œì„ ë•Œ, ì¼ì–´ë‚˜ëŠ” ê²ƒì´ <code>ë¦¬ë°¸ëŸ°ì‹±ì¸ë°</code> ë¬¸ì œì—†ì´ ë©”ì‹œì§€ë¥¼ ì†Œë¹„í•˜ê²Œ ìœ„í•´ì„œ ë¸Œë¡œì»¤ê°€ ì¥ì• ê°€ ì¼ì–´ë‚¬ë‹¤ê³  íŒë‹¨í•˜ê³  ê¸°ì¡´ Consumerì— í• ë‹¹ë˜ì–´ ìˆëŠ” íŒŒí‹°ì…˜ì„ ë‹¤ë¥¸ Consumerì— ì¬ í• ë‹¹í•˜ëŠ” ê²ƒì´ë‹¤. </p><h3 class="anchor anchorWithStickyNavbar_mojV" id="ê·¸ë ‡ë‹¤ë©´-ê¼­-ë¦¬ë°¸ëŸ°ì‹±-ì²˜ë¦¬ë¥¼-í•´ì•¼í• ê¹Œ">ê·¸ë ‡ë‹¤ë©´ ê¼­ ë¦¬ë°¸ëŸ°ì‹± ì²˜ë¦¬ë¥¼ í•´ì•¼í• ê¹Œ?<a class="hash-link" href="#ê·¸ë ‡ë‹¤ë©´-ê¼­-ë¦¬ë°¸ëŸ°ì‹±-ì²˜ë¦¬ë¥¼-í•´ì•¼í• ê¹Œ" title="Direct link to heading">â€‹</a></h3><p>ì´ê±´ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ì¹´í”„ì¹´ë¥¼ ì‚¬ìš©í•˜ëŠ” ì´ìœ ì— ë”°ë¼ ë‹¤ë¥¸ë°, ë§Œì•½ í† í”½ì„ ì»¨ìŠ˜ í•  ë•Œ íŠ¹ì • keyë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì»¨ìŠ˜ì„ í•˜ê³  ìˆë‹¤ê³  ì˜ˆë¥¼ ë“¤ì–´ ë°°ë‹¬ ì£¼ë¬¸ì— ëŒ€í•´ì„œ ì¹´í”„ì¹´ë¥¼ ì‚¬ìš©í•œë‹¤ê³  í•˜ì˜€ì„ ë•Œ í† í”½ì˜ Keyë¥¼ í•œì‹(0 ë²ˆ), ì¤‘ì‹(1 ë²ˆ), ì–‘ì‹(2 ë²ˆ), ì¼ì‹(3 ë²ˆ) ìœ¼ë¡œ (ê·¸ëŸ´ ë¦¬ëŠ” ì—†ê² ì§€ë§Œ) í•  ê²½ìš°, ë§Œì•½ ì¼ì‹ì„ ì»¨ìŠ˜í•˜ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì–´ë– í•œ ì¥ì• ë¡œ ì»¨ìŠ˜ì„ ëª»í•œë‹¤ê³  í•˜ì˜€ì„ ë•Œ, ì¼ì‹(3 ë²ˆ)ì˜ íŒŒí‹°ì…˜ì´ í•œì‹(0 ë²ˆ) íŒŒí‹°ì…˜ìœ¼ë¡œ í• ë‹¹ë˜ì—ˆì„ ë•Œ (ëŸ°íƒ€ì„ì—) ì²˜ë¦¬ê°€ ë”°ë¡œ í•„ìš”í•  ìˆ˜ê°€ ìˆë‹¤. í•œì‹ë§Œ ê°€ì§€ê³  ìˆëŠ” ë©”ë‰´ ì •ë³´ë¥¼ ì¼ì‹ì„ í¬í•¨í•œ ë©”ë‰´ ì •ë³´ë¡œ ë‹¤ì‹œ ë¶ˆëŸ¬ì˜¨ë‹¤ë“ ì§€, ì•„ë‹ˆë©´ ë”°ë¡œ ì•ŒëŒ ì²˜ë¦¬ë¥¼ í•œë‹¤ë“ ì§€ ë‚´ë¶€ ë©”ëª¨ë¦¬ì— ê°€ì§€ê³  ìˆëŠ” ì •ë³´ë“¤ì„ ì´ˆê¸°í™” ì‘ì—…ì´ í•„ìš”í•˜ëŠ” ë“± ì—¬ëŸ¬ ê°€ì§€ ì²˜ë¦¬í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì— ë¦¬ë°¸ëŸ°ì‹± ì²˜ë¦¬ëŠ” ì¹´í”„ì¹´ë¥¼ ì‚¬ìš©í•˜ëŠ” ì´ìœ ì— ë”°ë¼ ë‹¬ë¼ ì²˜ë¦¬ í•  ìˆ˜ë„ ì•ˆ í•´ë„ ëœë‹¤.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="ì½”ë“œë¡œ">ì½”ë“œë¡œ<a class="hash-link" href="#ì½”ë“œë¡œ" title="Direct link to heading">â€‹</a></h3><p>ì½”ë“œë¡œ ì²˜ë¦¬í•˜ëŠ” ë¶€ë¶„ì€ ì˜ì™¸ë¡œ ê°„ë‹¨í•œë° ì¼ë‹¨ Spring Docsì—ì„œ í™•ì¸ì„ í•´ë³¸ë‹¤ë©´<br>
<code>Kafkaì˜ ConsumerRebalanceListener</code> ë¥¼ êµ¬í˜„í•œ <code>ConsumerAwareRebalanceListener</code> ë¥¼ ì‚¬ìš©í•˜ë©´ ëœë‹¤.</p><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">interface</span><span class="token plain"> </span><span class="token class-name">ConsumerAwareRebalanceListener</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">extends</span><span class="token plain"> </span><span class="token class-name">ConsumerRebalanceListener</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">default</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">onPartitionsRevokedBeforeCommit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">Consumer</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics operator" style="color:#393A34">?</span><span class="token generics punctuation" style="color:#393A34">,</span><span class="token generics"> </span><span class="token generics operator" style="color:#393A34">?</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> consumer</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">Collection</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">TopicPartition</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> partitions</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">try</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token function" style="color:#d73a49">onPartitionsRevoked</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">partitions</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">catch</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">Exception</span><span class="token plain"> e</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// NOSONAR</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            LOGGER</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">debug</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">e</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"User method threw exception"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">default</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">onPartitionsRevokedAfterCommit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">Consumer</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics operator" style="color:#393A34">?</span><span class="token generics punctuation" style="color:#393A34">,</span><span class="token generics"> </span><span class="token generics operator" style="color:#393A34">?</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> consumer</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">Collection</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">TopicPartition</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> partitions</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">default</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">onPartitionsLost</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">Consumer</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics operator" style="color:#393A34">?</span><span class="token generics punctuation" style="color:#393A34">,</span><span class="token generics"> </span><span class="token generics operator" style="color:#393A34">?</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> consumer</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">Collection</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">TopicPartition</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> partitions</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">try</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token function" style="color:#d73a49">onPartitionsLost</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">partitions</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">catch</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">Exception</span><span class="token plain"> e</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// NOSONAR</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            LOGGER</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">debug</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">e</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"User method threw exception"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">default</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">onPartitionsAssigned</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">Consumer</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics operator" style="color:#393A34">?</span><span class="token generics punctuation" style="color:#393A34">,</span><span class="token generics"> </span><span class="token generics operator" style="color:#393A34">?</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> consumer</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">Collection</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">TopicPartition</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> partitions</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">try</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token function" style="color:#d73a49">onPartitionsAssigned</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">partitions</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">catch</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">Exception</span><span class="token plain"> e</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// NOSONAR</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            LOGGER</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">debug</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">e</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"User method threw exception"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token annotation punctuation" style="color:#393A34">@Override</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">default</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">onPartitionsRevoked</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">Collection</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">TopicPartition</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> partitions</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token annotation punctuation" style="color:#393A34">@Override</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">default</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">onPartitionsAssigned</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">Collection</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">TopicPartition</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> partitions</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token annotation punctuation" style="color:#393A34">@Override</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">default</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">onPartitionsLost</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">Collection</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">TopicPartition</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> partitions</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p><code>onPartitionsAssigned</code> ì€ íŒŒí‹°ì…˜ ì¬í• ë‹¹ì´ ì„±ê³µì ìœ¼ë¡œ ì™„ë£Œë  ë•Œ í˜¸ì¶œëœë‹¤.<br>
<code>onPartitionsRevoked</code> ì€ í• ë‹¹ë˜ì–´ ìˆë˜ íŒŒí‹°ì…˜ì´ ì œê±° ë  ë•Œ í˜¸ì¶œëœë‹¤.<br>
<code>onPartitionsLost</code> ì€  ì¼ë°˜ì ì¸ ìƒí™©ì—ì„œëŠ” ì‹¤í–‰ì´ ì•ˆë˜ë‚˜ ë§Œì•½ ì»¨ìŠˆë¨¸ì˜ ì„¸ì…˜ ì œí•œ ì‹œê°„ì´ ë§Œë£Œë˜ì—ˆê±°ë‚˜ ì»¨ìŠˆë¨¸ê°€ ë” ì´ìƒ ê·¸ë£¹ì— ì†í•˜ì§€ ì•ŠìŒì„ ë‚˜íƒ€ë‚´ëŠ” ì¹˜ëª…ì ì¸ ì˜¤ë¥˜ê°€ ìˆ˜ì‹ ëœ ê²½ìš° í˜¸ì¶œëœë‹¤.  </p><br><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>ReBalancingìˆœì„œ</h5></div><div class="admonition-content"><p>ì°¸ê³ ë¡œ ì¼ë°˜ì ì¸ íŒŒí‹°ì…˜ì´ í• ë‹¹ë˜ê³  ì˜ ì‹¤í–‰ë˜ê³  ìˆëŠ” ëŸ°íƒ€ì„ í™˜ê²½ì—ì„œëŠ” ë‹¹ì—°í•œ ë§ì´ ê² ì§€ë§Œ <code>PartitionsRevoke</code>ê°€ ì‹¤í–‰ëœ í›„ <code>PartitionsAssigned</code>ê°€ ì‹¤í–‰ëœë‹¤. ë°˜ë©´ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì‹¤í–‰ ë  ë•Œì—ëŠ” <code>PartitionsAssigned</code>ë§Œ ì‹¤í–‰ëœë‹¤.</p></div></div><br>ìš°ë¦¬ ì–´í”Œë¦¬ì¼€ì´ì…˜ì—ì„œëŠ” Spring Kakaì—ì„œ ì˜ ê°ì‹¸ì„œ ì¤€ `ConsumerAwareRebalanceListener` ìƒì† ë°›ì•„ì„œ ì‚¬ìš©í•˜ë©´ ëœë‹¤.<div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token annotation punctuation" style="color:#393A34">@Component</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">MyListener</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">implements</span><span class="token plain"> </span><span class="token class-name">ConsumerAwareRebalanceListener</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token annotation punctuation" style="color:#393A34">@Override</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">onPartitionsAssigned</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">Consumer</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics operator" style="color:#393A34">?</span><span class="token generics punctuation" style="color:#393A34">,</span><span class="token generics"> </span><span class="token generics operator" style="color:#393A34">?</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> consumer</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">Collection</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">TopicPartition</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> partitions</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token class-name">ConsumerAwareRebalanceListener</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">super</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">onPartitionsAssigned</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">consumer</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> partitions</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token class-name">System</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">out</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"onPartitionsAssigned"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      partitions</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">forEach</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">topicPartition </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain"> </span><span class="token class-name">System</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">out</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">topicPartition</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">partition</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token annotation punctuation" style="color:#393A34">@Override</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">onPartitionsLost</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">Consumer</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics operator" style="color:#393A34">?</span><span class="token generics punctuation" style="color:#393A34">,</span><span class="token generics"> </span><span class="token generics operator" style="color:#393A34">?</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> consumer</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">Collection</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">TopicPartition</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> partitions</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token class-name">ConsumerAwareRebalanceListener</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">super</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">onPartitionsLost</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">consumer</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> partitions</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token class-name">System</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">out</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"onPartitionsLost"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token annotation punctuation" style="color:#393A34">@Override</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">onPartitionsRevoked</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">Collection</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">TopicPartition</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> partitions</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token class-name">ConsumerAwareRebalanceListener</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">super</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">onPartitionsRevoked</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">partitions</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token class-name">System</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">out</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"onPartitionsRevoked"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p><code>consumer</code> ì—ëŠ” <code>Consumer</code>ì—  ì—¬ëŸ¬ ì •ë³´ë“¤ì„ ë³¼ ìˆ˜ ìˆë‹¤.<br>
<code>partitions</code> íŒŒë¼ë¯¸í„°ë¡œ í˜„ì¬ í• ë‹¹ ëœ ëª©ë¡ì„ ì¸ìë¡œ ì¤€ë‹¤.  </p><p><img loading="lazy" alt="Untitled" src="/assets/images/Untitled-a7ab9c3a34c1371370ca6e4eebd9065a.png" width="1907" height="242" class="img_E7b_"></p><h3 class="anchor anchorWithStickyNavbar_mojV" id="ëŠë‚€ì ">ëŠë‚€ì <a class="hash-link" href="#ëŠë‚€ì " title="Direct link to heading">â€‹</a></h3><p>ì§„ì§œ ì¹´í”„ì¹´ ë„ˆë¬´ ì–´ë µë‹¤. íŠ¹íˆ ì¹´í”„ì¹´ì— ì˜ì¡´ì„±ì´ ë†’ìœ¼ë©´ ë†’ì„ìˆ˜ë¡ ë‚œë„ê°€ ì˜¬ë¼ê°€ëŠ” ê±° ê°™ë‹¤. ìƒê° í•´ ë³¼ ë¶€ë¶„ë“¤ì´ ë§ì€ë°, ì¹´í”„ì¹´ì˜ ë©”ì‹œì§€ë¥¼ produceí•  ë•Œ ìœ ì‹¤ì´ ë‚˜ë©´ ì•ˆ ë˜ëŠ” ì„œë¹„ìŠ¤ì¸ë° ì–´ë–»ê²Œ ë¹ ë¥´ë©´ì„œ ë©”ì‹œì§€ê°€ ìœ ì‹¤ë˜ì§€ ì•Šì„ê¹Œë¥¼ ê³ ë ¤ í•œë‹¤ë“ ì§€, í† í”½ì˜ keyë¥¼ ì–´ë–¤ keyë¡œ ì„¤ì •í•˜ëƒì— í™•ì •ì„±ì´ ìˆê³  ë©”ì‹œì§€ê°€ ì˜ ë¶„ë°° ë  ë•Œë¼ë˜ì§€, ë¦¬íŒŒí‹°ë‹ˆì…”ë‹ ìƒí™©ì—ì„œì˜ ì„œë¹„ìŠ¤ê°€ ë¬¸ì œê°€ ì—†ì„ê¹Œ ë©”ì„¸ì§€ë¥¼ ì¤‘ë³µìœ¼ë¡œ ì½ì„ ê²½ìš°ëŠ” ì—†ì„ ê±°ë¼ë“ ì§€, ì¤‘ë³µìœ¼ë¡œ ë©”ì‹œì§€ë¥¼ ì»¨ìŠ˜ í•  ê²½ìš°ë„ ìˆëŠ”ë° ì´ë•ŒëŠ” ì–´ë–»ê²Œ ì²˜ë¦¬ í•´ì•¼ í• ê¹Œ ë“±ë“± ì •ë§ ì¹´í”„ì¹´ ì–´ë µë‹¤. ê·¸ëŸ°ë° ë§‰ìƒ ì´ëŸ° ê±¸ í•˜ë‚˜í•˜ë‚˜ í•´ê²° í•´ì„œ ì„œë¹„ìŠ¤ê°€ ì¥ì•  ì—†ê³  ìš°ì•„í•˜ê²Œ ì˜ ëŒì•„ê°€ëŠ” ê±¸ í•  ìˆ˜ ìˆë‹¤ë©´ ì–¼ë§ˆë‚˜ ë§›ì´ ìˆì„ê¹Œ? ê·¸ëŸ° ìƒìƒì„ í•˜ë©´ì„œ <del>ì•¼-ê·¼ì„ í•œë‹¤.</del></p><p><img loading="lazy" alt="Untitled" src="/assets/images/Untitled 1-d906beaf502a07f682c7ddff70c5c686.png" width="300" height="168" class="img_E7b_"></p><p>ì°¸ê³ <br>
<a href="https://developer.confluent.io/learn-kafka/apache-kafka/partitions/" target="_blank" rel="noopener noreferrer">https://developer.confluent.io/learn-kafka/apache-kafka/partitions/</a><br>
<a href="https://www.popit.kr/kafka-consumer-group/" target="_blank" rel="noopener noreferrer">https://www.popit.kr/kafka-consumer-group/</a><br>
<a href="https://stackoverflow.com/questions/34550873/difference-between-groupid-and-consumerid-in-kafka-consumer" target="_blank" rel="noopener noreferrer">group idì™€ consume id ì°¨ì´</a><br>
<a href="https://docs.spring.io/spring-kafka/docs/2.5.17.RELEASE/reference/html/" target="_blank" rel="noopener noreferrer">ìŠ¤í”„ë§ Kafka Docs</a><br>
<a href="https://kafka.apache.org/25/javadoc/org/apache/kafka/clients/consumer/ConsumerRebalanceListener.html#onPartitionsLost-java.util.Collection-" target="_blank" rel="noopener noreferrer">ConsumerRebalanceListenerì„¤ëª…</a></p>]]></content>
        <author>
            <name>Dongle</name>
            <uri>https://github.com/sk1737030</uri>
        </author>
        <category label="Kafka" term="Kafka"/>
        <category label="Spring Kafka" term="Spring Kafka"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Spring Cloud Gateway Route ì„¤ì •í•´ë³´ê¸°]]></title>
        <id>gateway</id>
        <link href="https://dgle.dev/gateway"/>
        <updated>2022-05-08T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[ìŠ¤í”„ë§ ê²Œì´íŠ¸ì›¨ì´ Route ê¹Œë³´ê¸°]]></summary>
        <content type="html"><![CDATA[<p>Spring gatewayì„ ì‚¬ìš©í•  ë•Œ ì¼ë°˜ì ìœ¼ë¡œ 2ê°€ì§€ ë°©ì‹ìœ¼ë¡œ route ì„¤ì •ì„ í•  ìˆ˜ ìˆëŠ”ë° ì–´ë–¤ê²Œ ë” ì¢‹ì„ê¹Œ?</p><p>ëª¨ë“  ì†ŒìŠ¤ëŠ” <a href="https://github.com/sk1737030/til/tree/master/spring-cloud-gateway" target="_blank" rel="noopener noreferrer">ì´ê³³</a>ì—ì„œ í™•ì¸ ê°€ëŠ¥í•©ë‹ˆë‹¤:)</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="spring-gateway-route">Spring Gateway Route<a class="hash-link" href="#spring-gateway-route" title="Direct link to heading">â€‹</a></h2><p>Spring gatewayì„ ì‚¬ìš©í•  ë•Œ ì¼ë°˜ì ìœ¼ë¡œ 2ê°€ì§€ ë°©ì‹ìœ¼ë¡œ route ì„¤ì •ì„ í•  ìˆ˜ ìˆë‹¤.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="yaml">Yaml<a class="hash-link" href="#yaml" title="Direct link to heading">â€‹</a></h3><div class="codeBlockContainer_I0IT language-yaml theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-yaml codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">spring</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">cloud</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">gateway</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">globalcors</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">corsConfigurations</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">'[/**]'</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">allowedOrigins</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'*'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">allowedMethods</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> POST</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> GET</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> PUT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> OPTIONS</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> DELETE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">routes</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">id</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> a</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">service</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">uri</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> http</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">//localhost</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">18081</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">predicates</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> Path=/aservice/</span><span class="token important">**</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">id</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> b</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">service</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">uri</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> http</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">//localhost</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">18082</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">predicates</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> Path=/bservice/</span><span class="token important">**</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><div class="codeBlockContainer_I0IT language-verilog theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-verilog codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">2022-02-19 18:07:46.827 DEBUG 33218 --- [  restartedMain] o.s.c.gateway.config.GatewayProperties   : Routes supplied from Gateway Properties: [RouteDefinition{id='a-service', predicates=[PredicateDefinition{name='Path', args={_genkey_0=/aservice/**}}], filters=[], uri=http://localhost:18081, order=0, metadata={}}, RouteDefinition{id='b-service', predicates=[PredicateDefinition{name='Path', args={_genkey_0=/bservice/**}}], filters=[], uri=http://localhost:18082, order=0, metadata={}}]</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="java">Java<a class="hash-link" href="#java" title="Direct link to heading">â€‹</a></h3><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token import namespace" style="opacity:0.7">org</span><span class="token import namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token import namespace" style="opacity:0.7">springframework</span><span class="token import namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token import namespace" style="opacity:0.7">cloud</span><span class="token import namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token import namespace" style="opacity:0.7">gateway</span><span class="token import namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token import namespace" style="opacity:0.7">route</span><span class="token import namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token import class-name">RouteLocator</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token import namespace" style="opacity:0.7">org</span><span class="token import namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token import namespace" style="opacity:0.7">springframework</span><span class="token import namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token import namespace" style="opacity:0.7">cloud</span><span class="token import namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token import namespace" style="opacity:0.7">gateway</span><span class="token import namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token import namespace" style="opacity:0.7">route</span><span class="token import namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token import namespace" style="opacity:0.7">builder</span><span class="token import namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token import class-name">RouteLocatorBuilder</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token import namespace" style="opacity:0.7">org</span><span class="token import namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token import namespace" style="opacity:0.7">springframework</span><span class="token import namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token import namespace" style="opacity:0.7">context</span><span class="token import namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token import namespace" style="opacity:0.7">annotation</span><span class="token import namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token import class-name">Bean</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token import namespace" style="opacity:0.7">org</span><span class="token import namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token import namespace" style="opacity:0.7">springframework</span><span class="token import namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token import namespace" style="opacity:0.7">context</span><span class="token import namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token import namespace" style="opacity:0.7">annotation</span><span class="token import namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token import class-name">Configuration</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token annotation punctuation" style="color:#393A34">@Configuration</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">RouteConfig</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token annotation punctuation" style="color:#393A34">@Bean</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token class-name">RouteLocator</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">bRoue</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">RouteLocatorBuilder</span><span class="token plain"> builder</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> builder</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">routes</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">route</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"q-service"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> r </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain"> r</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">path</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"/q-service/**"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">uri</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"http://localhost:18081"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">route</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"q-service"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> r </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain"> r</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">path</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"/w-service/**"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">uri</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"http://localhost:18080"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">build</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token annotation punctuation" style="color:#393A34">@Bean</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token class-name">RouteLocator</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">cRoute</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">RouteLocatorBuilder</span><span class="token plain"> builder</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> builder</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">routes</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">route</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"c-service"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> r </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain"> r</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">path</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"/c-service/**"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">uri</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"http://localhost:18081"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">route</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"d-service"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> r </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain"> r</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">path</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"/d-service/**"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">uri</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"http://localhost:18080"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">build</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ë¼ìš°íŠ¸ë“¤ì„ ë‚˜ëˆ ì„œ ì„¤ì •í•  ìˆ˜ ìˆë‹¤. ê·¸ë ‡ë‹¤ë©´ ë”°ë¡œ ì„¤ì •í•œ ë¼ìš°í„°ë“¤ì´ ì–´ë–»ê²Œ ê°™ì´ í•©ì³ì ¸ì„œ ì‘ë™í•˜ëŠ” ê²ƒ ì¼ê¹Œ?</p><p>Route êµ¬ì„±ë„<br>
<img loading="lazy" alt="[https://zhuanlan.zhihu.com/p/359523303](https://zhuanlan.zhihu.com/p/359523303)" src="/assets/images/Untitled-b81964f0be36af8e05b92420a9f3fdde.png" width="1749" height="1120" class="img_E7b_">  </p><p><a href="https://zhuanlan.zhihu.com/p/359523303" target="_blank" rel="noopener noreferrer">https://zhuanlan.zhihu.com/p/359523303</a>  </p><p>ì¼ë‹¨ ë¨¼ì € ë´ì•¼í•  ê²ƒì€ <code>RouteDefinationLocator</code>ì´ë‹¤.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="routedefinationlocator">RouteDefinationLocator<a class="hash-link" href="#routedefinationlocator" title="Direct link to heading">â€‹</a></h3><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">interface</span><span class="token plain"> </span><span class="token class-name">RouteDefinitionLocator</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">Flux</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">RouteDefinition</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">getRouteDefinitions</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p><code>RouteDefinationLocator</code>ì„ êµ¬í˜„í•œ ê°ì²´ë“¤ì€ 5ê°œê°€ ìˆë‹¤.  </p><ol><li><code>CachingRouteDefinitionLocator</code></li><li><code>CompositeRouteDefinitionLocator</code></li><li><code>DiscoveryClientRouteDefinitionLocator</code></li><li><code>PropertiesRouteDefinitionLocator</code> </li><li><code>RouteDefinitionRepository</code></li></ol><h3 class="anchor anchorWithStickyNavbar_mojV" id="discoveryclientroutedefinitionlocator">DiscoveryClientRouteDefinitionLocator<a class="hash-link" href="#discoveryclientroutedefinitionlocator" title="Direct link to heading">â€‹</a></h3><p>Service Discovery(Netflix Eureka, Consul, or Zookeeper)ì™€ ì—°ë™í•˜ì—¬ ë“±ë¡ëœ ì„œë¹„ìŠ¤ë“¤ì„ ê¸°ì¤€ìœ¼ë¡œ ê²½ë¡œë¥¼ ë§Œë“ ë‹¤.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="propertiesroutedefinitionlocator">PropertiesRouteDefinitionLocator<a class="hash-link" href="#propertiesroutedefinitionlocator" title="Direct link to heading">â€‹</a></h3><p>Yamlì— ì„¤ì •í•œ property valueë“¤ì´ <strong>GateWayProperty</strong> ì§ë ¬í™”ë˜ì–´ ê°’ì´ ë“¤ì–´ê°€ê³   </p><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">PropertiesRouteDefinitionLocator</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">implements</span><span class="token plain"> </span><span class="token class-name">RouteDefinitionLocator</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">private</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">final</span><span class="token plain"> </span><span class="token class-name">GatewayProperties</span><span class="token plain"> properties</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token class-name">PropertiesRouteDefinitionLocator</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">GatewayProperties</span><span class="token plain"> properties</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">properties </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> properties</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token annotation punctuation" style="color:#393A34">@Override</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token class-name">Flux</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">RouteDefinition</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">getRouteDefinitions</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token class-name">Flux</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">fromIterable</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">properties</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getRoutes</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p><img loading="lazy" alt="Untitled" src="/assets/images/Untitled 1-537a060eddc6cebb678cb2eed9f7ce6b.png" width="1678" height="568" class="img_E7b_"></p><p>GatewayProperty ê°’ì€ <strong>PropertiesRouteDefinitionLocator ì— ì“°ì´ê²Œ ëœë‹¤.</strong>  </p><p><img loading="lazy" alt="Untitled" src="/assets/images/Untitled 2-2ca8958503e816aee719c207dd1dfb43.png" width="1729" height="678" class="img_E7b_"></p><h3 class="anchor anchorWithStickyNavbar_mojV" id="compositeroutedefinitionlocator"><strong>CompositeRouteDefinitionLocator</strong><a class="hash-link" href="#compositeroutedefinitionlocator" title="Direct link to heading">â€‹</a></h3><p><a href="https://docs.spring.io/spring-integration/reference/html/dsl.html" target="_blank" rel="noopener noreferrer">ìë°” DSL</a>(í¸ë¦¬í•˜ê²Œ fluent APIë¥¼ ì§€ì›)ë¡œ ì„¤ì •í•œ ë¼ìš°í„°ë“¤ì˜ ê°’ì´ ë“¤ì–´ê°€ ìˆê³   </p><p><img loading="lazy" alt="Untitled" src="/assets/images/Untitled 3-9b6e49f05eba03ff26bc2accc55dc845.png" width="2024" height="1003" class="img_E7b_">  </p><p><code>CompositeRouteDefinitionLocator</code>ì—ì„œ <strong>PropertiesRouteDefinitionLocatorì—ì„œ</strong> ì„¤ì •í•œ ë¼ìš°í„°ë“¤ì— idê°€ ì—†ì„ ê²½ìš° randidê°€ ë“¤ì–´ê°€ê²Œ ëœë‹¤.  </p><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">CompositeRouteDefinitionLocator</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">implements</span><span class="token plain"> </span><span class="token class-name">RouteDefinitionLocator</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token annotation punctuation" style="color:#393A34">@Override</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token class-name">Flux</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">RouteDefinition</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">getRouteDefinitions</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">delegates</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">flatMapSequential</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">RouteDefinitionLocator</span><span class="token operator" style="color:#393A34">::</span><span class="token function" style="color:#d73a49">getRouteDefinitions</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">flatMap</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">routeDefinition </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">routeDefinition</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getId</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">randomId</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">map</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">id </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            routeDefinition</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">setId</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">id</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">log</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">isDebugEnabled</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                log</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">debug</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"Id set on route definition: "</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> routeDefinition</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> routeDefinition</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token class-name">Mono</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">just</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">routeDefinition</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="routedefinitionroutelocator">RouteDefinitionRouteLocator<a class="hash-link" href="#routedefinitionroutelocator" title="Direct link to heading">â€‹</a></h3><p>Routeë“¤ì„ keyë¥¼ ê¸°ì¤€ìœ¼ë¡œ í™•ì¸ í›„ì— <code>RoutePredicateFactory</code>ì— ì§‘ì–´ë„£ëŠ”ë‹¤.  </p><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">RouteDefinitionRouteLocator</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">implements</span><span class="token plain"> </span><span class="token class-name">RouteLocator</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token class-name">RouteDefinitionRouteLocator</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">RouteDefinitionLocator</span><span class="token plain"> routeDefinitionLocator</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token class-name">List</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">RoutePredicateFactory</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> predicates</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">List</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">GatewayFilterFactory</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> gatewayFilterFactories</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token class-name">GatewayProperties</span><span class="token plain"> gatewayProperties</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">ConfigurationService</span><span class="token plain"> configurationService</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">routeDefinitionLocator </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> routeDefinitionLocator</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">configurationService </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> configurationService</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">initFactories</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">predicates</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        gatewayFilterFactories</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">forEach</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">factory </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">gatewayFilterFactories</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">put</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">factory</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">name</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> factory</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">gatewayProperties </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> gatewayProperties</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// RoutePredicateFactory ê²€ì‚¬</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">private</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">initFactories</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">List</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">RoutePredicateFactory</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> predicates</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        predicates</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">forEach</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">factory </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token class-name">String</span><span class="token plain"> key </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> factory</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">name</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">predicates</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">containsKey</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">key</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">logger</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">warn</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"A RoutePredicateFactory named "</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> key </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">" already exists, class: "</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">predicates</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">key</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">". It will be overwritten."</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">predicates</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">put</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">key</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> factory</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">logger</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">isInfoEnabled</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                logger</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">info</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"Loaded RoutePredicateFactory ["</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> key </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"]"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token class-name">Flux</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">Route</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">getRoutes</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">Flux</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">Route</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> routes </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">routeDefinitionLocator</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getRouteDefinitions</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">map</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">this</span><span class="token operator" style="color:#393A34">::</span><span class="token function" style="color:#d73a49">convertToRoute</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">!</span><span class="token plain">gatewayProperties</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">isFailOnRouteDefinitionError</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic">// instead of letting error bubble up, continue</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            routes </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> routes</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">onErrorContinue</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">error</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> obj</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">logger</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">isWarnEnabled</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    logger</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">warn</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"RouteDefinition id "</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">RouteDefinition</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> obj</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getId</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">" will be ignored. Definition has invalid configs, "</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> error</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getMessage</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> routes</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">map</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">route </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">logger</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">isDebugEnabled</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                logger</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">debug</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"RouteDefinition matched: "</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> route</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getId</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> route</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="compositeroutelocator">CompositeRouteLocator<a class="hash-link" href="#compositeroutelocator" title="Direct link to heading">â€‹</a></h3><p>ì—¬ëŸ¬ ê°œì˜ <code>RouteLocator</code> ë“¤ì€ delegatesë¥¼ ê°€ì§€ê³ , ê° RouteLocatorë“¤ì´ ê°€ì§€ê³  ìˆëŠ” Routeë“¤ì„ í•˜ë‚˜ë¡œ í•©ì¹œë‹¤.</p><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">CompositeRouteLocator</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">implements</span><span class="token plain"> </span><span class="token class-name">RouteLocator</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">private</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">final</span><span class="token plain"> </span><span class="token class-name">Flux</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">RouteLocator</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> delegates</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token class-name">CompositeRouteLocator</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">Flux</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">RouteLocator</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> delegates</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">delegates </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> delegates</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token annotation punctuation" style="color:#393A34">@Override</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token class-name">Flux</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">Route</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">getRoutes</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">delegates</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">flatMapSequential</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">RouteLocator</span><span class="token operator" style="color:#393A34">::</span><span class="token function" style="color:#d73a49">getRoutes</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p><img loading="lazy" alt="this.deligates ì•ˆì— ì„¤ì •í•œ routeë“¤ì´ ë‹´ê²¨ìˆëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤." src="/assets/images/Untitled 4-73c6829a0a54efb556439b564df0be67.png" width="1083" height="517" class="img_E7b_"></p><p>this.deligates ì•ˆì— ì„¤ì •í•œ routeë“¤ì´ ë‹´ê²¨ìˆëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="cachingroutelocator">CachingRouteLocator<a class="hash-link" href="#cachingroutelocator" title="Direct link to heading">â€‹</a></h3><p>deletgateë“¤ì„ ë°›ì•„ ìºì‹œì— ì €ì¥í•´ì„œ routeë“¤ì„ ê°€ì§„ë‹¤.</p><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">CachingRouteLocator</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">implements</span><span class="token plain"> </span><span class="token class-name">Ordered</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">RouteLocator</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">ApplicationListener</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">RefreshRoutesEvent</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">ApplicationEventPublisherAware</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">private</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">final</span><span class="token plain"> </span><span class="token class-name">Map</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">String</span><span class="token generics punctuation" style="color:#393A34">,</span><span class="token generics"> </span><span class="token generics class-name">List</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> cache </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">ConcurrentHashMap</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token class-name">CachingRouteLocator</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">RouteLocator</span><span class="token plain"> delegate</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">delegate </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> delegate</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        routes </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name">CacheFlux</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">lookup</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cache</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> CACHE_KEY</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">Route</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">class</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">onCacheMissResume</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">this</span><span class="token operator" style="color:#393A34">::</span><span class="token function" style="color:#d73a49">fetch</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">private</span><span class="token plain"> </span><span class="token class-name">Flux</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">Route</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">fetch</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">delegate</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getRoutes</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">sort</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">AnnotationAwareOrderComparator</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">INSTANCE</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>Cacheì— Routeë“¤ì´ ë‹´ê¸°ê²Œ ëœë‹¤.</p><p><img loading="lazy" alt="Untitled" src="/assets/images/Untitled 5-13c825c1eadeb1ce8b242c1ac296ae41.png" width="1049" height="365" class="img_E7b_"></p><h3 class="anchor anchorWithStickyNavbar_mojV" id="ê·¸ë¦¬ê³ -ë§ˆì§€ë§‰ìœ¼ë¡œ-ìµœì´ˆ-ì‹œì‘ì ì¸-gatewayautoconfiguration">ê·¸ë¦¬ê³  ë§ˆì§€ë§‰ìœ¼ë¡œ ìµœì´ˆ ì‹œì‘ì ì¸ GatewayAutoConfiguration<a class="hash-link" href="#ê·¸ë¦¬ê³ -ë§ˆì§€ë§‰ìœ¼ë¡œ-ìµœì´ˆ-ì‹œì‘ì ì¸-gatewayautoconfiguration" title="Direct link to heading">â€‹</a></h3><p>Gatewayì˜ Route ë“± ê°ì¢… configë“¤ì„ ì„¤ì •í•œë‹¤.</p><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token annotation punctuation" style="color:#393A34">@Configuration</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">proxyBeanMethods </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token annotation punctuation" style="color:#393A34">@ConditionalOnProperty</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">name </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"spring.cloud.gateway.enabled"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> matchIfMissing </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token annotation punctuation" style="color:#393A34">@EnableConfigurationProperties</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token annotation punctuation" style="color:#393A34">@AutoConfigureBefore</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token class-name">HttpHandlerAutoConfiguration</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">class</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">WebFluxAutoConfiguration</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token annotation punctuation" style="color:#393A34">@AutoConfigureAfter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token class-name">GatewayReactiveLoadBalancerClientAutoConfiguration</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">class</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">GatewayClassPathWarningAutoConfiguration</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token annotation punctuation" style="color:#393A34">@ConditionalOnClass</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">DispatcherHandler</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">class</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">GatewayAutoConfiguration</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token annotation punctuation" style="color:#393A34">@Bean</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token annotation punctuation" style="color:#393A34">@Primary</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token annotation punctuation" style="color:#393A34">@ConditionalOnMissingBean</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">name </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"cachedCompositeRouteLocator"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token class-name">RouteLocator</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">cachedCompositeRouteLocator</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">List</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">RouteLocator</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> routeLocators</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token class-name">CachingRouteLocator</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">CompositeRouteLocator</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">Flux</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">fromIterable</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">routeLocators</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p><code>cachedCompositeRouteLocator</code> ì„¤ì •í•œ roteLocator(java, yaml)ë“¤ì´ ë‹´ê¸°ê²Œ ëœë‹¤. </p><p><img loading="lazy" alt="Untitled" src="/assets/images/Untitled 6-a002a2368847cac2e7746d6b93736cf0.png" width="1002" height="379" class="img_E7b_"></p><h3 class="anchor anchorWithStickyNavbar_mojV" id="ê²°ë¡ ">ê²°ë¡ <a class="hash-link" href="#ê²°ë¡ " title="Direct link to heading">â€‹</a></h3><p>ê°œì¸ì ìœ¼ë¡œëŠ” yamlìœ¼ë¡œ ì„¤ì •í•˜ê¸°ë³´ë‹¤ëŠ” <strong>Java Config</strong>ë¡œ ì„¤ì •í•˜ëŠ” ê²Œ ì¢‹ë‹¤ê³  ë´…ë‹ˆë‹¤.<br>
<!-- -->Yaml ì„¤ì •í•˜ë©´ ê°„ë‹¨í•˜ê²Œ ì„¤ì • í•  ìˆ˜ ìˆëŠ” ë°˜ë©´ì—, IDEì˜ ë„ì›€ì„ ë°›ê¸° í˜ë“¤ê³ , ì˜¤íƒ€, yaml ë¼ì¸ì´ ë‹¤ë¥¸ ê²½ìš°ë‚˜ yaml ë¬¸ë²• ì—ëŸ¬ ë°œìƒ ë“± ì •ë§ ëˆ„êµ¬ë‚˜ í•  ìˆ˜ ìˆëŠ” ì‹¤ìˆ˜ì¸ë°, ë§Œì•½ ì¸ì§€ë¥¼ ëª»í•˜ê³  Productë¡œ ë°°í¬ê°€ ë˜ë©´ ì¥ì• ê°€ ë°œìƒí•©ë‹ˆë‹¤.<br>
<!-- -->ë˜í•œ ê²Œì´íŠ¸ì›¨ì´ë‹¤ë³´ ë‹ˆ ê²Œì´íŠ¸ì›¨ì´ ë’¤ë¡œ íë¥´ëŠ” ëª¨ë“  applicationë“¤ì´ íë¥¼ ìˆ˜ ì—†ê²Œ ë˜ì–´ ì¹˜ëª…ì ì¸ ì¥ì• ê°€ ë°œìƒí•  ìˆ˜ ìˆìœ¼ë‹ˆ Production í™˜ê²½ì—ì„œëŠ” Java Configë¡œ ì„¤ì •ì„ í•˜ëŠ” ê±¸ ì¶”ì²œë“œë¦½ë‹ˆë‹¤.  </p><h3 class="anchor anchorWithStickyNavbar_mojV" id="í›„ê¸°">í›„ê¸°<a class="hash-link" href="#í›„ê¸°" title="Direct link to heading">â€‹</a></h3><p>ìš”ì¦˜ ë‚´ë¶€ êµ¬í˜„ì„ ë§ì´ ê¹Œ ë³´ë©´ì„œ, ë‚´ê°€ í•„ìš”í•œ ë¶€ë¶„ë“¤ì„ ë”°ë¡œ ë¹¼ì„œ ì»¤ìŠ¤í…€í•´ì„œ ì“°ëŠ” ì¼ì´ ëª‡ ë²ˆ í•˜ë‹¤ë³´ë‹ˆ, ì§€ê¸ˆë„ ë§ˆì°¬ê°€ì§€ì§€ë§Œ ì˜ˆì „ì—ëŠ” ì§„ì§œ ë§‰ ì¼ì—ˆêµ¬ë‚˜ë¼ê³  ë‹¤ì‹œê¸ˆ ë§ì´ ëŠë¼ê³  ê·¸ëŸ¬ë©´ì„œ ìš”ì¦˜  ìŠ¤í”„ë§ê³¼ 1cm ì •ë„ ê±°ë¦¬ê°€ ê°€ê¹Œì›Œì¡Œë‹¤ëŠ” ê±¸ ëŠë¼ë©´ì„œ <del>ë¬¼ë¡  ê·¸ëŸ¬ë©´ì„œ ë¨¸ë¦¬ê°€ ë¹ ì§„...</del> ê°œì¸ì ìœ¼ë¡œ <strong>ì„±ì¥</strong>í•˜ê³  ìˆëŠ” ê±¸ ë§ì´ ëŠë¼ê³  ìˆë‹¤.</p><p>ì°¸ê³ <br>
<a href="https://docs.spring.io/spring-cloud-gateway/docs/current/reference/html/" target="_blank" rel="noopener noreferrer">https://docs.spring.io/spring-cloud-gateway/docs/current/reference/html/</a><br>
<a href="https://blog.jungbin.kim/spring/2021/02/27/spring-cloud-gateway-route-locator.html" target="_blank" rel="noopener noreferrer">https://blog.jungbin.kim/spring/2021/02/27/spring-cloud-gateway-route-locator.html</a><br>
<a href="https://www.baeldung.com/spring-cloud-gateway#spring-cloud-discoveryclient-support" target="_blank" rel="noopener noreferrer">https://www.baeldung.com/spring-cloud-gateway#spring-cloud-discoveryclient-support</a><br>
<a href="https://dlsrb6342.github.io/2019/05/14/spring-cloud-gateway-%EA%B5%AC%EC%A1%B0/" target="_blank" rel="noopener noreferrer">https://dlsrb6342.github.io/2019/05/14/spring-cloud-gateway-êµ¬ì¡°/</a></p>]]></content>
        <author>
            <name>Dongle</name>
            <uri>https://github.com/sk1737030</uri>
        </author>
        <category label="SCG" term="SCG"/>
        <category label="Spring Cloud Gateway" term="Spring Cloud Gateway"/>
        <category label="Route" term="Route"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[ê¹Œë¨¹ì–´ì„œ ë‹¤ì‹œ ë³´ëŠ” Generic]]></title>
        <id>generic</id>
        <link href="https://dgle.dev/generic"/>
        <updated>2022-05-07T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[ê¹Œë¨¹ì–´ì„œ ë‹¤ì‹œ ì°¾ì•„ë³´ëŠ” ì œë„¤ë¦­]]></summary>
        <content type="html"><![CDATA[<p>ì œë„¤ë¦­ì„ ì‚¬ìš©í•˜ëŠ”ë°, í—·ê°ˆë ¤ì„œ ë‹¤ì‹œ ê³µë¶€ í•  ê²¸ ì •ë¦¬</p><p>ëª¨ë“  ì†ŒìŠ¤ëŠ” <a href="https://github.com/sk1737030/til/tree/master/til-generic/src" target="_blank" rel="noopener noreferrer">ì´ê³³ì—ì„œ</a> í™•ì¸ ê°€ëŠ¥ í•©ë‹ˆë‹¤!</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="generic-ì œë„¤ë¦­-ì§€ë„¤ë¦­-ì¤´ë„¤ë¦­">Generic ì œë„¤ë¦­ ì§€ë„¤ë¦­ ì¤´ë„¤ë¦­<a class="hash-link" href="#generic-ì œë„¤ë¦­-ì§€ë„¤ë¦­-ì¤´ë„¤ë¦­" title="Direct link to heading">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_mojV" id="ì œë„¤ë¦­ì´ë€">ì œë„¤ë¦­ì´ë€???<a class="hash-link" href="#ì œë„¤ë¦­ì´ë€" title="Direct link to heading">â€‹</a></h3><p>JDK 1.5ì— ë„ì…ëœ <code>ì»´íŒŒì¼</code> ì‹œì— ë¯¸ë¦¬ íƒ€ì…ì„ ì§€ì •í•´ì„œ, ëŸ°íƒ€ì„ì‹œì— ì˜¤ë¥˜ë¥¼ ì¤„ì´ê³  íƒ€ì… ê²€ì‚¬ë‚˜ íƒ€ì… ë³€í™˜ê³¼ ê°™ì€ ë²ˆê±°ë¡œìš´ ì‘ì—…ì„ ìƒëµí•  ìˆ˜ ìˆëŠ” íƒ€ì… ê²€ì‚¬ë¥¼ ë„ì™€ì£¼ëŠ” <strong>ê°“ê°“ë¬¸ë²•</strong>ì´ë‹¤.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="ê·¸ë ‡ë‹¤ë©´-ì™œ-ë‚˜ì™”ì„ê¹Œ">ê·¸ë ‡ë‹¤ë©´ ì™œ ë‚˜ì™”ì„ê¹Œ??<a class="hash-link" href="#ê·¸ë ‡ë‹¤ë©´-ì™œ-ë‚˜ì™”ì„ê¹Œ" title="Direct link to heading">â€‹</a></h3><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// ë¬¸ì œì˜ ì½”ë“œ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token class-name">List</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">Object</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> list </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">ArrayList</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">before</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">add</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"pub"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">before</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">add</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"dog"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">before</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">add</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">Object</span><span class="token plain"> o </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> before</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">String</span><span class="token plain"> substring </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">String</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> o</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">substring</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Runtime Error</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">System</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">out</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">substring</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>list ì•ˆì— ì–´ë– í•œ íƒ€ì…ì´ë¼ë„ ë“¤ì–´ê°ˆ ìˆ˜ ìˆê²Œ ë¼ì„œ, ì»´íŒŒì¼ ì‹œì— ì—ëŸ¬ë¥¼ ì•Œ ìˆ˜ê°€ ì—†ê³ , ê·¸ëŸ¬ë‹¤ ë³´ë‹ˆ ëŸ°íƒ€ì„ì‹œì— ì—ëŸ¬ê°€ ë°œìƒì„ í•˜ê²Œ ë˜ê³ , ê°œë°œ í•  ë•Œì—ë„ ë”ìš± ë¶ˆí¸í•œ ê±´ í•­ìƒ íƒ€ì…ì²´í¬ë¥¼ í•˜ê³  castingì„ í•´ì•¼ ì—¬ëŸ¬ ë©”ì†Œë“œë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ ëœë‹¤. </p><h3 class="anchor anchorWithStickyNavbar_mojV" id="í”í•œ--generic-ì‚¬ìš©">í”í•œ  Generic ì‚¬ìš©<a class="hash-link" href="#í”í•œ--generic-ì‚¬ìš©" title="Direct link to heading">â€‹</a></h3><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">Main</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">static</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">String</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> args</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">List</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">String</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> list </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">ArrayList</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// 1.7 ì´í›„ì—ì„œëŠ” íƒ€ì… ì¶”ë¡ ì´ ê°€ëŠ¥í•´ì„œ ë’¤ì— íƒ€ì…ì€ ìƒëµì´ ê°€ëŠ¥í•˜ë‹¤.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        list</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">add</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"pub"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        list</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">add</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"dog"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        list</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">add</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Complie Error</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">String</span><span class="token plain"> s </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> list</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token class-name">String</span><span class="token plain"> substring </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> s</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">substring</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token class-name">System</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">out</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">substring</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>íƒ€ì…ì„ <code>ì²´í¬</code>í•  í•„ìš”ë„ ì—†ê³  <code>ìºìŠ¤íŒ…</code> í•  í•„ìš”ë„ ì—†ì–´ì§„ë‹¤.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="ì¡°ê¸ˆ-ë”">ì¡°ê¸ˆ ë”<a class="hash-link" href="#ì¡°ê¸ˆ-ë”" title="Direct link to heading">â€‹</a></h3><p>Dog Sitter(ì§‘ì‚¬) ê°•ì•„ì§€ ì§‘ì‚¬ê°€ ê°„ì‹ì„ ì¤€ë‹¤ê³  í–ˆì„ ë•Œ </p><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">Animal</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">Dog</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">extends</span><span class="token plain"> </span><span class="token class-name">Animal</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">Pug</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">extends</span><span class="token plain"> </span><span class="token class-name">Dog</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">Siba</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">extends</span><span class="token plain"> </span><span class="token class-name">Dog</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">Sitter</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">giveSnack</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">House</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">Dog</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> house</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">Snack</span><span class="token plain"> snack</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ì»´íŒŒì¼ ì—ëŸ¬ë‚˜ëŠ” ìƒí™©  </p><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token class-name">Pug</span><span class="token plain"> pug </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Pug</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token class-name">Dog</span><span class="token plain"> dog </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pug</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token class-name">System</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">out</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">pug</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getClass</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// class generic.animal.Pug</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token class-name">System</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">out</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">dog</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getClass</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// class generic.animal.Pug</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token class-name">Sitter</span><span class="token plain"> sitter </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Sitter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token class-name">House</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">Pug</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> pugHouse </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">House</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sitter</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">giveSnack</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">pugHouse</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Snack</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// ì»´íŒŒì¼ error!</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><ul><li>ë§¤ìš°.. í—·ê°ˆë¦¬ì§€ë§Œ ì¡°ê¸ˆ ë” ìƒê°í•´ë³´ë©´ ì»´íŒŒì¼ ì—ëŸ¬ê°€ ë‚˜ëŠ” ì´ìœ ëŠ” ë‹¹ì—°í•˜ë‹¤. ë§Œì•½ ì»´íŒŒì¼ ì—ëŸ¬ê°€ ì•ˆ ë‚œë‹¤ê³  ê°€ì •ì„ í•´ë³´ë©´</li></ul><p>if ì»´íŒŒì¼ errorê°€ ì•„ë‹ˆë¼ë©´ !</p><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token class-name">Sitter</span><span class="token plain"> sitter </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Sitter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token class-name">House</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">Pug</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> pugHouse </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">House</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token class-name">House</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">Siba</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> sibaHouse </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">House</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sitter</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">giveSnack</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">pugHouse</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Snack</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// ì»´íŒŒì¼ errorê°€ ì•„ë‹ˆë¼ë©´!</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sitter</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">giveSnack</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">sibaHouse</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Snack</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// ì»´íŒŒì¼ errorê°€ ì•„ë‹ˆë¼ë©´!</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><ul><li>ì´ë ‡ê²Œ Dogì„ ìƒì†í–ˆì§€ë§Œ ë‘ ê°€ì§€ì˜ ë‹¤ë¥¸ íƒ€ì…ì´ ë“¤ì–´ê°ˆ ìˆ˜ ìˆê²Œ ë˜ëŠ” ìƒí™©ì´ ë°œìƒí•œë‹¤.<!-- -->  <strong>ì–´ ì•„ë‹ˆ? ê·¸ë˜ì„œ ë­ê°€ ë¬¸ì œì•¼ Dogë¥¼ ìƒì†í•œ pugì™€ siba ê°€ì•™ì§€ë“¤ì´ ë“¤ì–´ ê°ˆ ìˆ˜ ìˆëŠ”ê±° ì•„ë‹ˆì•¼!????</strong></li></ul><p><img loading="lazy" alt="Untitled" src="/assets/images/Untitled-f9640314906eaaa3bcd76bde4351df2a.png" width="466" height="1024" class="img_E7b_">  </p><p>ë§Œì•½ ì €ê²Œ í—ˆìš©ì´ ëœë‹¤ê³  ê°€ì • í–ˆì„ ë•Œì˜ ë¬¸ì œê°€ ë˜ëŠ” ë¶€ë¶„ì„ ì½”ë“œë¡œ ë³¸ë‹¤ë©´ </p><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">House</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">T</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">implements</span><span class="token plain"> </span><span class="token class-name">Iterable</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">List</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">T</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> lists </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">ArrayList</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">add</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">T</span><span class="token plain"> t</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        lists</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">add</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">t</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token class-name">T</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> i</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> lists</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token annotation punctuation" style="color:#393A34">@Override</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token class-name">Iterator</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">iterator</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> lists</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">iterator</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token annotation punctuation" style="color:#393A34">@Override</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">forEach</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">Consumer</span><span class="token plain"> action</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">Iterable</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">super</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">forEach</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">action</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token annotation punctuation" style="color:#393A34">@Override</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token class-name">Spliterator</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">spliterator</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token class-name">Iterable</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">super</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">spliterator</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token class-name">House</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">Pug</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> pugHouse </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">House</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token class-name">House</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">Siba</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> sibaHouse </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">House</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token class-name">House</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">Dog</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> dogHouse </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">House</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dogHouse</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">add</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">pugHouse</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Compile Error</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dogHouse</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">add</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">sibaHouse</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Compile Error</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">for</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">Dog</span><span class="token plain"> dog</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> dogHouse</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ì•„ê¹Œ 1.5 ì´ì „ì— ë³´ì•˜ë˜ ë¹„ìŠ·í•œ ë¬¸ì œê°€ ì˜¤ë¥¸ìª½ì˜ ì½”ë“œì—ì„œ ìƒê¸°ê²Œ ëœë‹¤. </p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>ê·¸ë ‡ë‹¤ë©´ ì™œ ìë°”ëŠ”  raw typeì„ í—ˆìš©í–ˆì„ê¹Œ?</h5></div><div class="admonition-content"><p><code>List list = new ArrayList&lt;&gt;()</code>ê°€ ë˜ëŠ” ì´ìœ ëŠ” í˜¸í™˜ì„± ë•Œë¬¸ì´ë‹¤. ìë°”ê°€ ì œë„¤ë¦­ì„ ë°›ì•„ë“¤ì´ê¸°ê¹Œì§€ ê±°ì˜ 10ë…„ì´ ê±¸ë¦° íƒ“ì— ì œë„¤ë¦­ ì—†ì´ ì§  ì½”ë“œê°€ ì´ë¯¸ ì„¸ìƒì„ ë’¤ë®ì–´ ë²„ë ¸ë‹¤. ê·¸ë˜ì„œ ê¸°ì¡´ ì½”ë“œë¥¼ ëª¨ë‘ ìˆ˜ìš©í•˜ë©´ì„œ ì œë„¤ë¦­ì„ ì‚¬ìš©í•˜ëŠ” ìƒˆë¡œìš´ ì½”ë“œì™€ë„ ë§ë¬¼ë ¤ ëŒì•„ê°€ê²Œ í•´ì•¼ë§Œ í–ˆë‹¤. raw íƒ€ì…ì„ ì‚¬ìš©í•˜ëŠ” ë©”ì„œë“œì— ë§¤ê°œ ë³€ìˆ˜í™” íƒ€ì…ì˜ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë„˜ê²¨ë„ ë™ì‘í•´ì•¼ë§Œ í–ˆë˜ ê²ƒì´ë‹¤.</p></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="ë¬´ë³€ì„±-invariant"><a href="https://stackoverflow.com/questions/8902331/what-is-a-class-invariant-in-java" target="_blank" rel="noopener noreferrer">ë¬´ë³€ì„± (invariant)</a><a class="hash-link" href="#ë¬´ë³€ì„±-invariant" title="Direct link to heading">â€‹</a></h3><p>Aê°€ Bì˜ ìƒìœ„ íƒ€ì…ì¼ ë•Œ <code>GenericType&lt;A&gt;</code>ê°€ <code>GenericType&lt;B&gt;</code> ì˜ ìƒìœ„ íƒ€ì…ì´ ì•„ë‹ˆë©´ ë³€ì„±ì´ ì—†ë‹¤.
ë‹¤ë¥¸ ì½”ë“œë“¤ì´ ë­˜ í•˜ë“  ê°„ì—, í´ë˜ìŠ¤ì˜ ëª¨ë“  ì¸ìŠ¤í„´ìŠ¤ì— ëŒ€í•´ ìœ ì§€ë˜ëŠ” ì†ì„±ì´ë‹¤.  </p><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token class-name">Animal</span><span class="token plain"> animal </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Pug</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token class-name">House</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">Animal</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> dogHouse </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">House</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">Dog</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Compile Error </span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p><code>House&lt;Animal&gt;</code> ì€ <code>House&lt;Dog&gt;</code> ì˜ ìƒìœ„ íƒ€ì…ì´ ì•„ë‹ˆë‹¤. ì•„ë‹ˆë‹ˆê¹Œ ì†ì„±ì´ ìœ ì§€ë  ìˆ˜ ì—†ë‹¤.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="ê³µë³€-covariant"><strong><a href="https://www.javatpoint.com/covariant-return-type" target="_blank" rel="noopener noreferrer">ê³µë³€ (covariant)</a></strong><a class="hash-link" href="#ê³µë³€-covariant" title="Direct link to heading">â€‹</a></h3><p>ìš°ë¦¬ê°€ <del>(ê·¸ë‚˜ë§ˆ ë‚˜ì—ê²Œ)</del> ê°€ì¥ í”í•˜ê²Œ ì“°ëŠ” í˜•íƒœì´ì§€ ì•Šì„ê¹Œ ì‹¶ë‹¤. ìƒìœ„íƒ€ì…ì—ì„œ ë¬¼ íë¥´ë“¯ì´ í•˜ìœ„íƒ€ì…ì˜ ë°©í–¥ìœ¼ë¡œ ì½”ë“œë¥¼ ì‚¬ìš©í•  ë•Œì´ë‹¤.  </p><ul><li><p>Aê°€ Bì˜ ìƒìœ„ íƒ€ì…ì´ê³  <code>T&lt;A&gt;</code>ê°€ <code>T&lt;B&gt;</code>ì˜ ìƒìœ„ íƒ€ì…ì´ë©´ ê³µë³€ì´ë¼ í•œë‹¤.</p><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">Sitter</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">giveSnack</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">House</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics operator" style="color:#393A34">?</span><span class="token generics"> </span><span class="token generics keyword" style="color:#00009f">extends</span><span class="token generics"> </span><span class="token generics class-name">Dog</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> dog</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token class-name">Snack</span><span class="token plain"> snack</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">List</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics operator" style="color:#393A34">?</span><span class="token generics"> </span><span class="token generics keyword" style="color:#00009f">extends</span><span class="token generics"> </span><span class="token generics class-name">Dog</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> all </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> dog</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getAll</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// ê³µë³€</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token class-name">Sitter</span><span class="token plain"> covariant </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Sitter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token class-name">House</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">Pug</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> pug2 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">House</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">covariant</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">giveSnack</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">pug2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Snack</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token class-name">House</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">Siba</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> siba2 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">House</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">covariant</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">giveSnack</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">siba2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Snack</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></li><li><p>ë¬¸ì œì </p><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token class-name">House</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">Pug</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> pug </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">House</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token class-name">House</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics operator" style="color:#393A34">?</span><span class="token generics"> </span><span class="token generics keyword" style="color:#00009f">extends</span><span class="token generics"> </span><span class="token generics class-name">Dog</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> dogHouse </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pug</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// dogHouse.push(new Pug()); // Compile Error</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">House</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">T</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">implements</span><span class="token plain"> </span><span class="token class-name">Iterable</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">List</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">T</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> lists </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">ArrayList</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">push</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">T</span><span class="token plain"> pug</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        lists</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">add</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">pug</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></li></ul><h3 class="anchor anchorWithStickyNavbar_mojV" id="ë°˜ê³µë³€contravariant"><a href="https://codechacha.com/ko/java-covariance-and-contravariance/" target="_blank" rel="noopener noreferrer">ë°˜ê³µë³€(contravariant)</a><a class="hash-link" href="#ë°˜ê³µë³€contravariant" title="Direct link to heading">â€‹</a></h3><ul><li><p>Aê°€ Bì˜ ìƒìœ„ íƒ€ì…ì´ê³  <code>T&lt;A&gt;</code>ê°€ <code>T&lt;B&gt;</code>ì˜ í•˜ìœ„ íƒ€ì…ì´ë©´ ë°˜ê³µë³€ì´ë¼í•œë‹¤.  </p><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// ë°˜ê³µë³€</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token class-name">House</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">Pug</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> pug </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">House</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token class-name">House</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics operator" style="color:#393A34">?</span><span class="token generics"> </span><span class="token generics keyword" style="color:#00009f">super</span><span class="token generics"> </span><span class="token generics class-name">Pug</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> pugh </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pug</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token class-name">House</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">Dog</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> dog </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">House</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token class-name">House</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics operator" style="color:#393A34">?</span><span class="token generics"> </span><span class="token generics keyword" style="color:#00009f">super</span><span class="token generics"> </span><span class="token generics class-name">Pug</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> pughh </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> dog</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></li><li><p>ë°˜ê³µë³€ì€ ë°˜ëŒ€ë¡œ Getì„ í•  ë•Œ ì»´íŒŒì¼ ì—ëŸ¬ê°€ ë°œìƒí•œë‹¤.  </p><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// ë°˜ê³µë³€</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token class-name">House</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">Dog</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> dog </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">House</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token class-name">House</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics operator" style="color:#393A34">?</span><span class="token generics"> </span><span class="token generics keyword" style="color:#00009f">super</span><span class="token generics"> </span><span class="token generics class-name">Dog</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> pugh </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> dog</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pugh</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">push</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Pug</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pugh</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">push</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Dog</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Pug housePug = pugh.get(0); // Compile Error</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token class-name">House</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">Pug</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> pug </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">House</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token class-name">House</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics operator" style="color:#393A34">?</span><span class="token generics"> </span><span class="token generics keyword" style="color:#00009f">super</span><span class="token generics"> </span><span class="token generics class-name">Pug</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> pugh2 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pug</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pugh2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">push</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Pug</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// pugh2.push(new Dog()); // Compile Error</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Pug housePug = pugh2.get(0); // Compile Error</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></li></ul><p>ì—ëŸ¬ê°€ ë°œìƒí•˜ëŠ” ì´ìœ ëŠ” ë‹¹ì—°í•œë° ì¡°ê¸ˆë§Œ ë” ê³°ê³°ì´ ìƒê°í•´ë³´ë©´, <del>ì‚¬ì‹¤ ìƒê°í•´ë´ë„ ì–´ë µë‹¤</del> getìœ¼ë¡œ ê°€ì ¸ì˜¬ ë•Œ return ê°’ì´ Pugì¼ ìˆ˜ë„ ìˆê³ , Pug ìœ„ì— ìƒìœ„ê°ì²´ê°€ ì˜¬ ìˆ˜ ìˆì–´ì„œ ì—ëŸ¬ê°€ ë‚  ìˆ˜ë°–ì— ì—†ë‹¤.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="java-ì½”ë“œì—-ë°˜ê³µë³€-ë³¼-ìˆ˜-ìˆëŠ”-ê³³">Java ì½”ë“œì— ë°˜ê³µë³€ ë³¼ ìˆ˜ ìˆëŠ” ê³³<a class="hash-link" href="#java-ì½”ë“œì—-ë°˜ê³µë³€-ë³¼-ìˆ˜-ìˆëŠ”-ê³³" title="Direct link to heading">â€‹</a></h3><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">Collecitons</span><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">static</span><span class="token plain"> </span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">T</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">copy</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">List</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics operator" style="color:#393A34">?</span><span class="token generics"> </span><span class="token generics keyword" style="color:#00009f">super</span><span class="token generics"> </span><span class="token generics class-name">T</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> dest</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">List</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics operator" style="color:#393A34">?</span><span class="token generics"> </span><span class="token generics keyword" style="color:#00009f">extends</span><span class="token generics"> </span><span class="token generics class-name">T</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> src</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token class-name">List</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">Integer</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> src </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">ArrayList</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token class-name">List</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">Number</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> dest </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">ArrayList</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token class-name">Collections</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">copy</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">dest</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> src</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p><img loading="lazy" alt="Untitled" src="/assets/images/Untitled 1-38c31ff77e69f53c23738e58c4c4ca2f.png" width="646" height="140" class="img_E7b_"></p><h3 class="anchor anchorWithStickyNavbar_mojV" id="íƒ€ì…-ì œê±°-ì‹œê¸°">íƒ€ì… ì œê±° ì‹œê¸°<a class="hash-link" href="#íƒ€ì…-ì œê±°-ì‹œê¸°" title="Direct link to heading">â€‹</a></h3><p>ìë°” ì½”ë“œì—ì„œ ì„ ì–¸ë˜ê³  ì‚¬ìš©ëœ ì œë„¤ë¦­ íƒ€ì…ì€ ì»´íŒŒì¼ ì‹œ ì»´íŒŒì¼ëŸ¬ì— ì˜í•´ ìë™ìœ¼ë¡œ ê²€ì‚¬ë˜ì–´ íƒ€ì… ë³€í™˜ëœë‹¤. ê·¸ í›„ì— ì½”ë“œ ë‚´ì˜ ëª¨ë“ &nbsp;ì œë„¤ë¦­ íƒ€ì…ì€ ì œê±°ë˜ì–´, ì»´íŒŒì¼ëœ class íŒŒì¼ì—ëŠ” ì–´ë– í•œ ì œë„¤ë¦­ íƒ€ì…ë„ í¬í•¨ë˜ì§€ ì•Šê²Œ ëœë‹¤. ì´ëŸ° ì‹ìœ¼ë¡œ ë™ì‘í•˜ëŠ” ì´ìœ ëŠ”&nbsp;ì œë„¤ë¦­ì„ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ì½”ë“œì™€ì˜ í˜¸í™˜ì„±ì„ ìœ ì§€í•˜ê¸° ìœ„í•´ì„œì´ë‹¤.  </p><p>ì¶œì²˜<br>
<a href="https://docs.oracle.com/javase/tutorial/java/generics/types.html" target="_blank" rel="noopener noreferrer">https://docs.oracle.com/javase/tutorial/java/generics/types.html</a><br>
<a href="http://www.tcpschool.com/java/java_generic_concept" target="_blank" rel="noopener noreferrer">http://www.tcpschool.com/java/java_generic_concept</a><br>
<a href="https://www.youtube.com/watch?v=PtM44sO-A6g" target="_blank" rel="noopener noreferrer">https://www.youtube.com/watch?v=PtM44sO-A6g</a><br>
<a href="http://www.yes24.com/Product/Goods/65551284" target="_blank" rel="noopener noreferrer">Effective Java</a><br>
<a href="https://stackoverflow.com/questions/8902331/what-is-a-class-invariant-in-java" target="_blank" rel="noopener noreferrer">https://stackoverflow.com/questions/8902331/what-is-a-class-invariant-in-java</a> ë¬´ë³€ì„±ì´ë€<br>
<a href="https://codechacha.com/ko/java-covariance-and-contravariance/" target="_blank" rel="noopener noreferrer">https://codechacha.com/ko/java-covariance-and-contravariance/</a></p>]]></content>
        <author>
            <name>Dongle</name>
            <uri>https://github.com/sk1737030</uri>
        </author>
        <category label="Java" term="Java"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Container í™˜ê²½ì—ì„œì˜ JVM GC]]></title>
        <id>container-gc</id>
        <link href="https://dgle.dev/container-gc"/>
        <updated>2022-05-02T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[ì»¨í…Œì´ë„ˆ í™˜ê²½ì—ì„œì˜ JVM GCëŠ” ë¬´ì—‡ì´ ì„ íƒë ê¹Œ?]]></summary>
        <content type="html"><![CDATA[<p>ë‹¹ì—°íˆ ìš°ë¦¬ì˜ ì• í”Œë¦¬ì¼€ì´ì…˜ GCëŠ” ë‹¹ì—°íˆ G1GCë¥¼ ì“°ê³  ìˆê² ì§€ë¼ê³  í•œì¹˜ì˜ ì˜ì‹¬ ì—†ì´ ìƒê°ì„ í–ˆì—ˆë‹¤. ì•„ë‹ˆ ì ì–´ë„ Jdk 11ì„ ì‚¬ìš©í•˜ë©´ì„œ GCë¥¼ zgc vs g1gcë¥¼ ë­˜ ì¨ì•¼ ë” ì¢‹ì„ê¹Œ ì´ëŸ° ìƒê°ë§Œ í–ˆì—ˆì§€ ì„¤ë§ˆ <strong>G1GC vs Serial&nbsp;Collector</strong>ë¥¼ ê³ ë¯¼ì„ í•˜ê³  ìˆì„ ì¤„ì´ì•¼! ê¿ˆì—ì„œë„ ìƒê°ì„ ëª»í–ˆë‹¤. ê²°ë¡ ë¶€í„° ë§í•˜ìë©´ Container í™˜ê²½ì—ì„œ Cpuì™€ ë©”ëª¨ë¦¬ì— ë”°ë¼ì„œ GCì„ íƒì´ g1gcê°€ ë  ìˆ˜ë„ ìˆê³  ì•„ë‹ ìˆ˜ë„ ìˆë‹¤.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="jdk-11ì˜-gcëŠ”-ë¬´ì¡°ê±´-g1gcì£ ">Jdk 11ì˜ GCëŠ” ë¬´ì¡°ê±´ G1GCì£ !<a class="hash-link" href="#jdk-11ì˜-gcëŠ”-ë¬´ì¡°ê±´-g1gcì£ " title="Direct link to heading">â€‹</a></h2><p>ë‹¹ì—°íˆ ìš°ë¦¬ì˜ ì• í”Œë¦¬ì¼€ì´ì…˜ GCëŠ” ë‹¹ì—°íˆ G1GCë¥¼ ì“°ê³  ìˆê² ì§€ë¼ê³  í•œì¹˜ì˜ ì˜ì‹¬ ì—†ì´ ìƒê°ì„ í–ˆì—ˆë‹¤. ì•„ë‹ˆ ì ì–´ë„ Jdk 11ì„ ì‚¬ìš©í•˜ë©´ì„œ GCë¥¼ zgc vs g1gcë¥¼ ë­˜ ì¨ì•¼ ë” ì¢‹ì„ê¹Œ ì´ëŸ° ìƒê°ë§Œ í–ˆì—ˆì§€ ì„¤ë§ˆ <strong>G1GC vs Serial&nbsp;Collector</strong>ë¥¼ ê³ ë¯¼ì„ í•˜ê³  ìˆì„ ì¤„ì´ì•¼! ê¿ˆì—ì„œë„ ìƒê°ì„ ëª»í–ˆë‹¤. ê²°ë¡ ë¶€í„° ë§í•˜ìë©´ Container í™˜ê²½ì—ì„œ Cpuì™€ ë©”ëª¨ë¦¬ì— ë”°ë¼ì„œ GCì„ íƒì´ g1gcê°€ ë  ìˆ˜ë„ ìˆê³  ì•„ë‹ ìˆ˜ë„ ìˆë‹¤.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="ë°œë‹¨">ë°œë‹¨<a class="hash-link" href="#ë°œë‹¨" title="Direct link to heading">â€‹</a></h3><p>ì¼ë‹¨ ìš°ë¦¬ëŠ” í”í•˜ë”” í”í•œ <code>Kubernate</code>ì˜ ë©‹ìˆëŠ” ì˜¤ì¼€ìŠ¤íŠ¸ë¼ë¥¼ ì—°ì£¼ë¥¼ í•˜ë©° <code>Container</code>í™˜ê²½ì—ì„œ appì„ ë°°í¬í•˜ê³  ê´€ë¦¬í•˜ê³  ìˆë‹¤. ì–´ëŠë‚  Slackì— í¬ë£¨ ì¤‘ ëˆ„êµ°ê°€ê°€ ìš°ë¦¬ ë‹¹ì—°íˆ g1gc ì“°ê³  ìˆì£ ? ë¼ê³  ì˜¬ë¼ì™€ì„œ ë‚˜ëŠ” ì—¥? ë‹¹ì—°í•œ ê±° ì•„ë‹Œê°€ë¼ê³  ìƒê°ì„ í•˜ê³  ë‹¤ë¥¸ ì¼ì„ í–ˆëŠ”ë° ë‹¤ë¥¸ í¬ë£¨ê°€ ìš°ë¦¬ <strong>Serial&nbsp;Collector</strong> ì¸ ê±° ê°™ì€ë°ìš”??? ë¼ê³  ë‹µì¥ì„ ë‹¬ì•˜ë‹¤.  </p><p><img loading="lazy" alt="ì•„ë‹ˆ ì´ê²Œ ë­” ê°œ ì†Œë¦¬ì•¼!" src="/assets/images/Untitled-1da7573e785643ce48b7c5d578a645bc.png" width="236" height="213" class="img_E7b_">  </p><h3 class="anchor anchorWithStickyNavbar_mojV" id="ì •ë§ì¼ê¹Œ">ì •ë§ì¼ê¹Œ?<a class="hash-link" href="#ì •ë§ì¼ê¹Œ" title="Direct link to heading">â€‹</a></h3><p>ë‚˜ëŠ” ìš°ë¦¬ jdk11 ë²„ì „ ì“°ëŠ”ë°? ê·¸ëŸ´ ë¦¬ê°€ ìˆì–´? ì—ì´ ì˜ëª» ë´¤ê² ì§€ë¼ê³  ìƒê°ì„ í•˜ê³  ì¢‹ì•„ ë‚´ ëˆˆìœ¼ë¡œ í™•ì¸ì„ í•´ë´ì•¼ì§€ë¼ë©° containerì—  ë“¤ì–´ê°€ì„œ í™•ì¸ì„ í•´ ë´¤ëŠ”ë°</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> java -XX:+PrintCommandLineFlags -version</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Picked up JAVA_TOOL_OPTIONS:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-XX:+SegmentedCodeCache </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-XX:+UseCompressedClassPointers </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-XX:+UseCompressedOops </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">**-XX:+UseSerialGC** </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">openjdk version </span><span class="token string" style="color:#e3116c">"11.0.13"</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2021</span><span class="token plain">-10-19</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">OpenJDK Runtime Environment </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">build </span><span class="token number" style="color:#36acaa">11.0</span><span class="token plain">.13+8-post-Debian-1deb11u1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">OpenJDK </span><span class="token number" style="color:#36acaa">64</span><span class="token plain">-Bit Server VM </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">build </span><span class="token number" style="color:#36acaa">11.0</span><span class="token plain">.13+8-post-Debian-1deb11u1, mixed mode</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ì¼ë‹¨ ë‹¤ë¥¸ Java_Tool Optionì´ ìˆì—ˆì§€ë§Œ ë‹¤ ìƒëµí•˜ê³  ë¨¼ì € OpenJdk ì‚¬ìš© ì¤‘ì´ê³  Versionì€ 11.0.13ì„ ì‚¬ìš©í•˜ëŠ” ê±¸ í™•ì¸í•˜ê³ , ì˜µì…˜ì„ ë´¤ëŠ”ë° <code>-XX:+UseSerialGC</code>  (<del>ì•„ë‹ˆ í˜•ì´ ì™œ ìš”ê¸°ì„œ ë‚˜ì™€</del>)  </p><h3 class="anchor anchorWithStickyNavbar_mojV" id="ì˜ì‹¬">ì˜ì‹¬<a class="hash-link" href="#ì˜ì‹¬" title="Direct link to heading">â€‹</a></h3><p>ë„ˆë¬´ ë†€ë¼ì„œ, ì§€ê¸ˆ ìƒê°í•´ë³´ë©´ ë§ë„ ì•ˆ ë˜ëŠ” ì—¬ëŸ¬ ì˜ì‹¬ë“¤ì„ í–ˆëŠ”ë° </p><ol><li>ì € JDK ë²„ì „ì´ ë¬¸ì œê°€ ìˆì–´ì„œ ë¬´ì¡°ê±´ SerialGCë¥¼ ì£¼ì… í•  ê²ƒì´ë‹¤.<ul><li>ë¼ê³  ìƒê°ì„ í–ˆì§€ë§Œ, ì‚¬ì‹¤ ë§ë„ ì•ˆ ëœë‹¤ ë¬´ìŠ¨ ë™ë„¤ OpenJdkë„ ì•„ë‹ˆê³  ì´ ìƒê°ì€ ê¸ˆë°© ë„˜ì–´ê°”ë‹¤</li></ul></li><li>ëˆ„êµ°ê°€ê°€ ì£¼ì…ì„ í–ˆì„ ê²ƒì´ë‹¤.<ul><li>ëˆ„êµ°ê°€ê°€ buildë¥¼ í•  ë•Œ ì£¼ì…ì„ í•´ë†¨ì„ ê±°ë¼ê³  ìƒê°ì„ í•˜ê³  buildë¶€ë¶„ì„ ìœ ì‹¬íˆ ë´¤ì§€ë§Œ SerialGCì˜ Së„ ì°¾ì•„ë³¼ ìˆ˜ ì—†ì—ˆë‹¤.</li></ul></li><li>ì € ì˜µì…˜ì´ ë³´ì—¬ì£¼ëŠ” ê±´ ê°€ì§œì•¼!</li></ol><p>ë“±ë“± ì§„ì§œ ë§ë„ ì•ˆ ë˜ëŠ” ì˜ì‹¬ë“¤ì„ í•˜ê¸° ì‹œì‘í–ˆë‹¤.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="ì¹¨ì°©">ì¹¨ì°©<a class="hash-link" href="#ì¹¨ì°©" title="Direct link to heading">â€‹</a></h3><p>ì‚¬ì‹¤ ìœ„ì— ì €ëŸ° ì˜ì‹¬ ë§ê³ ë„ ì—¬ëŸ¬ ê°€ì •ê³¼ ìˆ˜ë§ì€ ì˜ì‹¬ë“¤ì„ í–ˆì—ˆë‹¤. ê·¸ëŸ¬ë‹¤ê°€ í˜„ì‹¤ì„ ë°›ì•„ë“¤ì´ê³  ì™œ SerialGCë¥¼ ì‚¬ìš©í•˜ê²Œ ë˜ì—ˆì„ê¹Œë¼ê³  ìƒê°ì„ í–ˆë‹¤. ì‚¬ì‹¤ ë‚œ ë‚˜ë³´ë‹¤ Kubeí™˜ê²½ì—ì„œì˜ Containerê°€ ìë™ìœ¼ë¡œ <strong>ì €ë ‡ê²Œ ì„¤ì •í•œ ì´ìœ ê°€ ìˆê² ì§€ë¼ê³ </strong> ë” ë¯¿ê¸° ë•Œë¬¸ì— ì˜¤ëœë§Œì— SeraliGCì™€ G1GCë¥¼ ë‹¤ì‹œ í™•ì¸í•´ ë³´ê¸°ë¡œ í–ˆë‹¤.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="serail-collector">Serail Collector<a class="hash-link" href="#serail-collector" title="Direct link to heading">â€‹</a></h3><p>The serial collector uses a single thread to perform all garbage collection work, which makes it relatively efficient because there is no communication overhead between threads.</p><p>It's best-suited to single processor machines because it can't take advantage of multiprocessor hardware, although it can be useful on multiprocessors for applications with small data sets (up to approximately 100 MB). The serial collector is selected by default on certain hardware and operating system configurations, or can be explicitly enabled with the option&nbsp;<code>-XX:+UseSerialGC</code>.</p><p>ê°€ì¥ ì¤‘ìš”í•œ í•µì‹¬ì€ <strong>Single processor</strong> ì¼ ë•Œ Best Suiteì´ë‹¤. ë¬¼ë¡  ì‘ì€ ë©”ëª¨ë¦¬ ë°ì´í„°ì…‹(up to approximately 100 MB)ì„ ì‚¬ìš©í•˜ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œëŠ” ë©€í‹° í”„ë¡œì„¸ì„œì¼ ê²½ìš° ì“¸ë§Œí•˜ê¸´ í•˜ë‚˜ ë³„ë¡œ ì‚¬ìš©ì„ ì•ˆ í•œë‹¤.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="g1gc">G1GC<a class="hash-link" href="#g1gc" title="Direct link to heading">â€‹</a></h3><p>java 9 ë¶€í„° ì±„íƒí•œ default GCì´ë‹¤. </p><p>The Garbage-First (G1) garbage collector is targeted for <strong>multiprocessor machines</strong> <strong>with a large amount of memory</strong>. It attempts to meet garbage collection pause-time goals with high probability while achieving high throughput with little need for configuration. G1 aims to provide the best balance between latency and throughput using current target applications and environments whose features include:
ã„¹ë§ë„
ê°€ì¥ ì¤‘ìš”í•œ í•µì‹¬ì€ Gabage First GCì€ ë†’ì€ ë©”ëª¨ë¦¬ ëŸ‰ê³¼ ë‹¤ì¤‘ í”„ë¡œì„¸ì„œë¥¼ íƒ€ê¹ƒìœ¼ë¡œ ì‚¼ê³ , ë¹ ë¥¸ ì²˜ë¦¬ë¥¼ ì§€ì›í•˜ì—¬ STWë¥¼ ì¤„ì¸ë‹¤ëŠ” ê²ƒì´ë‹¤.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="ì›ì¸">ì›ì¸<a class="hash-link" href="#ì›ì¸" title="Direct link to heading">â€‹</a></h3><p>ì›ì¸ì€ <a href="https://developers.redhat.com/articles/2022/04/19/java-17-whats-new-openjdks-container-awareness#tuning_defaults_for_containers" target="_blank" rel="noopener noreferrer">RedHatë¬¸ì„œ</a>ì—ì„œ ì°¾ì„ ìˆ˜ ìˆì—ˆëŠ”ë°</p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>Java 11GC In Container</h5></div><div class="admonition-content"><p>For Java 11+ it's also useful to know which GC is being used, and you can display this information via&nbsp;-Xlog:gc=info. For example, when container limits allow only a single CPU to be active, the Serial GC will be selected. <code>If more than one CPU is active and sufficient memory (at least 2GB) is allocated to the container, the G1 GC will be selected in Java 11 and later versions:</code></p></div></div><p>Containerí™˜ê²½ì—ì„œëŠ” CPU Coreë¥¼ 2ê°œ ì´ìƒ ì‚¬ìš©í•˜ë©´ì„œ Memoryê°€ 2G ì´ìƒì´ì—¬ì•¼ G1GCê°€ ì±„íƒëœë‹¤ëŠ” ê²ƒì´ë‹¤.</p><p><a href="https://developers.redhat.com/articles/2022/04/19/best-practices-java-single-core-containers#the_jvm_as_a_dynamic_execution_platform" target="_blank" rel="noopener noreferrer">ì•„ë§ˆë„  ì½”ë“œì—ì„œëŠ” ì´ëŸ° ëŠë‚Œì´ì§€ ì•Šì„ê¹Œ</a></p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">void GCConfig::</span><span class="token function-name function" style="color:#d73a49">select_gc_ergonomically</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">os::is_server_class_machine</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">))</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#if INCLUDE_G1GC</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    FLAG_SET_ERGO_IF_DEFAULT</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">UseG1GC, </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#elif INCLUDE_PARALLELGC</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    FLAG_SET_ERGO_IF_DEFAULT</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">UseParallelGC, </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#elif INCLUDE_SERIALGC</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    FLAG_SET_ERGO_IF_DEFAULT</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">UseSerialGC, </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#endif</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#if INCLUDE_SERIALGC</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    FLAG_SET_ERGO_IF_DEFAULT</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">UseSerialGC, </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#endif</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// This is the working definition of a server class machine:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// </span><span class="token operator" style="color:#393A34">&gt;=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> physical CPU's and </span><span class="token operator" style="color:#393A34">&gt;=</span><span class="token plain">2GB of memory</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="ë³€ê²½">ë³€ê²½<a class="hash-link" href="#ë³€ê²½" title="Direct link to heading">â€‹</a></h3><p>ì›ì¸ì€ ì¼ë‹¨ ì•Œì•˜ìœ¼ë‹ˆê¹Œ ê¸°ì¡´ì— ë”°ë¡œ ì§€ì •ì„ ì•ˆ í–ˆë˜ CPU processorë¥¼ ëŠ˜ë¦¬ê³  ë©”ëª¨ë¦¬ë„ ì¦ê°€ë¥¼ ì‹œí‚¨ ê²°ê³¼  </p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">/ </span><span class="token comment" style="color:#999988;font-style:italic"># java -XX:+PrintCommandLineFlags -version</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Picked up JAVA_TOOL_OPTIONS: -javaagent:/opt/agent/apm-agent.jar</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-XX:G1ConcRefinementThreads</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> -XX:GCDrainStackTargetSize</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">64</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-XX:+UseCompressedOops </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">**-XX:+UseG1GC** </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">openjdk version </span><span class="token string" style="color:#e3116c">"11.0.13"</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2021</span><span class="token plain">-10-19</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">OpenJDK </span><span class="token number" style="color:#36acaa">64</span><span class="token plain">-Bit Server VM </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">build </span><span class="token number" style="color:#36acaa">11.0</span><span class="token plain">.13+8-post-Debian-1deb11u1, mixed mode</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ê·¸ í›„ ë©°ì¹  ê°„ê²©ìœ¼ë¡œ ëª¨ë‹ˆí„°ë§ì„ í•´ë³¸ ê²°ê³¼ </p><p>ê¸°ì¡´ SerialGC ì‚¬ìš©í•  ë•Œì—ëŠ” GCê°€ ì¼ì–´ë‚  ë•Œ ì „ë°˜ì ìœ¼ë¡œ pause timeì´ ê¸¸ì—ˆìŠµë‹ˆë‹¤. 100ms </p><p><img loading="lazy" alt="Untitled" src="/assets/images/Untitled 1-69ab52e668ab54bc5f495b2da6969372.png" width="1050" height="546" class="img_E7b_">  </p><p>ë³€ê²½ í›„  </p><p><img loading="lazy" alt="Untitled" src="/assets/images/Untitled 2-09e5e763a52808557fcfbd1cc5897173.png" width="1028" height="536" class="img_E7b_">  </p><p>ë” ëª¨ë‹ˆí„°ë§ì„ í•´ ë´ì•¼ê² ì§€ë§Œ ë‹¤ì†Œ 150msë‚˜ ë¨¹ì—ˆë˜ Major GCë¶€ë¶„ì´ heap size ë³€ê²½ ë° cpu processorì¦ê°€ GC ë³€ê²½ í›„ì— ì•„ì§ ì¼ì–´ë‚˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.</p><p>ì°¸ì¡°<br>
<a href="https://docs.oracle.com/javase/9/gctuning/available-collectors.htm#GUID-45794DA6-AB96-4856-A96D-FDE5F7DEE498" target="_blank" rel="noopener noreferrer">https://docs.oracle.com/javase/9/gctuning/available-collectors.htm#GUID-45794DA6-AB96-4856-A96D-FDE5F7DEE498</a><br>
<a href="https://johngrib.github.io/wiki/java-gc-tuning/#serial-collector" target="_blank" rel="noopener noreferrer">https://johngrib.github.io/wiki/java-gc-tuning/#serial-collector</a><br>
<a href="https://d2.naver.com/helloworld/1329" target="_blank" rel="noopener noreferrer">https://d2.naver.com/helloworld/1329</a> - Naverì˜ GCì •ë¦¬ëŠ” ë‚˜ë§Œ ì½ê³  ì‹¶ì€ Docs ì¤‘ í•˜ë‚˜<br>
<a href="https://docs.oracle.com/javase/9/gctuning/garbage-first-garbage-collector.htm#JSGCT-GUID-0394E76A-1A8F-425E-A0D0-B48A3DC82B42" target="_blank" rel="noopener noreferrer">https://docs.oracle.com/javase/9/gctuning/garbage-first-garbage-collector.htm#JSGCT-GUID-0394E76A-1A8F-425E-A0D0-B48A3DC82B42</a><br>
<a href="https://www.oracle.com/technetwork/tutorials/tutorials-1876574.html" target="_blank" rel="noopener noreferrer">https://www.oracle.com/technetwork/tutorials/tutorials-1876574.html</a> g1gc</p>]]></content>
        <author>
            <name>Dongle</name>
            <uri>https://github.com/sk1737030</uri>
        </author>
        <category label="Kubernate" term="Kubernate"/>
        <category label="Container" term="Container"/>
        <category label="JVM" term="JVM"/>
        <category label="Java" term="Java"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Request Rate Limiterë¥¼ ë§Œë“¤ì–´ë³´ì! 2í¸]]></title>
        <id>RateLimiter2</id>
        <link href="https://dgle.dev/RateLimiter2"/>
        <updated>2022-05-01T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Make Custom Rate Limiter With Spring Cloud Gateway 2]]></summary>
        <content type="html"><![CDATA[<p>Rate Limiterë¥¼ ë§Œë“¤ì–´ë³´ì! 2í¸</p><p><a href="https://github.com/sk1737030/til/tree/master/./2022-05-01/spring-cloud-gateway-late-limiter" target="_blank" rel="noopener noreferrer">ëª¨ë“  ì†ŒìŠ¤</a>ëŠ” ìš”ê¸°ì„œ í™•ì¸ê°€ëŠ¥í•©ë‹ˆë‹¤. :)  </p><h1>Spring Cloud Gatewayë¥¼ ì‚¬ìš©í•´ì„œ API Limiter êµ¬í˜„ì„ í•´ë³´ì! 2í¸</h1><p>ì•ì„œ 1í¸ì—ì„œ ë³´ì•˜ë˜ ê¸°ë³¸ë„ ì˜ ì“¸ ìˆ˜ ìˆìœ¼ë‚˜, ì¡°ê¸ˆ ë” ë‚˜ê°€ì„œ <del>ì•„êµ¬ëª¬ì´ ì§„í™”í•´ì„œ ê·¸ë ˆì´ëª¬ì´ ë˜ë“¯ì´</del> Customì„ ì¡°ê¸ˆë§Œ ë” í•´ì£¼ë©´ ë‚˜ë¦„ ê´œì°®ì€ RateLimiterê°€ ë  ìˆ˜ ìˆë‹¤. </p><h2 class="anchor anchorWithStickyNavbar_mojV" id="custom-redis-limiter">Custom Redis limiter<a class="hash-link" href="#custom-redis-limiter" title="Direct link to heading">â€‹</a></h2><p>ì•ì—ì„œ ì‚¬ìš©í–ˆë˜ Default Redis LimiterëŠ” ì•„ë˜ ìš”êµ¬ì‚¬í•­ì„ êµ¬í˜„í•˜ê¸°ê°€ í˜ë“ ë°</p><ol><li>íŠ¹ì • ì‚¬ìš©ìì˜ ì£¼ì‹ ì¡°íšŒ ìš”ì²­ì„ ë¶„ë‹¹ 1ë²ˆìœ¼ë¡œ ì„¤ì •ì„ í•˜ê³  ì£¼ì‹ ì£¼ë¬¸ì„ ì´ˆë‹¹ 1ë²ˆë§Œ ê°€ëŠ¥í•˜ë‹¤ë˜ì§€ </li><li>ì†ë„ ë¬¸ì œë¡œ ë³µì¡í•˜ê³  ë¦¬ì†ŒìŠ¤ê°€ ë§ì´ ë“œëŠ” ìš”ì²­ì¼ ê²½ìš° ë¶„ë‹¹ 1ë²ˆë§Œ ìš”ì²­í•˜ê²Œ í•œë‹¤ë˜ì§€ </li><li>ì§€ê¸ˆ redisì—ëŠ” timestampì™€ tokenKey 2ê°œë§Œ ë“¤ì–´ê°€ ìˆëŠ”ë° ë‹¤ë¥¸ ì¶”ê°€ì ì¸ ì •ë³´ë„ ë„£ê³  ì‹¶ë‹¤ë“ ì§€</li><li>Redis TTLë¥¼ ë” ê¸¸ê²Œ ì¡ëŠ”ë‹¤ë“ ì§€</li><li>User ë³„ë¡œ ìš”ì²­ëŸ‰ì„ ë‹¤ë¥´ê²Œ í•˜ê³  ì‹¶ë‹¤ë“ ì§€</li></ol><p>ì´ëŸ¬í•œ ìš”êµ¬ì‚¬í•­ë“¤ì„ ë“¤ì–´ì£¼ëŠ” API Limiterë¥¼ ë‹¨ìˆœí•˜ë©´ì„œ ê°„ë‹¨í•˜ê²Œ(<del>í‰ë²”í•˜ë©´ì„œë„ ìš°ì•„í•˜ë¼ê³  ìš°ë¦¬ë„¤ í´ë¼ì´ì–¸íŠ¸ê°€ ì‹¤ì œë¡œ ë“¤ì€ ë§</del>) êµ¬í˜„ì„ í•œ ë²ˆ í•´ë³´ì. </p><h3 class="anchor anchorWithStickyNavbar_mojV" id="custom">Custom<a class="hash-link" href="#custom" title="Direct link to heading">â€‹</a></h3><p>ë¨¼ì € ìš°ë¦¬ëŠ” ì˜ êµ¬í˜„ë˜ì–´ìˆëŠ”<code>RedisRateLimiter</code>ë¥¼ ìƒì†ë°›ì•„ì„œ ì‚¬ìš©í•œë‹¤.</p><div class="codeBlockContainer_I0IT language-java theme-code-block"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_BvAR">CustomRedisRateLimiter.java</div><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token annotation punctuation" style="color:#393A34">@Configuration</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token annotation punctuation" style="color:#393A34">@Slf4j</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">CustomRedisRateLimiter</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">extends</span><span class="token plain"> </span><span class="token class-name">RedisRateLimiter</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ë§Œì•½ <strong>User</strong> ë³„ë¡œ ìš”ì²­ëŸ‰ì„ ë‹¤ë¥´ê²Œ í•œë‹¤ë©´ ìš°ë¦¬ëŠ” ìˆ˜ì •í•´ì•¼ í•  ë©”ì„œë“œê°€ í¬ê²Œ ë‘ ê°œê°€ ìˆëŠ”ë°<br>
<!-- -->ë¨¼ì € <strong>isAllowed</strong>, <strong>loadConfiguration</strong> ì´ ë‘ ê°œì˜ ë©”ì„œë“œë¥¼ ìˆ˜ì •í•´ì•¼ í•œë‹¤.</p><div class="codeBlockContainer_I0IT language-java theme-code-block"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_BvAR">CustomRedisRateLimiter.java</div><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token annotation punctuation" style="color:#393A34">@Configuration</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token annotation punctuation" style="color:#393A34">@Slf4j</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">CustomRedisRateLimiter</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">extends</span><span class="token plain"> </span><span class="token class-name">RedisRateLimiter</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">private</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">final</span><span class="token plain"> </span><span class="token class-name">Config</span><span class="token plain"> userAConfig </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Config</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">setBurstCapacity</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">setReplenishRate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">setRequestedTokens</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">private</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">final</span><span class="token plain"> </span><span class="token class-name">Config</span><span class="token plain"> commonUserConfig </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Config</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">setBurstCapacity</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">setReplenishRate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">setRequestedTokens</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token annotation punctuation" style="color:#393A34">@Override</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token class-name">Mono</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">Response</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">isAllowed</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">String</span><span class="token plain"> routeId</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">String</span><span class="token plain"> id</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">Config</span><span class="token plain"> routeConfig </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">loadConfiguration</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">routeId</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> id</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> replenishRate </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> routeConfig</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getReplenishRate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> burstCapacity </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> routeConfig</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getBurstCapacity</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> requestedTokens </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> routeConfig</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getRequestedTokens</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">try</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token class-name">List</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">String</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> keys </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">getKeys</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">id</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token class-name">List</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">String</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> scriptArgs </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name">Arrays</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">asList</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">replenishRate </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">""</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> burstCapacity </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">""</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">""</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> requestedTokens </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">""</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token class-name">Flux</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">List</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">Long</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> flux </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> redisTemplate</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">execute</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">script</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> keys</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> scriptArgs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> flux</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">onErrorResume</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">throwable </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">log</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">isDebugEnabled</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    log</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">debug</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"Error calling rate limiter lua"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> throwable</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token class-name">Flux</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">just</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">Arrays</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">asList</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1L</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1L</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">reduce</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">ArrayList</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">Long</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">longs</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> l</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                longs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">addAll</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">l</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> longs</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">map</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">results </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#00009f">boolean</span><span class="token plain"> allowed </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> results</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1L</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token class-name">Long</span><span class="token plain"> tokensLeft </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> results</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token class-name">Response</span><span class="token plain"> response </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Response</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">allowed</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">getHeaders</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">routeConfig</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> tokensLeft</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">log</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">isDebugEnabled</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    log</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">debug</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"response: "</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> response</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> response</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">catch</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">Exception</span><span class="token plain"> e</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            log</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">error</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"Error determining if user allowed from redis"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> e</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token class-name">Mono</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">just</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Response</span><span class="token punctuation" style="color:#393A34">(</span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">getHeaders</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">routeConfig</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1L</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">Config</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">loadConfiguration</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">String</span><span class="token plain"> routeId</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">String</span><span class="token plain"> key</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">key</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">equals</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"demo1234"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">getConfig</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getOrDefault</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">routeId </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> key</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> userAConfig</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">getConfig</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getOrDefault</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">routeId</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> commonUserConfig</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ìš°ë¦¬ê°€ ì•ì—ì„œ <code>UserKeyResolver</code>ì—ì„œ ì„¤ì •í•œ <code>key</code>ê°€ ë“¤ì–´ì˜¤ê²Œ ë˜ëŠ”ë°, ì´ í‚¤ë¥¼ ê°€ì§€ê³  ì œí•œí•˜ê³ ì í•˜ëŠ” ìš”ì²­ëŸ‰ì„ ë¨¼ì € Configë¥¼ ì£¼ì…í•˜ë©´ ëì´ë‹¤.</p><div class="codeBlockContainer_I0IT language-java theme-code-block"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_BvAR">CustomRedisRateLimiter.java</div><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token annotation punctuation" style="color:#393A34">@Configuration</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token annotation punctuation" style="color:#393A34">@Slf4j</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">CustomRedisRateLimiter</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">extends</span><span class="token plain"> </span><span class="token class-name">RedisRateLimiter</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">private</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">final</span><span class="token plain"> </span><span class="token class-name">Config</span><span class="token plain"> userAConfig </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Config</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">setBurstCapacity</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">setReplenishRate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">setRequestedTokens</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">private</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">final</span><span class="token plain"> </span><span class="token class-name">Config</span><span class="token plain"> commonUserConfig </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Config</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">setBurstCapacity</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">setReplenishRate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">setRequestedTokens</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">private</span><span class="token plain"> </span><span class="token class-name">ReactiveStringRedisTemplate</span><span class="token plain"> redisTemplate</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">private</span><span class="token plain"> </span><span class="token class-name">RedisScript</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">List</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">Long</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> script</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token annotation punctuation" style="color:#393A34">@Autowired</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token class-name">CustomRedisRateLimiter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">ReactiveStringRedisTemplate</span><span class="token plain"> redisTemplate</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">RedisScript</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">List</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">Long</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> script</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">ConfigurationService</span><span class="token plain"> configurationService</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">super</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">redisTemplate</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> script</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> configurationService</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">redisTemplate </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> redisTemplate</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">script </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> script</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token class-name">CustomRedisRateLimiter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> defaultReplenishRate</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> defaultBurstCapacity</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">super</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">defaultReplenishRate</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> defaultBurstCapacity</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token class-name">CustomRedisRateLimiter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> defaultReplenishRate</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> defaultBurstCapacity</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> defaultRequestedTokens</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">super</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">defaultReplenishRate</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> defaultBurstCapacity</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> defaultRequestedTokens</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">static</span><span class="token plain"> </span><span class="token class-name">List</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">String</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">getKeys</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">String</span><span class="token plain"> id</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">String</span><span class="token plain"> prefix </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"request_rate_limiter.{"</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> id</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">String</span><span class="token plain"> tokenKey </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> prefix </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"}.tokens"</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">String</span><span class="token plain"> timestampKey </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> prefix </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"}.timestamp"</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token class-name">Arrays</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">asList</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">tokenKey</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> timestampKey</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token annotation punctuation" style="color:#393A34">@Override</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token class-name">Mono</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">Response</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">isAllowed</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">String</span><span class="token plain"> routeId</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">String</span><span class="token plain"> id</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">Config</span><span class="token plain"> routeConfig </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">loadConfiguration</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">routeId</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> id</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> replenishRate </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> routeConfig</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getReplenishRate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> burstCapacity </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> routeConfig</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getBurstCapacity</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> requestedTokens </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> routeConfig</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getRequestedTokens</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">try</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token class-name">List</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">String</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> keys </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">getKeys</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">id</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token class-name">List</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">String</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> scriptArgs </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name">Arrays</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">asList</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">replenishRate </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">""</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> burstCapacity </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">""</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">""</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> requestedTokens </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">""</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token class-name">Flux</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">List</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">Long</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> flux </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> redisTemplate</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">execute</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">script</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> keys</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> scriptArgs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> flux</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">onErrorResume</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">throwable </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">log</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">isDebugEnabled</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    log</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">debug</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"Error calling rate limiter lua"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> throwable</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token class-name">Flux</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">just</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">Arrays</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">asList</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1L</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1L</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">reduce</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">ArrayList</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">Long</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">longs</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> l</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                longs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">addAll</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">l</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> longs</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">map</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">results </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#00009f">boolean</span><span class="token plain"> allowed </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> results</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1L</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token class-name">Long</span><span class="token plain"> tokensLeft </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> results</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token class-name">Response</span><span class="token plain"> response </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Response</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">allowed</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">getHeaders</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">routeConfig</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> tokensLeft</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">log</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">isDebugEnabled</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    log</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">debug</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"response: "</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> response</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> response</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">catch</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">Exception</span><span class="token plain"> e</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            log</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">error</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"Error determining if user allowed from redis"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> e</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token class-name">Mono</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">just</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Response</span><span class="token punctuation" style="color:#393A34">(</span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">getHeaders</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">routeConfig</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1L</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">Config</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">loadConfiguration</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">String</span><span class="token plain"> routeId</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">String</span><span class="token plain"> key</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">key</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">equals</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"demo1234"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">getConfig</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getOrDefault</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">routeId </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> key</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> userAConfig</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">getConfig</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getOrDefault</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">routeId</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> commonUserConfig</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ê·¸ë¦¬ê³  <code>application.yml</code> íŒŒì¼ì— <code>rate-limitter</code> <code>customRedisRateLimiter</code>ë¥¼ ì¶”ê°€í•´ì¤€ë‹¤.</p><div class="codeBlockContainer_I0IT language-yml theme-code-block"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_BvAR">application.yaml</div><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-yml codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">spring</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> RequestRateLimiter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">args</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">rate-limitter</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"#{@customRedisRateLimiter}"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">key-resolver</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"#{@apiKeyResolve}"</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="ê²°ê³¼">ê²°ê³¼<a class="hash-link" href="#ê²°ê³¼" title="Direct link to heading">â€‹</a></h3><p><code>Get localhost:18080/demo?userId=demo1234</code> </p><p><img loading="lazy" alt="Untitled" src="/assets/images/Untitled 6-2a24462622b3348b88fd7bb5f1c7d9b9.png" width="535" height="131" class="img_E7b_"></p><p>Request ìš”ì²­ ì‹œ ìœ„ì— ì„¤ì •í•œ userAConfigì— ë§ê²Œ ì‘ë‹µ ê°’ì´ ëŒì•„ì˜¤ê²Œ ëœë‹¤.</p><p><code>Get localhost:18080/demo?userId=test</code> </p><p><img loading="lazy" alt="Untitled" src="/assets/images/Untitled 7-4cb98112e0993f41471bedba911596a6.png" width="550" height="132" class="img_E7b_"></p><p> <code>Remaining</code> ë³´ë‹¤ ìš”ì²­ì„ ë” ë§ì´ í•˜ê²Œ ë˜ë©´ <code>429 Too Many Request</code> ê°€ ì‘ë‹µìœ¼ë¡œ ì˜¤ê²Œ ëœë‹¤.</p><p><img loading="lazy" alt="Untitled" src="/assets/images/Untitled 8-3124e6119104e3f1247c28dd33a59d96.png" width="1017" height="364" class="img_E7b_"></p><p>ì¶”ê°€í•´ë„ ì¢‹ì„ë§Œí•œ ì˜µì…˜ì´ ìˆëŠ”ë°, ë§Œì•½ ë‹¤ì–‘í•œ ì´ìœ ë¡œ ìš”ì²­ì„ ê±°ì ˆí•˜ê³  ì‹¶ì„ ë•Œ ì˜ˆë¥¼ ë“¤ì–´ í—¤ë”ì— ì•½ì†ëœ ê°’ì´ ì—†ê±°ë‚˜ ë“±
ê·¸ëŸ´ ë•Œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ì˜µì…˜ì´ <code>deny-empty-key</code>ë¼ëŠ” ì˜µì…˜ì´ë‹¤. (default true)ì´ë‹¤.<br>
<!-- -->ì´ ì˜µì…˜ì„ ì‚¬ìš©í•˜ê¸° ìœ„í•´ì„œ <strong>_<strong>_EMPTY_KEY</strong></strong> ì„ ë’¤ë¡œ ë„˜ê²¨ì£¼ê²Œ ë˜ë©´ <code>FORBIDDEN</code> ì‘ë‹µìœ¼ë¡œ ëŒë ¤ì£¼ê²Œ ëœë‹¤.</p><div class="codeBlockContainer_I0IT language-java theme-code-block"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_BvAR">UserKeyResolver.java</div><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token annotation punctuation" style="color:#393A34">@Bean</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token class-name">KeyResolver</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">apiKeyResolve</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">!</span><span class="token plain">exchange</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getRequest</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getQueryParams</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">containsKey</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"userId"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token class-name">Mono</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">just</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"____EMPTY_KEY__"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token class-name">Mono</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">just</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">exchange</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getRequest</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getQueryParams</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getFirst</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"userId"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><br><p><img loading="lazy" alt="Untitled" src="/assets/images/Untitled 9-c27ab7d345cdda32e2833f76169d7895.png" width="1034" height="260" class="img_E7b_"></p><h3 class="anchor anchorWithStickyNavbar_mojV" id="ì •ë§-ì˜-ì‘ë™í• ê¹Œ">ì •ë§ ì˜ ì‘ë™í• ê¹Œ?<a class="hash-link" href="#ì •ë§-ì˜-ì‘ë™í• ê¹Œ" title="Direct link to heading">â€‹</a></h3><p>ì´ ë¶€ë¶„ì„ í™•ì¸í•˜ê¸° ìœ„í•´ì„œ ì§§ì€ ì‹œê°„ì— ë§ì€ ë¶€í•˜ í…ŒìŠ¤íŠ¸ë¥¼ í•´ ë³¼ ê²ƒì´ë‹¤. ê°„ë‹¨í•˜ê²Œ <a href="https://k6.io/" target="_blank" rel="noopener noreferrer">k6</a> ë¶€í•˜ í…ŒìŠ¤íŠ¸ ë„êµ¬ë¥¼ ì´ìš©í•´ì„œ  í…ŒìŠ¤íŠ¸ë¥¼ í•´ ë³¼ ê²ë‹ˆë‹¤. </p><p>ì¡°ê±´ ì´ˆë‹¹ 1íšŒ ìš”ì²­ì„ ê°€ëŠ¥í•œì§€ë¥¼ í…ŒìŠ¤íŠ¸í•œë‹¤ë©´</p><p>limiter ì„¤ì •<br>
<code>requestedTokens</code> 1<br>
<code>burstCapacity</code> 1<br>
<code>replenishRate</code> 1 </p><p>k6/loadtest.js</p><div class="codeBlockContainer_I0IT language-js theme-code-block"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_BvAR">loadtest.js</div><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-js codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword module" style="color:#00009f">import</span><span class="token plain"> </span><span class="token imports">http</span><span class="token plain"> </span><span class="token keyword module" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'k6/http'</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword module" style="color:#00009f">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#393A34">{</span><span class="token imports"> check</span><span class="token imports punctuation" style="color:#393A34">,</span><span class="token imports"> group</span><span class="token imports punctuation" style="color:#393A34">,</span><span class="token imports"> sleep </span><span class="token imports punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'k6'</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword module" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> options </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">duration</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'10s'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">vus</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'1'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">BASE_URL</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'http://localhost:18080'</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword module" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword module" style="color:#00009f">default</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> limiter </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> http</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">${</span><span class="token template-string interpolation constant" style="color:#36acaa">BASE_URL</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">}</span><span class="token template-string string" style="color:#e3116c">/demo?userId=test</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">check</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">limiter</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string-property property" style="color:#36acaa">'success limitter '</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">resp</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> resp</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">status</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">===</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">200</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ì •ë§ ê°„ë‹¨í•œ ìŠ¤í¬ë¦½íŠ¸ë¡œ ë³´ë©´ ì•Œê² ì§€ë§Œ<br>
<!-- -->10ì´ˆ ë™ì•ˆ getìš”ì²­ì„ í•œë‹¤ëŠ” ìŠ¤í¬ë¦½íŠ¸ì´ê³ , ê²°ê³¼ë¡œ 200ì¼ ê²½ìš° ì„±ê³µìœ¼ë¡œ ë³´ê² ë‹¤ëŠ” ê²ƒì´ë‹¤.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="ê²°ê³¼-1">ê²°ê³¼<a class="hash-link" href="#ê²°ê³¼-1" title="Direct link to heading">â€‹</a></h3><p><img loading="lazy" alt="Untitled" src="/assets/images/Untitled 10-743c5bd798aa8c18e3911f614d961010.png" width="1570" height="898" class="img_E7b_"></p><p>11ë²ˆì˜ ìš”ì²­ì´ ì„±ê³µì ìœ¼ë¡œ 200ìœ¼ë¡œ return ë˜ì—ˆê³ , 6045ë²ˆì´ ì‹¤íŒ¨í•œ ë‚´ì—­ì´ë‹¤.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="ì´ìƒìœ¼ë¡œ">ì´ìƒìœ¼ë¡œ<a class="hash-link" href="#ì´ìƒìœ¼ë¡œ" title="Direct link to heading">â€‹</a></h2><p>ì´ë ‡ê²Œ ê°„ë‹¨í•˜ê²Œ <code>RateLimiter</code>ë¥¼ êµ¬í˜„ì„ í•´ë³´ì•˜ëŠ”ë–¼, ì²˜ìŒì—ëŠ” êµ¬í˜„ì„ ì–´ë–»ê²Œ í•˜ì§€ë¼ë©° ê³ ë¯¼ì„ í•˜ì˜€ëŠ”ë°,<br>
<!-- -->Redisë¥¼ ë„ì ë„ì ì´ë©° êµ¬í˜„ ì¤‘ì— (<del>Watchì™€ Multiì™€ í•¨ê»˜ë¼ë©´),</del><br>
<!-- -->Spring ì§„ì˜ì— ì˜ êµ¬í˜„ì´ ë˜ì–´ ìˆì–´ì„œ ì‰½ê²Œ ê°€ì ¸ì™€ì„œ ìš”êµ¬ì‚¬í•­ì— ë§ê²Œ ì‚¬ìš©ì„ í–ˆì—ˆë‹¤.<br>
<!-- -->ì´ë¯¸ ì˜ ë§Œë“¤ì–´ì ¸ì„œ ì—­í• ì„ ì˜í•˜ê³  ìˆìœ¼ë©´ ë¹ ë¥´ê²Œ ì˜ ì‚¬ìš©í•˜ëŠ” ê²Œ ì–´ë ¤ìš´ ê±°êµ¬ë‚˜ ë‹¤ì‹œê¸ˆ ëŠê¼ˆë‹¤.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="ì¶”ê°€ë¡œ-í•œ-ë²ˆ-ê³ ë¯¼í•´ì•¼-í• -ë¶€ë¶„">ì¶”ê°€ë¡œ í•œ ë²ˆ ê³ ë¯¼í•´ì•¼ í•  ë¶€ë¶„<a class="hash-link" href="#ì¶”ê°€ë¡œ-í•œ-ë²ˆ-ê³ ë¯¼í•´ì•¼-í• -ë¶€ë¶„" title="Direct link to heading">â€‹</a></h3><p>Gatewayì—ì„œ Request bodyë¥¼ ì½ì–´ì„œ ë¬´ì–¸ê°€ë¥¼ ì²˜ë¦¬ í•œ í›„ì— ë‹¤ìŒ Filterë¡œ ë„˜ê²¨ ì¤„ ë•Œì—ëŠ” ê³ ë¯¼ì„ í•´ë´ì•¼í•˜ëŠ”ë°,<br>
<!-- -->ì˜ ì•Œë‹¤ì‹œí”¼ Servlet Request Bodyë¥¼ Filterì—ì„œ í•œ ë²ˆ ì½ìœ¼ë©´,<br>
<!-- -->ë‹¤ì‹œ ë’¤ì—ì„œ bodyë¥¼ ëª» ì½ëŠ”ë‹¤ëŠ” ë¬¸ì œê°€ ìˆë‹¤.<br>
<!-- -->ì´ ë¶€ë¶„ì€ í•œ ë²ˆ ì½ê³  bodyë¥¼ ìºì‹± í•´ì„œ ë‹¤ì‹œ bodyë¥¼ ë„£ì–´ì£¼ëŠ” ì¶”ê°€ ì‘ì—…ì´ í•„ìš”í•˜ë‹¤.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="ì°¸ê³ ">ì°¸ê³ <a class="hash-link" href="#ì°¸ê³ " title="Direct link to heading">â€‹</a></h3><p><a href="http://www.yes24.com/Product/Goods/102819435" target="_blank" rel="noopener noreferrer">ê°€ìƒ ë©´ì ‘ ì‚¬ë¡€ë¡œ ë°°ìš°ëŠ” ëŒ€ê·œëª¨ ì‹œìŠ¤í…œ ì„¤ê³„</a><br>
<a href="https://docs.spring.io/./2022-05-01/spring-cloud-gateway/docs/current/reference/html/" target="_blank" rel="noopener noreferrer">Spring Cloud gateway Docs</a><br>
<a href="https://redis.io/docs/manual/programmability/eval-intro/" target="_blank" rel="noopener noreferrer">https://redis.io/docs/manual/programmability/eval-intro/</a></p>]]></content>
        <author>
            <name>Dongle</name>
            <uri>https://github.com/sk1737030</uri>
        </author>
        <category label="SCG" term="SCG"/>
        <category label="Spring Cloud Gateway" term="Spring Cloud Gateway"/>
        <category label="Rate Limiter" term="Rate Limiter"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Request Rate Limiterë¥¼ ë§Œë“¤ì–´ë³´ì! 1í¸]]></title>
        <id>RateLimiter1</id>
        <link href="https://dgle.dev/RateLimiter1"/>
        <updated>2022-05-01T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Make Custom Rate Limiter With Spring Cloud Gateway 1]]></summary>
        <content type="html"><![CDATA[<p>SCGì™€ í•¨ê¼ ê°„ë‹¨í•œ Api Limiterë¥¼ êµ¬í˜„í•´ë³´ì! 1í¸</p><p><a href="https://github.com/sk1737030/til/tree/master/./2022-05-01/spring-cloud-gateway-late-limiter" target="_blank" rel="noopener noreferrer">ëª¨ë“  ì†ŒìŠ¤</a>ëŠ” ìš”ê¸°ì„œ í™•ì¸ê°€ëŠ¥í•©ë‹ˆë‹¤. :)  </p><h1>Spring Cloud Gatewayë¥¼ ì‚¬ìš©í•´ì„œ API Limiter êµ¬í˜„ì„ í•´ë³´ì! 1í¸</h1><h2 class="anchor anchorWithStickyNavbar_mojV" id="api-limitierê°€-í•„ìš”í•œ-ì´ìœ ">Api Limitierê°€ í•„ìš”í•œ ì´ìœ ?<a class="hash-link" href="#api-limitierê°€-í•„ìš”í•œ-ì´ìœ " title="Direct link to heading">â€‹</a></h2><p>limiterëŠ” ì™œ í•„ìš”í• ê¹Œë¥¼ ë¨¼ì € ìƒê°í•´ë³´ë©´ ë‹¤ì–‘í•œ ì´ìœ ê°€ ìˆê² ì§€ë§Œ, ì •ë§ ê°„ë‹¨í•˜ê²Œ ìƒê°í•´ë³´ë©´ 10ì´ˆ ê±¸ë¦¬ëŠ” í—¤ë¹„í•œ apiê°€ ìˆì„ ë•Œ clientë“¤ì´ ì§§ì€ ì‹œê°„ì— APIë¥¼ ë¬´ë¶„ë³„í•˜ê²Œ ìš”ì²­í•˜ê²Œ ë˜ë©´ ìš°ë¦¬ì˜ ì„œë²„ëŠ” <del>ë”ì°í•œ ê²°ë§</del>ì„ ë§ê²Œ ë  ê²ƒì´ë‹¤.
ì €ëŸ° ë‹¨ìˆœí•œ ì´ìœ ë§ê³ ë„ ì‚¬ìš©ìë³„ ì°¨ë“±(A ì‚¬ìš©ìëŠ” ì´ˆë‹¹ 3ë²ˆ ìš”ì²­, B ì‚¬ìš©ìëŠ” ì´ˆë‹¹ 30ë²ˆ ìš”ì²­)ì„ ì¤„ ìˆ˜ë„ ìˆê³  ë“±ë“± ì—¬ëŸ¬ ê°€ì§€ ì´ì ì´ ìƒê¸´ë‹¤. <del>ê·¸ëŸ¬ë¯€ë¡œ ì •ë§ ê¼­ í•˜ë‚˜ì¯¤ì€ ì´ì°¸ì— ì¥ë§Œí•˜ì‹œëŠ” ê²Œ</del></p><p>ì—¬ëŸ¬ ë‹¤ë¥¸ ë°©ë²•ìœ¼ë¡œë„ api limiterë¥¼ apllicaiton ë‹¨ì—ì„œ êµ¬í˜„í•  ìˆ˜ ìˆê² ì§€ë§Œ,  ë¹ ë¥´ê³  ì •í™•í•˜ê³  serializableí•˜ê²Œ  Api Limiterë¥¼ êµ¬í˜„í•˜ëŠ” ê±´ ì •ë§ í•˜ë‚˜ë¶€í„° ì—´ê¹Œì§€ ìƒê°í•´ì•¼ í•  ê²Œ ë§ê³  <strong>ë„ˆë¬´ ì–´ë µë‹¤</strong>(<del>ë‚˜ì—ê²ŒëŠ”</del>). </p><p>ê·¸ë ‡ë‹¤ë©´, ì–´ë–»ê²Œ ì¡°ê¸ˆ ì‰½ê²Œ êµ¬í˜„í•  ìˆ˜ ìˆëŠ”ê°€ë¥¼ ì°¾ì•„ë³´ë©´!!  </p><p><strong><a href="http://www.yes24.com/Product/Goods/102819435" target="_blank" rel="noopener noreferrer">ê°€ìƒ ë©´ì ‘ ì‚¬ë¡€ë¡œ ë°°ìš°ëŠ” ëŒ€ê·œëª¨ ì‹œìŠ¤í…œ ì„¤ê³„ ê¸°ì´ˆë¼ëŠ” ì±…ì—ì„œ</a></strong>  íŒíŠ¸ë¥¼ ì–»ì„ ìˆ˜ ìˆëŠ”ë°,
í•µì‹¬ì€ <code>Redis + Lua Script</code>ë¥¼ ì‚¬ìš©í•˜ì—¬ êµ¬í˜„í•˜ëŠ” ê²ƒì´ë‹¤.</p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>ì™œ Lua Scriptì¼ê¹Œ??</h5></div><div class="admonition-content"><p>Redis Documentì—ì„œ ì°¾ì„ ìˆ˜ ìˆëŠ”ë°, ë£¨ì•„ ìŠ¤í¬ë¦½íŠ¸ê°€ ì‹¤í–‰ë˜ëŠ” ë™ì•ˆ ì¼ë‹¨ ë ˆë””ìŠ¤ëŠ” blocked ìƒíƒœê°€ ëœë‹¤. ì¦‰ ë ˆë””ìŠ¤ëŠ” ë£¨ì•„ ìŠ¤í¬ë¦½íŠ¸ê°€ atomic í•˜ê²Œ ì‹¤í–‰í•˜ëŠ” ê±¸ ë³´ì¥í•˜ê¸° ë•Œë¬¸ì— RateLimiteë¥¼ êµ¬í˜„í•  ìˆ˜ ìˆê²Œ ëœë‹¤.</p></div></div><p>ê·¸ë ‡ë‹¤ë©´, ì •ë§ ì¡°ê¸ˆë§Œ ë”ìš±ë” ìš•ì‹¬ì„ ë‚´ì„œ ìš”ì¦˜ê°™ì´ ëŒ€ MS ì‹œëŒ€ì— ì—¬ëŸ¬ Applicaitonì— Route ì—­í• ë„ í•˜ê³  Gateway ì—­í• ë„ í•˜ë©´ì„œ ê±°ê¸°ì— ë”í•˜ì—¬ Limiterê¹Œì§€ ì§€ì›í•œë‹¤ë©´ ì–¼ë§ˆë‚˜ ì¢‹ì„ê¹Œ?
ê·¼ë° ê·¸ëŸ° íŒ”ë°©ë¯¸ì¸ì˜ ë¬´-ì¹œ ìºë¦¬ë¨¸ì‹ ì´ ìˆìœ¼ë‹ˆ</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="spring-cloud-gateway"><a href="https://docs.spring.io/./2022-05-01/spring-cloud-gateway/docs/2.2.9.RELEASE/reference/html/" target="_blank" rel="noopener noreferrer">Spring Cloud Gateway</a><a class="hash-link" href="#spring-cloud-gateway" title="Direct link to heading">â€‹</a></h2><p>Spring Cloud Gatewayë¥¼ ì •ë§ ì •-ë§ ê°„ë‹¨í•˜ê²Œ  ì†Œê°œí•˜ë©´ ê·¸ëƒ¥ Gateway ì—­í• ì„ í•œë‹¤.</p><p>ìš°ë¦¬ì˜ ìœ„í‚¤ì—ëŠ” Gatewayë¥¼ ì„¤ëª… ì˜í•´ë†¨ëŠ”ë°, <strong>ê²Œì´íŠ¸ì›¨ì´</strong>ëŠ” ì»´í“¨í„° ë‹¤ë¥¸ ë„¤íŠ¸ì›Œí¬ë¡œ ë“¤ì–´ê°€ëŠ” ì…êµ¬ ì—­í• ì„ í•˜ëŠ” ë„¤íŠ¸ì›Œí¬ í¬ì¸íŠ¸ì´ë‹¤. ë„“ì€ ì˜ë¯¸ë¡œëŠ” ì¢…ë¥˜ê°€ ë‹¤ë¥¸ ë„¤íŠ¸ì›Œí¬ ê°„ì˜ í†µë¡œì˜ ì—­í• ì„ í•˜ëŠ” ì¥ì¹˜ì´ë‹¤. ì‰½ê²Œ ì˜ˆë¥¼ ë“¤ìë©´ í•´ì™¸ì—¬í–‰ì„ ë“¤ ìˆ˜ ìˆëŠ”ë° í•´ì™¸ë¡œ ë‚˜ê°€ê¸° ìœ„í•´ì„œ ê¼­ í†µê³¼í•´ì•¼ í•˜ëŠ” ê³µí•­ì´ ê²Œì´íŠ¸ì›¨ì´ì™€ ê°™ì€ ê°œë…ì´ë‹¤. MSAí™˜ê²½ì—ì„œ ì •ë§ ë¹¼ë†“ì„ ìˆ˜ ì—†ëŠ” êµ¬í˜„í•´ì•¼ í•  ì• í”Œë¦¬ì¼€ì´ì…˜ ì¤‘ í•˜ë‚˜ì´ë‹¤.</p><p>ëŒ€í‘œì ì¸ ê¸°ëŠ¥ìœ¼ë¡œ ì—¬ëŸ¬ ê°€ì§€ê°€ ìˆì§€ë§Œ ë‚´ê°€ ì‚¬ìš©í•˜ëŠ” ê¸°ëŠ¥ë“¤ë§Œ ì¶”ë¦¬ë©´  </p><ul><li>Router ì—­í• </li><li>ê°ì¢… Filter</li><li>LB ê¸°ëŠ¥</li><li>Security</li></ul><p>ë“±ë“± ì§„ì§œ ìˆ˜ë§ì€ ê¸°ëŠ¥ì„ ì œê³µí•˜ê³  ìˆìœ¼ë‹ˆ ì•Œì•„ë³´ë©´ ë‚˜ì¤‘ì— í•œ ë²ˆì”© ì¨ë¨¹ê²Œëœë‹¤. </p><p>ê·¸ ì¤‘ Gateway Filter ì¤‘ì— RequestRateLimiter ë¼ëŠ” ë…€ì„ì´ ìˆëŠ”ë° ì´ ë…€ì„ì„ ì˜ ì¨ë¨¹ìœ¼ë©´ ì† í•œ ë²ˆ ê¹Œë”±ìœ¼ë¡œ Api Limiterê°€ ì§œë€ êµ¬í˜„ì´ëœë‹¤.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="spring-gateway-limiter">Spring Gateway Limiter<a class="hash-link" href="#spring-gateway-limiter" title="Direct link to heading">â€‹</a></h2><p>ê¸°ë³¸ì ìœ¼ë¡œ Spring GatewayëŠ” RateLimiteë¥¼ Redisì™€ luaë¥¼ ì‚¬ìš©í•˜ì—¬ êµ¬í˜„ì„í•´ë†¨ëŠ”ë° ìš°ë¦¬ëŠ” ì´ê±¸ë¡œ ì‚¬ìš©í•˜ê¸°ë§Œ í•˜ë©´ ëœë‹¤. </p><div class="codeBlockContainer_I0IT language-groovy theme-code-block"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_BvAR">build.gradle</div><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-groovy codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ext </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">set</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'springCloudVersion'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token interpolation-string string" style="color:#e3116c">"2020.0.5"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dependencies </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    implementation </span><span class="token string" style="color:#e3116c">'org.springframework.cloud:spring-cloud-starter-gateway'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    implementation </span><span class="token string" style="color:#e3116c">'org.springframework.boot:spring-boot-starter-data-redis-reactive'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    runtimeOnly </span><span class="token string" style="color:#e3116c">'com.h2database:h2'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    testImplementation </span><span class="token string" style="color:#e3116c">'org.springframework.boot:spring-boot-starter-test'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    testImplementation </span><span class="token string" style="color:#e3116c">'org.junit.jupiter:junit-jupiter:5.7.1'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dependencyManagement </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    imports </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        mavenBom </span><span class="token interpolation-string string" style="color:#e3116c">"org.springframework.cloud:spring-cloud-dependencies:</span><span class="token interpolation-string interpolation interpolation-punctuation punctuation" style="color:#393A34">${</span><span class="token interpolation-string interpolation expression">springCloudVersion</span><span class="token interpolation-string interpolation interpolation-punctuation punctuation" style="color:#393A34">}</span><span class="token interpolation-string string" style="color:#e3116c">"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tasks</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">named</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'test'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">useJUnitPlatform</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><br><h3 class="anchor anchorWithStickyNavbar_mojV" id="ê¸°ë³¸-êµ¬í˜„">ê¸°ë³¸ êµ¬í˜„<a class="hash-link" href="#ê¸°ë³¸-êµ¬í˜„" title="Direct link to heading">â€‹</a></h3><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token annotation punctuation" style="color:#393A34">@Configuration</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">CustomUserKeyResolver</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token annotation punctuation" style="color:#393A34">@Bean</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">KeyResolver</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">userKeyResolver</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> exchange </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain"> </span><span class="token class-name">Mono</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">just</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">exchange</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getRequest</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getQueryParams</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getFirst</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"userId"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>keyResolverë¥¼ ì„¸íŒ…ì„ ë¨¼ì € í•´ì¤€ë‹¤.<br>
<!-- -->returní•´ì£¼ëŠ” keyë¥¼ ê°€ì§€ê³  ë’¤ì—ì„œ êµ¬ë¶„ì„ í•˜ë¯€ë¡œ í•„ìˆ˜ì ìœ¼ë¡œ êµ¬í˜„ì„ í•´ì•¼ í•œë‹¤.<br>
<!-- -->getParameterë¡œ userIdê°€ ë“¤ì–´ì˜¨ë‹¤ëŠ” ê°€ì •í•˜ì— êµ¬í˜„í•˜ì˜€ë‹¤.</p><div class="codeBlockContainer_I0IT language-yaml theme-code-block"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_BvAR">application.yml</div><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-yaml codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">spring</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">cloud</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">gateway</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">routes</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">id</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> rate_limiter_route</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">uri</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> http</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">//localhost</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">19000</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">filters</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> RequestRateLimiter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">args</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">key-resolver</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"#{@userKeyResolver}"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">redis-rate-limiter.replenishRate</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">redis-rate-limiter.burstCapacity</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">redis-rate-limiter.requestedTokens</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p><code>key-resolver</code> ìš°ë¦¬ê°€ ì„ ì–¸í•œ beanì´ë¦„ì„ ì£¼ì… í•´ ì¤€ë‹¤.<br>
<code>requestedTokens</code> ìš”ì²­ì‹œì— ì†Œëª¨ë˜ëŠ” í† í°ì˜ ê°œìˆ˜<br>
<code>burstCapacity</code> ë²„í‚·ì˜ ë‹´ê²¨ì ¸ìˆëŠ” ìµœëŒ€ëŸ‰<br>
<code>replenishRate</code> ì´ˆë‹¹ ë²„í‚· íšŒë³µëŸ‰   </p><br><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>RateLimiter ì•Œê³ ë¦¬ì¦˜</h5></div><div class="admonition-content"><p>  <code>[Token bucket</code> ì•Œê³ ë¦¬ì¦˜ì„](<a href="https://dev.to/satrobit/rate-limiting-using-the-token-bucket-algorithm-3cjh" target="_blank" rel="noopener noreferrer">https://dev.to/satrobit/rate-limiting-using-the-token-bucket-algorithm-3cjh</a>) ë”°ë¥¸ë‹¤.</p></div></div><br><p>ì„¤ì •ì„ ë‹¤ í–ˆìœ¼ë‹ˆ í•œ ë²ˆ ìš”ì²­ì„ í•´ë³´ë©´</p><p><img loading="lazy" alt="Untitled" src="/assets/images/Untitled 1-4ef26521487f3e6eb404c129a7202a71.png" width="1259" height="399" class="img_E7b_"></p><p>ì„¤ì •í•œ burstCapacity 10 ì—ì„œ -1 ì´ ëœ 9ê°€ remainìœ¼ë¡œ headerì— ì‘ë‹µì´ ì˜¤ê²Œ ëœë‹¤.<br>
<!-- -->ëŒì•„ì˜¤ëŠ” ì‘ë‹µ í—¤ë”ê°€ ê¶ê¸ˆí•˜ë©´ <code>RedisRateLimiter</code> ì— ì„ ì–¸ë˜ì–´ìˆëŠ” Headerì—ì„œ ì¶”ê°€ë¡œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p><p><img loading="lazy" alt="Untitled" src="/assets/images/Untitled 2-ffeaf9a6b2278df65cb324c3025fb3bb.png" width="958" height="383" class="img_E7b_"></p><br><h3 class="anchor anchorWithStickyNavbar_mojV" id="ê·¸ë ‡ë‹¤ë©´-ë ˆë””ìŠ¤ì—-ì €ì¥ì€-ì–´ë–»ê²Œë ê¹Œ">ê·¸ë ‡ë‹¤ë©´ ë ˆë””ìŠ¤ì— ì €ì¥ì€ ì–´ë–»ê²Œë ê¹Œâ“<a class="hash-link" href="#ê·¸ë ‡ë‹¤ë©´-ë ˆë””ìŠ¤ì—-ì €ì¥ì€-ì–´ë–»ê²Œë ê¹Œ" title="Direct link to heading">â€‹</a></h3><p>ì¼ë‹¨ ë ˆë””ìŠ¤ì— ì €ì¥ë˜ëŠ” ë°ì´í„° ì…‹ì„ ë³¸ë‹¤ë©´<br>
<img loading="lazy" alt="redis data" src="/assets/images/Untitled 3-ad19f11a4a537ede38836d094218f5d6.png" width="442" height="250" class="img_E7b_"></p><p>ì™œ ì´ë ‡ê²Œ ì €ì¥ë˜ëŠ”ì§€ëŠ” <code>RedisRateLimiter.java</code>ì— <code>getKeys</code>ë¼ëŠ” ë©”ì†Œë“œì—ì„œ í™•ì¸í•  ìˆ˜ ìˆëŠ”ë° </p><p><img loading="lazy" alt="Untitled" src="/assets/images/Untitled 4-6f82ffe1e1d20de59fd1ef77f2691d8b.png" width="595" height="389" class="img_E7b_"></p><br><br><br><p>ì´ìƒìœ¼ë¡œ ìš°ë¦¬ì˜ ë ˆë””ìŠ¤ë¥¼ í™œìš©í•œ <del>ìš°ì•„í•˜ê³  ê¹”ë”í•œ</del> <strong>RateLimiter</strong>ê°€ ì™„ì„±ëë‹¤!  </p><br><p><img loading="lazy" alt="Untitled" src="/assets/images/Untitled 5-973e34629559a1b47cececb37fc445fd.png" width="420" height="400" class="img_E7b_">   </p><br><br><br><br><br><br><p>ì‚¬ì‹¤ ìš”ê¸°ê¹Œì§€ë§Œí•´ë„ ê·¸ëƒ¥ ì“°ê¸°ì—ë„ ë‚˜ì˜ì§€ ì•Šì§€ë§Œ ì¡°ê¸ˆ ì•„ì‰½ë‹¤.<br>
<!-- -->ê·¸ëŸ¬ë‚˜ ìš°ë¦¬ì˜ ê¸°íšìë‚˜ ë¹„ì§€ë‹ˆìŠ¤ ìš”êµ¬ì‚¬í•­ì€ ì´ë ‡ê²Œ ê°„ë‹¨í•˜ì§€ ì•Šë‹¤. </p><p>ì˜ˆë¥¼ ë“¤ì–´,  </p><ol><li>íŠ¹ì • ì‚¬ìš©ìì˜ ì£¼ì‹ ì¡°íšŒ ìš”ì²­ì„ ë¶„ë‹¹ 1ë²ˆìœ¼ë¡œ ì„¤ì •ì„ í•˜ê³  ì£¼ì‹ ì£¼ë¬¸ì„ ì´ˆë‹¹ 1ë²ˆë§Œ ê°€ëŠ¥í•˜ë‹¤ë˜ì§€ </li><li>ì†ë„ ë¬¸ì œë¡œ ë³µì¡í•˜ê³  ë¦¬ì†ŒìŠ¤ê°€ ë§ì´ ë“œëŠ” ìš”ì²­ì¼ ê²½ìš° ë¶„ë‹¹ 1ë²ˆë§Œ ìš”ì²­í•˜ê²Œ í•œë‹¤ë˜ì§€ </li><li>ì§€ê¸ˆ redisì—ëŠ” timestampì™€ tokenKey 2ê°œë§Œ ë“¤ì–´ê°€ ìˆëŠ”ë° ë‹¤ë¥¸ ì¶”ê°€ì ì¸ ì •ë³´ë„ ë„£ê³  ì‹¶ë‹¤ë“ ì§€</li><li>Redis TTLì„ ë” ê¸¸ê²Œ ì¡ëŠ”ë‹¤ë“ ì§€</li><li>User ë³„ë¡œ ìš”ì²­ëŸ‰ì„ ë‹¤ë¥´ê²Œ í•˜ê³  ì‹¶ë‹¤ë“ ì§€ </li></ol><p>ëƒ‰í˜¹í•œ ë¹„ì¦ˆë‹ˆìŠ¤ ì„¸ê³„ì—ì„œëŠ” ì´ê²ƒë³´ë‹¤ë„ ë” ë§ì€ <strong>Limiter</strong>ë¡œì¨ì˜ ë” ë§ì€ <strong>ì—­í• </strong>ê³¼ <strong>ì±…ì„</strong> ì„ ìš”êµ¬í•˜ê²Œ ë˜ëŠ”ë°, ê¸°ë³¸ì ìœ¼ë¡œ ì œê³µí•˜ëŠ” <code>RateLimiter</code>ë¡œëŠ” ì‘ì—…ì´ ì–´ë µë‹¤. ê·¸ë˜ì„œ ì¡°ê¸ˆì˜ ì»¤ìŠ¤í…€ì„ í•´ì•¼ í•  í•„ìš”ê°€ ìˆë‹¤. </p><p><a href="https://sk1737030.github.io/RateLimiter2" target="_blank" rel="noopener noreferrer">Request Rate Limiterë¥¼ ë§Œë“¤ì–´ë³´ì! 2í¸</a></p>]]></content>
        <author>
            <name>Dongle</name>
            <uri>https://github.com/sk1737030</uri>
        </author>
        <category label="SCG" term="SCG"/>
        <category label="Spring Cloud Gateway" term="Spring Cloud Gateway"/>
        <category label="Rate Limiter" term="Rate Limiter"/>
    </entry>
</feed>